(()=>{var _n=Object.create;var fr=Object.defineProperty;var gn=Object.getOwnPropertyDescriptor;var bn=Object.getOwnPropertyNames;var vn=Object.getPrototypeOf,wn=Object.prototype.hasOwnProperty;var d=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var Sn=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of bn(e))!wn.call(i,n)&&n!==t&&fr(i,n,{get:()=>e[n],enumerable:!(r=gn(e,n))||r.enumerable});return i};var lr=(i,e,t)=>(t=i!=null?_n(vn(i)):{},Sn(e||!i||!i.__esModule?fr(t,"default",{value:i,enumerable:!0}):t,i));var ft=d((Os,ct)=>{"use strict";var ce=typeof Reflect=="object"?Reflect:null,hr=ce&&typeof ce.apply=="function"?ce.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},Be;ce&&typeof ce.ownKeys=="function"?Be=ce.ownKeys:Object.getOwnPropertySymbols?Be=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Be=function(e){return Object.getOwnPropertyNames(e)};function On(i){console&&console.warn&&console.warn(i)}var pr=Number.isNaN||function(e){return e!==e};function v(){v.init.call(this)}ct.exports=v;ct.exports.once=Tn;v.EventEmitter=v;v.prototype._events=void 0;v.prototype._eventsCount=0;v.prototype._maxListeners=void 0;var dr=10;function De(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return dr},set:function(i){if(typeof i!="number"||i<0||pr(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");dr=i}});v.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};v.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||pr(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function mr(i){return i._maxListeners===void 0?v.defaultMaxListeners:i._maxListeners}v.prototype.getMaxListeners=function(){return mr(this)};v.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var u=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw u.context=o,u}var a=s[e];if(a===void 0)return!1;if(typeof a=="function")hr(a,this,t);else for(var c=a.length,f=vr(a,c),r=0;r<c;++r)hr(f[r],this,t);return!0};function yr(i,e,t,r){var n,s,o;if(De(t),s=i._events,s===void 0?(s=i._events=Object.create(null),i._eventsCount=0):(s.newListener!==void 0&&(i.emit("newListener",e,t.listener?t.listener:t),s=i._events),o=s[e]),o===void 0)o=s[e]=t,++i._eventsCount;else if(typeof o=="function"?o=s[e]=r?[t,o]:[o,t]:r?o.unshift(t):o.push(t),n=mr(i),n>0&&o.length>n&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=i,u.type=e,u.count=o.length,On(u)}return i}v.prototype.addListener=function(e,t){return yr(this,e,t,!1)};v.prototype.on=v.prototype.addListener;v.prototype.prependListener=function(e,t){return yr(this,e,t,!0)};function kn(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _r(i,e,t){var r={fired:!1,wrapFn:void 0,target:i,type:e,listener:t},n=kn.bind(r);return n.listener=t,r.wrapFn=n,n}v.prototype.once=function(e,t){return De(t),this.on(e,_r(this,e,t)),this};v.prototype.prependOnceListener=function(e,t){return De(t),this.prependListener(e,_r(this,e,t)),this};v.prototype.removeListener=function(e,t){var r,n,s,o,u;if(De(t),n=this._events,n===void 0)return this;if(r=n[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){u=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():Rn(r,s),r.length===1&&(n[e]=r[0]),n.removeListener!==void 0&&this.emit("removeListener",e,u||t)}return this};v.prototype.off=v.prototype.removeListener;v.prototype.removeAllListeners=function(e){var t,r,n;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function gr(i,e,t){var r=i._events;if(r===void 0)return[];var n=r[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?En(n):vr(n,n.length)}v.prototype.listeners=function(e){return gr(this,e,!0)};v.prototype.rawListeners=function(e){return gr(this,e,!1)};v.listenerCount=function(i,e){return typeof i.listenerCount=="function"?i.listenerCount(e):br.call(i,e)};v.prototype.listenerCount=br;function br(i){var e=this._events;if(e!==void 0){var t=e[i];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}v.prototype.eventNames=function(){return this._eventsCount>0?Be(this._events):[]};function vr(i,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=i[r];return t}function Rn(i,e){for(;e+1<i.length;e++)i[e]=i[e+1];i.pop()}function En(i){for(var e=new Array(i.length),t=0;t<e.length;++t)e[t]=i[t].listener||i[t];return e}function Tn(i,e){return new Promise(function(t,r){function n(o){i.removeListener(e,s),r(o)}function s(){typeof i.removeListener=="function"&&i.removeListener("error",n),t([].slice.call(arguments))}wr(i,e,s,{once:!0}),e!=="error"&&xn(i,n,{once:!0})})}function xn(i,e,t){typeof i.on=="function"&&wr(i,"error",e,t)}function wr(i,e,t,r){if(typeof i.on=="function")r.once?i.once(e,t):i.on(e,t);else if(typeof i.addEventListener=="function")i.addEventListener(e,function n(s){r.once&&i.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i)}});var pt=d((zs,Tr)=>{"use strict";Tr.exports=An;function An(i,e){for(var t=new Array(arguments.length-1),r=0,n=2,s=!0;n<arguments.length;)t[r++]=arguments[n++];return new Promise(function(u,a){t[r]=function(f){if(s)if(s=!1,f)a(f);else{for(var p=new Array(arguments.length-1),m=0;m<p.length;)p[m++]=arguments[m];u.apply(null,p)}};try{i.apply(e||null,t)}catch(c){s&&(s=!1,a(c))}})}});var qr=d(Ar=>{"use strict";var $e=Ar;$e.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&e.charAt(t)==="=";)++r;return Math.ceil(e.length*3)/4-r};var pe=new Array(64),Cr=new Array(123);for(U=0;U<64;)Cr[pe[U]=U<26?U+65:U<52?U+71:U<62?U-4:U-59|43]=U++;var U;$e.encode=function(e,t,r){for(var n=null,s=[],o=0,u=0,a;t<r;){var c=e[t++];switch(u){case 0:s[o++]=pe[c>>2],a=(c&3)<<4,u=1;break;case 1:s[o++]=pe[a|c>>4],a=(c&15)<<2,u=2;break;case 2:s[o++]=pe[a|c>>6],s[o++]=pe[c&63],u=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return u&&(s[o++]=pe[a],s[o++]=61,u===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var xr="invalid encoding";$e.decode=function(e,t,r){for(var n=r,s=0,o,u=0;u<e.length;){var a=e.charCodeAt(u++);if(a===61&&s>1)break;if((a=Cr[a])===void 0)throw Error(xr);switch(s){case 0:o=a,s=1;break;case 1:t[r++]=o<<2|(a&48)>>4,o=a,s=2;break;case 2:t[r++]=(o&15)<<4|(a&60)>>2,o=a,s=3;break;case 3:t[r++]=(o&3)<<6|a,s=0;break}}if(s===1)throw Error(xr);return r-n};$e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Nr=d((Ws,Pr)=>{"use strict";Pr.exports=We;function We(){this._listeners={}}We.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this};We.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this};We.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}});var Mr=d((Hs,Fr)=>{"use strict";Fr.exports=Lr(Lr);function Lr(i){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=t[3]===128;function n(a,c,f){e[0]=a,c[f]=t[0],c[f+1]=t[1],c[f+2]=t[2],c[f+3]=t[3]}function s(a,c,f){e[0]=a,c[f]=t[3],c[f+1]=t[2],c[f+2]=t[1],c[f+3]=t[0]}i.writeFloatLE=r?n:s,i.writeFloatBE=r?s:n;function o(a,c){return t[0]=a[c],t[1]=a[c+1],t[2]=a[c+2],t[3]=a[c+3],e[0]}function u(a,c){return t[3]=a[c],t[2]=a[c+1],t[1]=a[c+2],t[0]=a[c+3],e[0]}i.readFloatLE=r?o:u,i.readFloatBE=r?u:o}():function(){function e(r,n,s,o){var u=n<0?1:0;if(u&&(n=-n),n===0)r(1/n>0?0:2147483648,s,o);else if(isNaN(n))r(2143289344,s,o);else if(n>34028234663852886e22)r((u<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)r((u<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var a=Math.floor(Math.log(n)/Math.LN2),c=Math.round(n*Math.pow(2,-a)*8388608)&8388607;r((u<<31|a+127<<23|c)>>>0,s,o)}}i.writeFloatLE=e.bind(null,Br),i.writeFloatBE=e.bind(null,Dr);function t(r,n,s){var o=r(n,s),u=(o>>31)*2+1,a=o>>>23&255,c=o&8388607;return a===255?c?NaN:u*(1/0):a===0?u*1401298464324817e-60*c:u*Math.pow(2,a-150)*(c+8388608)}i.readFloatLE=t.bind(null,jr),i.readFloatBE=t.bind(null,Ir)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=t[7]===128;function n(a,c,f){e[0]=a,c[f]=t[0],c[f+1]=t[1],c[f+2]=t[2],c[f+3]=t[3],c[f+4]=t[4],c[f+5]=t[5],c[f+6]=t[6],c[f+7]=t[7]}function s(a,c,f){e[0]=a,c[f]=t[7],c[f+1]=t[6],c[f+2]=t[5],c[f+3]=t[4],c[f+4]=t[3],c[f+5]=t[2],c[f+6]=t[1],c[f+7]=t[0]}i.writeDoubleLE=r?n:s,i.writeDoubleBE=r?s:n;function o(a,c){return t[0]=a[c],t[1]=a[c+1],t[2]=a[c+2],t[3]=a[c+3],t[4]=a[c+4],t[5]=a[c+5],t[6]=a[c+6],t[7]=a[c+7],e[0]}function u(a,c){return t[7]=a[c],t[6]=a[c+1],t[5]=a[c+2],t[4]=a[c+3],t[3]=a[c+4],t[2]=a[c+5],t[1]=a[c+6],t[0]=a[c+7],e[0]}i.readDoubleLE=r?o:u,i.readDoubleBE=r?u:o}():function(){function e(r,n,s,o,u,a){var c=o<0?1:0;if(c&&(o=-o),o===0)r(0,u,a+n),r(1/o>0?0:2147483648,u,a+s);else if(isNaN(o))r(0,u,a+n),r(2146959360,u,a+s);else if(o>17976931348623157e292)r(0,u,a+n),r((c<<31|2146435072)>>>0,u,a+s);else{var f;if(o<22250738585072014e-324)f=o/5e-324,r(f>>>0,u,a+n),r((c<<31|f/4294967296)>>>0,u,a+s);else{var p=Math.floor(Math.log(o)/Math.LN2);p===1024&&(p=1023),f=o*Math.pow(2,-p),r(f*4503599627370496>>>0,u,a+n),r((c<<31|p+1023<<20|f*1048576&1048575)>>>0,u,a+s)}}}i.writeDoubleLE=e.bind(null,Br,0,4),i.writeDoubleBE=e.bind(null,Dr,4,0);function t(r,n,s,o,u){var a=r(o,u+n),c=r(o,u+s),f=(c>>31)*2+1,p=c>>>20&2047,m=4294967296*(c&1048575)+a;return p===2047?m?NaN:f*(1/0):p===0?f*5e-324*m:f*Math.pow(2,p-1075)*(m+4503599627370496)}i.readDoubleLE=t.bind(null,jr,0,4),i.readDoubleBE=t.bind(null,Ir,4,0)}(),i}function Br(i,e,t){e[t]=i&255,e[t+1]=i>>>8&255,e[t+2]=i>>>16&255,e[t+3]=i>>>24}function Dr(i,e,t){e[t]=i>>>24,e[t+1]=i>>>16&255,e[t+2]=i>>>8&255,e[t+3]=i&255}function jr(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16|i[e+3]<<24)>>>0}function Ir(i,e){return(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}});var mt=d((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(i){}return null}});var Ur=d(Jr=>{"use strict";var yt=Jr;yt.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t};yt.read=function(e,t,r){var n=r-t;if(n<1)return"";for(var s=null,o=[],u=0,a;t<r;)a=e[t++],a<128?o[u++]=a:a>191&&a<224?o[u++]=(a&31)<<6|e[t++]&63:a>239&&a<365?(a=((a&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[u++]=55296+(a>>10),o[u++]=56320+(a&1023)):o[u++]=(a&15)<<12|(e[t++]&63)<<6|e[t++]&63,u>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),u=0);return s?(u&&s.push(String.fromCharCode.apply(String,o.slice(0,u))),s.join("")):String.fromCharCode.apply(String,o.slice(0,u))};yt.write=function(e,t,r){for(var n=r,s,o,u=0;u<e.length;++u)s=e.charCodeAt(u),s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(u+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++u,t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128);return r-n}});var $r=d((Vs,zr)=>{"use strict";zr.exports=qn;function qn(i,e,t){var r=t||8192,n=r>>>1,s=null,o=r;return function(a){if(a<1||a>n)return i(a);o+a>r&&(s=i(r),o=0);var c=e.call(s,o,o+=a);return o&7&&(o=(o|7)+1),c}}});var Hr=d((Gs,Wr)=>{"use strict";Wr.exports=x;var Se=W();function x(i,e){this.lo=i>>>0,this.hi=e>>>0}var ne=x.zero=new x(0,0);ne.toNumber=function(){return 0};ne.zzEncode=ne.zzDecode=function(){return this};ne.length=function(){return 1};var Pn=x.zeroHash="\0\0\0\0\0\0\0\0";x.fromNumber=function(e){if(e===0)return ne;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new x(r,n)};x.from=function(e){if(typeof e=="number")return x.fromNumber(e);if(Se.isString(e))if(Se.Long)e=Se.Long.fromString(e);else return x.fromNumber(parseInt(e,10));return e.low||e.high?new x(e.low>>>0,e.high>>>0):ne};x.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+r*4294967296)}return this.lo+this.hi*4294967296};x.prototype.toLong=function(e){return Se.Long?new Se.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var ee=String.prototype.charCodeAt;x.fromHash=function(e){return e===Pn?ne:new x((ee.call(e,0)|ee.call(e,1)<<8|ee.call(e,2)<<16|ee.call(e,3)<<24)>>>0,(ee.call(e,4)|ee.call(e,5)<<8|ee.call(e,6)<<16|ee.call(e,7)<<24)>>>0)};x.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};x.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};x.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};x.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}});var W=d(_t=>{"use strict";var l=_t;l.asPromise=pt();l.base64=qr();l.EventEmitter=Nr();l.float=Mr();l.inquire=mt();l.utf8=Ur();l.pool=$r();l.LongBits=Hr();l.isNode=Boolean(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);l.global=l.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||_t;l.emptyArray=Object.freeze?Object.freeze([]):[];l.emptyObject=Object.freeze?Object.freeze({}):{};l.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};l.isString=function(e){return typeof e=="string"||e instanceof String};l.isObject=function(e){return e&&typeof e=="object"};l.isset=l.isSet=function(e,t){var r=e[t];return r!=null&&e.hasOwnProperty(t)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};l.Buffer=function(){try{var i=l.inquire("buffer").Buffer;return i.prototype.utf8Write?i:null}catch{return null}}();l._Buffer_from=null;l._Buffer_allocUnsafe=null;l.newBuffer=function(e){return typeof e=="number"?l.Buffer?l._Buffer_allocUnsafe(e):new l.Array(e):l.Buffer?l._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};l.Array=typeof Uint8Array<"u"?Uint8Array:Array;l.Long=l.global.dcodeIO&&l.global.dcodeIO.Long||l.global.Long||l.inquire("long");l.key2Re=/^true|false|0|1$/;l.key32Re=/^-?(?:0|[1-9][0-9]*)$/;l.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;l.longToHash=function(e){return e?l.LongBits.from(e).toHash():l.LongBits.zeroHash};l.longFromHash=function(e,t){var r=l.LongBits.fromHash(e);return l.Long?l.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))};function Kr(i,e,t){for(var r=Object.keys(e),n=0;n<r.length;++n)(i[r[n]]===void 0||!t)&&(i[r[n]]=e[r[n]]);return i}l.merge=Kr;l.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Vr(i){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&Kr(this,r)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return i}}),e.prototype.toString=function(){return this.name+": "+this.message},e}l.newError=Vr;l.ProtocolError=Vr("ProtocolError");l.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(t[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};l.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}};l.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};l._configure=function(){var i=l.Buffer;if(!i){l._Buffer_from=l._Buffer_allocUnsafe=null;return}l._Buffer_from=i.from!==Uint8Array.from&&i.from||function(t,r){return new i(t,r)},l._Buffer_allocUnsafe=i.allocUnsafe||function(t){return new i(t)}}});var Ke=d((Xs,Yr)=>{"use strict";Yr.exports=g;var j=W(),gt,He=j.LongBits,Gr=j.base64,Zr=j.utf8;function Oe(i,e,t){this.fn=i,this.len=e,this.next=void 0,this.val=t}function vt(){}function Nn(i){this.head=i.head,this.tail=i.tail,this.len=i.len,this.next=i.states}function g(){this.len=0,this.head=new Oe(vt,0,0),this.tail=this.head,this.states=null}var Xr=function(){return j.Buffer?function(){return(g.create=function(){return new gt})()}:function(){return new g}};g.create=Xr();g.alloc=function(e){return new j.Array(e)};j.Array!==Array&&(g.alloc=j.pool(g.alloc,j.Array.prototype.subarray));g.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Oe(e,t,r),this.len+=t,this};function wt(i,e,t){e[t]=i&255}function Ln(i,e,t){for(;i>127;)e[t++]=i&127|128,i>>>=7;e[t]=i}function St(i,e){this.len=i,this.next=void 0,this.val=e}St.prototype=Object.create(Oe.prototype);St.prototype.fn=Ln;g.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new St((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};g.prototype.int32=function(e){return e<0?this._push(Ot,10,He.fromNumber(e)):this.uint32(e)};g.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ot(i,e,t){for(;i.hi;)e[t++]=i.lo&127|128,i.lo=(i.lo>>>7|i.hi<<25)>>>0,i.hi>>>=7;for(;i.lo>127;)e[t++]=i.lo&127|128,i.lo=i.lo>>>7;e[t++]=i.lo}g.prototype.uint64=function(e){var t=He.from(e);return this._push(Ot,t.length(),t)};g.prototype.int64=g.prototype.uint64;g.prototype.sint64=function(e){var t=He.from(e).zzEncode();return this._push(Ot,t.length(),t)};g.prototype.bool=function(e){return this._push(wt,1,e?1:0)};function bt(i,e,t){e[t]=i&255,e[t+1]=i>>>8&255,e[t+2]=i>>>16&255,e[t+3]=i>>>24}g.prototype.fixed32=function(e){return this._push(bt,4,e>>>0)};g.prototype.sfixed32=g.prototype.fixed32;g.prototype.fixed64=function(e){var t=He.from(e);return this._push(bt,4,t.lo)._push(bt,4,t.hi)};g.prototype.sfixed64=g.prototype.fixed64;g.prototype.float=function(e){return this._push(j.float.writeFloatLE,4,e)};g.prototype.double=function(e){return this._push(j.float.writeDoubleLE,8,e)};var Bn=j.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};g.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(wt,1,0);if(j.isString(e)){var r=g.alloc(t=Gr.length(e));Gr.decode(e,r,0),e=r}return this.uint32(t)._push(Bn,t,e)};g.prototype.string=function(e){var t=Zr.length(e);return t?this.uint32(t)._push(Zr.write,t,e):this._push(wt,1,0)};g.prototype.fork=function(){return this.states=new Nn(this),this.head=this.tail=new Oe(vt,0,0),this.len=0,this};g.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Oe(vt,0,0),this.len=0),this};g.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this};g.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t};g._configure=function(i){gt=i,g.create=Xr(),gt._configure()}});var ti=d((Ys,ei)=>{"use strict";ei.exports=H;var Qr=Ke();(H.prototype=Object.create(Qr.prototype)).constructor=H;var te=W();function H(){Qr.call(this)}H._configure=function(){H.alloc=te._Buffer_allocUnsafe,H.writeBytesBuffer=te.Buffer&&te.Buffer.prototype instanceof Uint8Array&&te.Buffer.prototype.set.name==="set"?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}};H.prototype.bytes=function(e){te.isString(e)&&(e=te._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(H.writeBytesBuffer,t,e),this};function Dn(i,e,t){i.length<40?te.utf8.write(i,e,t):e.utf8Write?e.utf8Write(i,t):e.write(i,t)}H.prototype.string=function(e){var t=te.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Dn,t,e),this};H._configure()});var Ge=d((Qs,oi)=>{"use strict";oi.exports=O;var K=W(),Rt,ni=K.LongBits,jn=K.utf8;function z(i,e){return RangeError("index out of range: "+i.pos+" + "+(e||1)+" > "+i.len)}function O(i){this.buf=i,this.pos=0,this.len=i.length}var ri=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new O(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new O(e);throw Error("illegal buffer")},si=function(){return K.Buffer?function(t){return(O.create=function(n){return K.Buffer.isBuffer(n)?new Rt(n):ri(n)})(t)}:ri};O.create=si();O.prototype._slice=K.Array.prototype.subarray||K.Array.prototype.slice;O.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,z(this,10);return e}}();O.prototype.int32=function(){return this.uint32()|0};O.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function kt(){var i=new ni(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(i.lo=(i.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return i;if(i.lo=(i.lo|(this.buf[this.pos]&127)<<28)>>>0,i.hi=(i.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return i;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw z(this);if(i.lo=(i.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return i}return i.lo=(i.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,i}if(this.len-this.pos>4){for(;e<5;++e)if(i.hi=(i.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return i}else for(;e<5;++e){if(this.pos>=this.len)throw z(this);if(i.hi=(i.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return i}throw Error("invalid varint encoding")}O.prototype.bool=function(){return this.uint32()!==0};function Ve(i,e){return(i[e-4]|i[e-3]<<8|i[e-2]<<16|i[e-1]<<24)>>>0}O.prototype.fixed32=function(){if(this.pos+4>this.len)throw z(this,4);return Ve(this.buf,this.pos+=4)};O.prototype.sfixed32=function(){if(this.pos+4>this.len)throw z(this,4);return Ve(this.buf,this.pos+=4)|0};function ii(){if(this.pos+8>this.len)throw z(this,8);return new ni(Ve(this.buf,this.pos+=4),Ve(this.buf,this.pos+=4))}O.prototype.float=function(){if(this.pos+4>this.len)throw z(this,4);var e=K.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};O.prototype.double=function(){if(this.pos+8>this.len)throw z(this,4);var e=K.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};O.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw z(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)};O.prototype.string=function(){var e=this.bytes();return jn.read(e,0,e.length)};O.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw z(this,e);this.pos+=e}else do if(this.pos>=this.len)throw z(this);while(this.buf[this.pos++]&128);return this};O.prototype.skipType=function(i){switch(i){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(i=this.uint32()&7)!==4;)this.skipType(i);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+i+" at offset "+this.pos)}return this};O._configure=function(i){Rt=i,O.create=si(),Rt._configure();var e=K.Long?"toLong":"toNumber";K.merge(O.prototype,{int64:function(){return kt.call(this)[e](!1)},uint64:function(){return kt.call(this)[e](!0)},sint64:function(){return kt.call(this).zzDecode()[e](!1)},fixed64:function(){return ii.call(this)[e](!0)},sfixed64:function(){return ii.call(this)[e](!1)}})}});var fi=d((eo,ci)=>{"use strict";ci.exports=se;var ai=Ge();(se.prototype=Object.create(ai.prototype)).constructor=se;var ui=W();function se(i){ai.call(this,i)}se._configure=function(){ui.Buffer&&(se.prototype._slice=ui.Buffer.prototype.slice)};se.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};se._configure()});var hi=d((to,li)=>{"use strict";li.exports=ke;var Et=W();(ke.prototype=Object.create(Et.EventEmitter.prototype)).constructor=ke;function ke(i,e,t){if(typeof i!="function")throw TypeError("rpcImpl must be a function");Et.EventEmitter.call(this),this.rpcImpl=i,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}ke.prototype.rpcCall=function i(e,t,r,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return Et.asPromise(i,o,e,t,r,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(a,c){if(a)return o.emit("error",a,e),s(a);if(c===null){o.end(!0);return}if(!(c instanceof r))try{c=r[o.responseDelimited?"decodeDelimited":"decode"](c)}catch(f){return o.emit("error",f,e),s(f)}return o.emit("data",c,e),s(null,c)})}catch(u){o.emit("error",u,e),setTimeout(function(){s(u)},0);return}};ke.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Tt=d(di=>{"use strict";var In=di;In.Service=hi()});var xt=d((io,pi)=>{"use strict";pi.exports={}});var _i=d(yi=>{"use strict";var P=yi;P.build="minimal";P.Writer=Ke();P.BufferWriter=ti();P.Reader=Ge();P.BufferReader=fi();P.util=W();P.rpc=Tt();P.roots=xt();P.configure=mi;function mi(){P.util._configure(),P.Writer._configure(P.BufferWriter),P.Reader._configure(P.BufferReader)}mi()});var bi=d((so,gi)=>{"use strict";gi.exports=Ct;function Ct(i,e){typeof i=="string"&&(e=i,i=void 0);var t=[];function r(s){if(typeof s!="string"){var o=n();if(Ct.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var u=Object.keys(s),a=new Array(u.length+1),c=new Array(u.length),f=0;f<u.length;)a[f]=u[f],c[f]=s[u[f++]];return a[f]=o,Function.apply(null,a).apply(null,c)}return Function(o)()}for(var p=new Array(arguments.length-1),m=0;m<p.length;)p[m]=arguments[++m];if(m=0,s=s.replace(/%([%dfijs])/g,function(S,y){var T=p[m++];switch(y){case"d":case"f":return String(Number(T));case"i":return String(Math.floor(T));case"j":return JSON.stringify(T);case"s":return String(T)}return"%"}),m!==p.length)throw Error("parameter count mismatch");return t.push(s),r}function n(s){return"function "+(s||e||"")+"("+(i&&i.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return r.toString=n,r}Ct.verbose=!1});var wi=d((oo,vi)=>{"use strict";vi.exports=Re;var Fn=pt(),Mn=mt(),At=Mn("fs");function Re(i,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&At&&At.readFile?At.readFile(i,function(n,s){return n&&typeof XMLHttpRequest<"u"?Re.xhr(i,e,t):n?t(n):t(null,e.binary?s:s.toString("utf8"))}):Re.xhr(i,e,t):Fn(Re,this,i,e)}Re.xhr=function(e,t,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===4){if(n.status!==0&&n.status!==200)return r(Error("status "+n.status));if(t.binary){var o=n.response;if(!o){o=[];for(var u=0;u<n.responseText.length;++u)o.push(n.responseText.charCodeAt(u)&255)}return r(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return r(null,n.responseText)}},t.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}});var ki=d(Oi=>{"use strict";var Pt=Oi,Si=Pt.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},qt=Pt.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),r=Si(e),n="";r&&(n=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):r?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return n+t.join("/")};Pt.resolve=function(e,t,r){return r||(t=qt(t)),Si(t)?t:(r||(e=qt(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?qt(e+"/"+t):t)}});var me=d(Ri=>{"use strict";var Ee=Ri,Jn=C(),Un=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Te(i,e){var t=0,r={};for(e|=0;t<i.length;)r[Un[t+e]]=i[t++];return r}Ee.basic=Te([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Ee.defaults=Te([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",Jn.emptyArray,null]);Ee.long=Te([0,0,0,1,1],7);Ee.mapKey=Te([0,0,0,5,5,0,0,0,1,1,0,2],2);Ee.packed=Te([1,5,0,0,0,5,5,0,0,0,1,1,0])});var oe=d((co,xi)=>{"use strict";xi.exports=I;var Ze=ue();((I.prototype=Object.create(Ze.prototype)).constructor=I).className="Field";var Ei=V(),Ti=me(),E=C(),Nt,zn=/^required|optional|repeated$/;I.fromJSON=function(e,t){return new I(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function I(i,e,t,r,n,s,o){if(E.isObject(r)?(o=n,s=r,r=n=void 0):E.isObject(n)&&(o=s,s=n,n=void 0),Ze.call(this,i,s),!E.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!E.isString(t))throw TypeError("type must be a string");if(r!==void 0&&!zn.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(n!==void 0&&!E.isString(n))throw TypeError("extend must be a string");r==="proto3_optional"&&(r="optional"),this.rule=r&&r!=="optional"?r:void 0,this.type=t,this.id=e,this.extend=n||void 0,this.required=r==="required",this.optional=!this.required,this.repeated=r==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=E.Long?Ti.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(I.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});I.prototype.setOption=function(e,t,r){return e==="packed"&&(this._packed=null),Ze.prototype.setOption.call(this,e,t,r)};I.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return E.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};I.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=Ti.defaults[this.type])===void 0&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Nt?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Ei&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Ei))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=E.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;E.base64.test(this.typeDefault)?E.base64.decode(this.typeDefault,e=E.newBuffer(E.base64.length(this.typeDefault)),0):E.utf8.write(this.typeDefault,e=E.newBuffer(E.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=E.emptyObject:this.repeated?this.defaultValue=E.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Nt&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Ze.prototype.resolve.call(this)};I.d=function(e,t,r,n){return typeof t=="function"?t=E.decorateType(t).name:t&&typeof t=="object"&&(t=E.decorateEnum(t).name),function(o,u){E.decorateType(o.constructor).add(new I(u,e,t,r,{default:n}))}};I._configure=function(e){Nt=e}});var xe=d((fo,qi)=>{"use strict";qi.exports=F;var Ye=ue();((F.prototype=Object.create(Ye.prototype)).constructor=F).className="OneOf";var Ci=oe(),Xe=C();function F(i,e,t,r){if(Array.isArray(e)||(t=e,e=void 0),Ye.call(this,i,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=r}F.fromJSON=function(e,t){return new F(e,t.oneof,t.options,t.comment)};F.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return Xe.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function Ai(i){if(i.parent)for(var e=0;e<i.fieldsArray.length;++e)i.fieldsArray[e].parent||i.parent.add(i.fieldsArray[e])}F.prototype.add=function(e){if(!(e instanceof Ci))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,Ai(this),this};F.prototype.remove=function(e){if(!(e instanceof Ci))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};F.prototype.onAdd=function(e){Ye.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var n=e.get(this.oneof[r]);n&&!n.partOf&&(n.partOf=t,t.fieldsArray.push(n))}Ai(this)};F.prototype.onRemove=function(e){for(var t=0,r;t<this.fieldsArray.length;++t)(r=this.fieldsArray[t]).parent&&r.parent.remove(r);Ye.prototype.onRemove.call(this,e)};F.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(n,s){Xe.decorateType(n.constructor).add(new F(s,e)),Object.defineProperty(n,s,{get:Xe.oneOfGetter(e),set:Xe.oneOfSetter(e)})}}});var ge=d((lo,Bi)=>{"use strict";Bi.exports=b;var Lt=ue();((b.prototype=Object.create(Lt.prototype)).constructor=b).className="Namespace";var Pi=oe(),$n=xe(),Qe=C(),ye,Ce,_e;b.fromJSON=function(e,t){return new b(e,t.options).addJSON(t.nested)};function Ni(i,e){if(!!(i&&i.length)){for(var t={},r=0;r<i.length;++r)t[i[r].name]=i[r].toJSON(e);return t}}b.arrayToJSON=Ni;b.isReservedId=function(e,t){if(e){for(var r=0;r<e.length;++r)if(typeof e[r]!="string"&&e[r][0]<=t&&e[r][1]>t)return!0}return!1};b.isReservedName=function(e,t){if(e){for(var r=0;r<e.length;++r)if(e[r]===t)return!0}return!1};function b(i,e){Lt.call(this,i,e),this.nested=void 0,this._nestedArray=null}function Li(i){return i._nestedArray=null,i}Object.defineProperty(b.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Qe.toArray(this.nested))}});b.prototype.toJSON=function(e){return Qe.toObject(["options",this.options,"nested",Ni(this.nestedArray,e)])};b.prototype.addJSON=function(e){var t=this;if(e)for(var r=Object.keys(e),n=0,s;n<r.length;++n)s=e[r[n]],t.add((s.fields!==void 0?ye.fromJSON:s.values!==void 0?_e.fromJSON:s.methods!==void 0?Ce.fromJSON:s.id!==void 0?Pi.fromJSON:b.fromJSON)(r[n],s));return this};b.prototype.get=function(e){return this.nested&&this.nested[e]||null};b.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof _e)return this.nested[e].values;throw Error("no such enum: "+e)};b.prototype.add=function(e){if(!(e instanceof Pi&&e.extend!==void 0||e instanceof ye||e instanceof _e||e instanceof Ce||e instanceof b||e instanceof $n))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof b&&e instanceof b&&!(t instanceof ye||t instanceof Ce)){for(var r=t.nestedArray,n=0;n<r.length;++n)e.add(r[n]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),Li(this)};b.prototype.remove=function(e){if(!(e instanceof Lt))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),Li(this)};b.prototype.define=function(e,t){if(Qe.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var r=this;e.length>0;){var n=e.shift();if(r.nested&&r.nested[n]){if(r=r.nested[n],!(r instanceof b))throw Error("path conflicts with non-namespace objects")}else r.add(r=new b(n))}return t&&r.addJSON(t),r};b.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof b?e[t++].resolveAll():e[t++].resolve();return this.resolve()};b.prototype.lookup=function(e,t,r){if(typeof t=="boolean"?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),Qe.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n){if(e.length===1){if(!t||t.indexOf(n.constructor)>-1)return n}else if(n instanceof b&&(n=n.lookup(e.slice(1),t,!0)))return n}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof b&&(n=this._nestedArray[s].lookup(e,t,!0)))return n;return this.parent===null||r?null:this.parent.lookup(e,t)};b.prototype.lookupType=function(e){var t=this.lookup(e,[ye]);if(!t)throw Error("no such type: "+e);return t};b.prototype.lookupEnum=function(e){var t=this.lookup(e,[_e]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};b.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[ye,_e]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};b.prototype.lookupService=function(e){var t=this.lookup(e,[Ce]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};b._configure=function(i,e,t){ye=i,Ce=e,_e=t}});var Dt=d((ho,Di)=>{"use strict";Di.exports=Y;var Bt=oe();((Y.prototype=Object.create(Bt.prototype)).constructor=Y).className="MapField";var Wn=me(),Ae=C();function Y(i,e,t,r,n,s){if(Bt.call(this,i,e,r,void 0,void 0,n,s),!Ae.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}Y.fromJSON=function(e,t){return new Y(e,t.id,t.keyType,t.type,t.options,t.comment)};Y.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return Ae.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Y.prototype.resolve=function(){if(this.resolved)return this;if(Wn.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return Bt.prototype.resolve.call(this)};Y.d=function(e,t,r){return typeof r=="function"?r=Ae.decorateType(r).name:r&&typeof r=="object"&&(r=Ae.decorateEnum(r).name),function(s,o){Ae.decorateType(s.constructor).add(new Y(o,e,t,r))}}});var It=d((po,ji)=>{"use strict";ji.exports=ae;var jt=ue();((ae.prototype=Object.create(jt.prototype)).constructor=ae).className="Method";var be=C();function ae(i,e,t,r,n,s,o,u,a){if(be.isObject(n)?(o=n,n=s=void 0):be.isObject(s)&&(o=s,s=void 0),!(e===void 0||be.isString(e)))throw TypeError("type must be a string");if(!be.isString(t))throw TypeError("requestType must be a string");if(!be.isString(r))throw TypeError("responseType must be a string");jt.call(this,i,o),this.type=e||"rpc",this.requestType=t,this.requestStream=n?!0:void 0,this.responseType=r,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=u,this.parsedOptions=a}ae.fromJSON=function(e,t){return new ae(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};ae.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return be.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};ae.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),jt.prototype.resolve.call(this))}});var Mt=d((mo,Fi)=>{"use strict";Fi.exports=M;var re=ge();((M.prototype=Object.create(re.prototype)).constructor=M).className="Service";var Ft=It(),qe=C(),Hn=Tt();function M(i,e){re.call(this,i,e),this.methods={},this._methodsArray=null}M.fromJSON=function(e,t){var r=new M(e,t.options);if(t.methods)for(var n=Object.keys(t.methods),s=0;s<n.length;++s)r.add(Ft.fromJSON(n[s],t.methods[n[s]]));return t.nested&&r.addJSON(t.nested),r.comment=t.comment,r};M.prototype.toJSON=function(e){var t=re.prototype.toJSON.call(this,e),r=e?Boolean(e.keepComments):!1;return qe.toObject(["options",t&&t.options||void 0,"methods",re.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};Object.defineProperty(M.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=qe.toArray(this.methods))}});function Ii(i){return i._methodsArray=null,i}M.prototype.get=function(e){return this.methods[e]||re.prototype.get.call(this,e)};M.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return re.prototype.resolve.call(this)};M.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof Ft?(this.methods[e.name]=e,e.parent=this,Ii(this)):re.prototype.add.call(this,e)};M.prototype.remove=function(e){if(e instanceof Ft){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,Ii(this)}return re.prototype.remove.call(this,e)};M.prototype.create=function(e,t,r){for(var n=new Hn.Service(e,t,r),s=0,o;s<this.methodsArray.length;++s){var u=qe.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");n[u]=qe.codegen(["r","c"],qe.isReserved(u)?u+"_":u)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return n}});var et=d((yo,Mi)=>{"use strict";Mi.exports=G;var Kn=W();function G(i){if(i)for(var e=Object.keys(i),t=0;t<e.length;++t)this[e[t]]=i[e[t]]}G.create=function(e){return this.$type.create(e)};G.encode=function(e,t){return this.$type.encode(e,t)};G.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};G.decode=function(e){return this.$type.decode(e)};G.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};G.verify=function(e){return this.$type.verify(e)};G.fromObject=function(e){return this.$type.fromObject(e)};G.toObject=function(e,t){return this.$type.toObject(e,t)};G.prototype.toJSON=function(){return this.$type.toObject(this,Kn.toJSONOptions)}});var Jt=d((_o,Ui)=>{"use strict";Ui.exports=Zn;var Vn=V(),Q=me(),Ji=C();function Gn(i){return"missing required '"+i.name+"'"}function Zn(i){var e=Ji.codegen(["r","l"],i.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(i.fieldsArray.filter(function(u){return u.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");i.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var t=0;t<i.fieldsArray.length;++t){var r=i._fieldsArray[t].resolve(),n=r.resolvedType instanceof Vn?"int32":r.type,s="m"+Ji.safeProp(r.name);e("case %i:",r.id),r.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Q.defaults[r.keyType]!==void 0?e("k=%j",Q.defaults[r.keyType]):e("k=null"),Q.defaults[n]!==void 0?e("value=%j",Q.defaults[n]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",r.keyType)("case 2:"),Q.basic[n]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",n),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Q.long[r.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):r.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Q.packed[n]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,n)("}else"),Q.basic[n]===void 0?e(r.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,n)):Q.basic[n]===void 0?e(r.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,n),e("break")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<i._fieldsArray.length;++t){var o=i._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",Gn(o))}return e("return m")}});var $t=d((go,zi)=>{"use strict";zi.exports=Qn;var Xn=V(),Ut=C();function J(i,e){return i.name+": "+e+(i.repeated&&e!=="array"?"[]":i.map&&e!=="object"?"{k:"+i.keyType+"}":"")+" expected"}function zt(i,e,t,r){if(e.resolvedType)if(e.resolvedType instanceof Xn){i("switch(%s){",r)("default:")("return%j",J(e,"enum value"));for(var n=Object.keys(e.resolvedType.values),s=0;s<n.length;++s)i("case %i:",e.resolvedType.values[n[s]]);i("break")("}")}else i("{")("var e=types[%i].verify(%s);",t,r)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":i("if(!util.isInteger(%s))",r)("return%j",J(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":i("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",J(e,"integer|Long"));break;case"float":case"double":i('if(typeof %s!=="number")',r)("return%j",J(e,"number"));break;case"bool":i('if(typeof %s!=="boolean")',r)("return%j",J(e,"boolean"));break;case"string":i("if(!util.isString(%s))",r)("return%j",J(e,"string"));break;case"bytes":i('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",J(e,"buffer"));break}return i}function Yn(i,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":i("if(!util.key32Re.test(%s))",t)("return%j",J(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":i("if(!util.key64Re.test(%s))",t)("return%j",J(e,"integer|Long key"));break;case"bool":i("if(!util.key2Re.test(%s))",t)("return%j",J(e,"boolean key"));break}return i}function Qn(i){var e=Ut.codegen(["m"],i.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=i.oneofsArray,r={};t.length&&e("var p={}");for(var n=0;n<i.fieldsArray.length;++n){var s=i._fieldsArray[n].resolve(),o="m"+Ut.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",J(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),Yn(e,s,"k[i]"),zt(e,s,n,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",J(s,"array"))("for(var i=0;i<%s.length;++i){",o),zt(e,s,n,o+"[i]")("}");else{if(s.partOf){var u=Ut.safeProp(s.partOf.name);r[s.partOf.name]===1&&e("if(p%s===1)",u)("return%j",s.partOf.name+": multiple values"),r[s.partOf.name]=1,e("p%s=1",u)}zt(e,s,n,o)}s.optional&&e("}")}return e("return null")}});var Kt=d(Wi=>{"use strict";var $i=Wi,Pe=V(),Z=C();function Wt(i,e,t,r){if(e.resolvedType)if(e.resolvedType instanceof Pe){i("switch(d%s){",r);for(var n=e.resolvedType.values,s=Object.keys(n),o=0;o<s.length;++o)e.repeated&&n[s[o]]===e.typeDefault&&i("default:"),i("case%j:",s[o])("case %i:",n[s[o]])("m%s=%j",r,n[s[o]])("break");i("}")}else i('if(typeof d%s!=="object")',r)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,t,r);else{var u=!1;switch(e.type){case"double":case"float":i("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":i("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":i("m%s=d%s|0",r,r);break;case"uint64":u=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":i("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,u)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,u?"true":"");break;case"bytes":i('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length)",r)("m%s=d%s",r,r);break;case"string":i("m%s=String(d%s)",r,r);break;case"bool":i("m%s=Boolean(d%s)",r,r);break}}return i}$i.fromObject=function(e){var t=e.fieldsArray,r=Z.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var n=0;n<t.length;++n){var s=t[n].resolve(),o=Z.safeProp(s.name);s.map?(r("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Wt(r,s,n,o+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Wt(r,s,n,o+"[i]")("}")("}")):(s.resolvedType instanceof Pe||r("if(d%s!=null){",o),Wt(r,s,n,o),s.resolvedType instanceof Pe||r("}"))}return r("return m")};function Ht(i,e,t,r){if(e.resolvedType)e.resolvedType instanceof Pe?i("d%s=o.enums===String?types[%i].values[m%s]:m%s",r,t,r,r):i("d%s=types[%i].toObject(m%s,o)",r,t,r);else{var n=!1;switch(e.type){case"double":case"float":i("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":n=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":i('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,n?"true":"",r);break;case"bytes":i("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:i("d%s=m%s",r,r);break}}return i}$i.toObject=function(e){var t=e.fieldsArray.slice().sort(Z.compareFieldsById);if(!t.length)return Z.codegen()("return {}");for(var r=Z.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],s=[],o=[],u=0;u<t.length;++u)t[u].partOf||(t[u].resolve().repeated?n:t[u].map?s:o).push(t[u]);if(n.length){for(r("if(o.arrays||o.defaults){"),u=0;u<n.length;++u)r("d%s=[]",Z.safeProp(n[u].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),u=0;u<s.length;++u)r("d%s={}",Z.safeProp(s[u].name));r("}")}if(o.length){for(r("if(o.defaults){"),u=0;u<o.length;++u){var a=o[u],c=Z.safeProp(a.name);if(a.resolvedType instanceof Pe)r("d%s=o.enums===String?%j:%j",c,a.resolvedType.valuesById[a.typeDefault],a.typeDefault);else if(a.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",a.typeDefault.low,a.typeDefault.high,a.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,a.typeDefault.toString(),a.typeDefault.toNumber());else if(a.bytes){var f="["+Array.prototype.slice.call(a.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,a.typeDefault))("else{")("d%s=%s",c,f)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else r("d%s=%j",c,a.typeDefault)}r("}")}var p=!1;for(u=0;u<t.length;++u){var a=t[u],m=e._fieldsArray.indexOf(a),c=Z.safeProp(a.name);a.map?(p||(p=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),Ht(r,a,m,c+"[ks2[j]]")("}")):a.repeated?(r("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),Ht(r,a,m,c+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",c,a.name),Ht(r,a,m,c),a.partOf&&r("if(o.oneofs)")("d%s=%j",Z.safeProp(a.partOf.name),a.name)),r("}")}return r("return d")}});var Vt=d(Hi=>{"use strict";var es=Hi,ts=et();es[".google.protobuf.Any"]={fromObject:function(i){if(i&&i["@type"]){var e=i["@type"].substring(i["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var r=i["@type"].charAt(0)==="."?i["@type"].substr(1):i["@type"];return r.indexOf("/")===-1&&(r="/"+r),this.create({type_url:r,value:t.encode(t.fromObject(i)).finish()})}}return this.fromObject(i)},toObject:function(i,e){var t="type.googleapis.com/",r="",n="";if(e&&e.json&&i.type_url&&i.value){n=i.type_url.substring(i.type_url.lastIndexOf("/")+1),r=i.type_url.substring(0,i.type_url.lastIndexOf("/")+1);var s=this.lookup(n);s&&(i=s.decode(i.value))}if(!(i instanceof this.ctor)&&i instanceof ts){var o=i.$type.toObject(i,e),u=i.$type.fullName[0]==="."?i.$type.fullName.substr(1):i.$type.fullName;return r===""&&(r=t),n=r+u,o["@type"]=n,o}return this.toObject(i,e)}}});var Yt=d((wo,Vi)=>{"use strict";Vi.exports=w;var $=ge();((w.prototype=Object.create($.prototype)).constructor=w).className="Type";var rs=V(),Xt=xe(),tt=oe(),is=Dt(),ns=Mt(),Gt=et(),Zt=Ge(),ss=Ke(),A=C(),os=Qt(),us=Jt(),as=$t(),Ki=Kt(),cs=Vt();function w(i,e){$.call(this,i,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(w.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var i=Object.keys(this.fields),e=0;e<i.length;++e){var t=this.fields[i[e]],r=t.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=A.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=A.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=w.generateConstructor(this)())},set:function(i){var e=i.prototype;e instanceof Gt||((i.prototype=new Gt).constructor=i,A.merge(i.prototype,e)),i.$type=i.prototype.$type=this,A.merge(i,Gt,!0),this._ctor=i;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var r={};for(t=0;t<this.oneofsArray.length;++t)r[this._oneofsArray[t].resolve().name]={get:A.oneOfGetter(this._oneofsArray[t].oneof),set:A.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(i.prototype,r)}}});w.generateConstructor=function(e){for(var t=A.codegen(["p"],e.name),r=0,n;r<e.fieldsArray.length;++r)(n=e._fieldsArray[r]).map?t("this%s={}",A.safeProp(n.name)):n.repeated&&t("this%s=[]",A.safeProp(n.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function rt(i){return i._fieldsById=i._fieldsArray=i._oneofsArray=null,delete i.encode,delete i.decode,delete i.verify,i}w.fromJSON=function(e,t){var r=new w(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var n=Object.keys(t.fields),s=0;s<n.length;++s)r.add((typeof t.fields[n[s]].keyType<"u"?is.fromJSON:tt.fromJSON)(n[s],t.fields[n[s]]));if(t.oneofs)for(n=Object.keys(t.oneofs),s=0;s<n.length;++s)r.add(Xt.fromJSON(n[s],t.oneofs[n[s]]));if(t.nested)for(n=Object.keys(t.nested),s=0;s<n.length;++s){var o=t.nested[n[s]];r.add((o.id!==void 0?tt.fromJSON:o.fields!==void 0?w.fromJSON:o.values!==void 0?rs.fromJSON:o.methods!==void 0?ns.fromJSON:$.fromJSON)(n[s],o))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),r};w.prototype.toJSON=function(e){var t=$.prototype.toJSON.call(this,e),r=e?Boolean(e.keepComments):!1;return A.toObject(["options",t&&t.options||void 0,"oneofs",$.arrayToJSON(this.oneofsArray,e),"fields",$.arrayToJSON(this.fieldsArray.filter(function(n){return!n.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};w.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var r=this.oneofsArray;for(t=0;t<r.length;)r[t++].resolve();return $.prototype.resolveAll.call(this)};w.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};w.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof tt&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),rt(this)}return e instanceof Xt?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),rt(this)):$.prototype.add.call(this,e)};w.prototype.remove=function(e){if(e instanceof tt&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),rt(this)}if(e instanceof Xt){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),rt(this)}return $.prototype.remove.call(this,e)};w.prototype.isReservedId=function(e){return $.isReservedId(this.reserved,e)};w.prototype.isReservedName=function(e){return $.isReservedName(this.reserved,e)};w.prototype.create=function(e){return new this.ctor(e)};w.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=os(this)({Writer:ss,types:t,util:A}),this.decode=us(this)({Reader:Zt,types:t,util:A}),this.verify=as(this)({types:t,util:A}),this.fromObject=Ki.fromObject(this)({types:t,util:A}),this.toObject=Ki.toObject(this)({types:t,util:A});var n=cs[e];if(n){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(s),s.toObject=this.toObject,this.toObject=n.toObject.bind(s)}return this};w.prototype.encode=function(e,t){return this.setup().encode(e,t)};w.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};w.prototype.decode=function(e,t){return this.setup().decode(e,t)};w.prototype.decodeDelimited=function(e){return e instanceof Zt||(e=Zt.create(e)),this.decode(e,e.uint32())};w.prototype.verify=function(e){return this.setup().verify(e)};w.prototype.fromObject=function(e){return this.setup().fromObject(e)};w.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};w.d=function(e){return function(r){A.decorateType(r,e)}}});var rr=d((So,Qi)=>{"use strict";Qi.exports=B;var nt=ge();((B.prototype=Object.create(nt.prototype)).constructor=B).className="Root";var tr=oe(),Zi=V(),fs=xe(),ie=C(),Xi,er,Ne;function B(i){nt.call(this,"",i),this.deferred=[],this.files=[]}B.fromJSON=function(e,t){return t||(t=new B),e.options&&t.setOptions(e.options),t.addJSON(e.nested)};B.prototype.resolvePath=ie.path.resolve;B.prototype.fetch=ie.fetch;function Yi(){}B.prototype.load=function i(e,t,r){typeof t=="function"&&(r=t,t=void 0);var n=this;if(!r)return ie.asPromise(i,n,e,t);var s=r===Yi;function o(h,S){if(!!r){var y=r;if(r=null,s)throw h;y(h,S)}}function u(h){var S=h.lastIndexOf("google/protobuf/");if(S>-1){var y=h.substring(S);if(y in Ne)return y}return null}function a(h,S){try{if(ie.isString(S)&&S.charAt(0)==="{"&&(S=JSON.parse(S)),!ie.isString(S))n.setOptions(S.options).addJSON(S.nested);else{er.filename=h;var y=er(S,n,t),T,N=0;if(y.imports)for(;N<y.imports.length;++N)(T=u(y.imports[N])||n.resolvePath(h,y.imports[N]))&&c(T);if(y.weakImports)for(N=0;N<y.weakImports.length;++N)(T=u(y.weakImports[N])||n.resolvePath(h,y.weakImports[N]))&&c(T,!0)}}catch(yn){o(yn)}!s&&!f&&o(null,n)}function c(h,S){if(!(n.files.indexOf(h)>-1)){if(n.files.push(h),h in Ne){s?a(h,Ne[h]):(++f,setTimeout(function(){--f,a(h,Ne[h])}));return}if(s){var y;try{y=ie.fs.readFileSync(h).toString("utf8")}catch(T){S||o(T);return}a(h,y)}else++f,n.fetch(h,function(T,N){if(--f,!!r){if(T){S?f||o(null,n):o(T);return}a(h,N)}})}}var f=0;ie.isString(e)&&(e=[e]);for(var p=0,m;p<e.length;++p)(m=n.resolvePath("",e[p]))&&c(m);if(s)return n;f||o(null,n)};B.prototype.loadSync=function(e,t){if(!ie.isNode)throw Error("not supported");return this.load(e,t,Yi)};B.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return nt.prototype.resolveAll.call(this)};var it=/^[A-Z]/;function Gi(i,e){var t=e.parent.lookup(e.extend);if(t){var r=new tr(e.fullName,e.id,e.type,e.rule,void 0,e.options);return r.declaringField=e,e.extensionField=r,t.add(r),!0}return!1}B.prototype._handleAdd=function(e){if(e instanceof tr)e.extend!==void 0&&!e.extensionField&&(Gi(this,e)||this.deferred.push(e));else if(e instanceof Zi)it.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof fs)){if(e instanceof Xi)for(var t=0;t<this.deferred.length;)Gi(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);it.test(e.name)&&(e.parent[e.name]=e)}};B.prototype._handleRemove=function(e){if(e instanceof tr){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof Zi)it.test(e.name)&&delete e.parent[e.name];else if(e instanceof nt){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);it.test(e.name)&&delete e.parent[e.name]}};B._configure=function(i,e,t){Xi=i,er=e,Ne=t}});var C=d((Oo,tn)=>{"use strict";var k=tn.exports=W(),en=xt(),ir,nr;k.codegen=bi();k.fetch=wi();k.path=ki();k.fs=k.inquire("fs");k.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),n=0;n<t.length;)r[n]=e[t[n++]];return r}return[]};k.toObject=function(e){for(var t={},r=0;r<e.length;){var n=e[r++],s=e[r++];s!==void 0&&(t[n]=s)}return t};var ls=/\\/g,hs=/"/g;k.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};k.safeProp=function(e){return!/^[$\w_]+$/.test(e)||k.isReserved(e)?'["'+e.replace(ls,"\\\\").replace(hs,'\\"')+'"]':"."+e};k.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var ds=/_([a-z])/g;k.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(ds,function(t,r){return r.toUpperCase()})};k.compareFieldsById=function(e,t){return e.id-t.id};k.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(k.decorateRoot.remove(e.$type),e.$type.name=t,k.decorateRoot.add(e.$type)),e.$type;ir||(ir=Yt());var r=new ir(t||e.name);return k.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var ps=0;k.decorateEnum=function(e){if(e.$type)return e.$type;nr||(nr=V());var t=new nr("Enum"+ps++,e);return k.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};k.setProperty=function(e,t,r){function n(s,o,u){var a=o.shift();if(o.length>0)s[a]=n(s[a]||{},o,u);else{var c=s[a];c&&(u=[].concat(c).concat(u)),s[a]=u}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),n(e,t,r)};Object.defineProperty(k,"decorateRoot",{get:function(){return en.decorated||(en.decorated=new(rr()))}})});var ue=d((ko,rn)=>{"use strict";rn.exports=D;D.className="ReflectionObject";var st=C(),ot;function D(i,e){if(!st.isString(i))throw TypeError("name must be a string");if(e&&!st.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=i,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(D.prototype,{root:{get:function(){for(var i=this;i.parent!==null;)i=i.parent;return i}},fullName:{get:function(){for(var i=[this.name],e=this.parent;e;)i.unshift(e.name),e=e.parent;return i.join(".")}}});D.prototype.toJSON=function(){throw Error()};D.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof ot&&t._handleAdd(this)};D.prototype.onRemove=function(e){var t=e.root;t instanceof ot&&t._handleRemove(this),this.parent=null,this.resolved=!1};D.prototype.resolve=function(){return this.resolved?this:(this.root instanceof ot&&(this.resolved=!0),this)};D.prototype.getOption=function(e){if(this.options)return this.options[e]};D.prototype.setOption=function(e,t,r){return(!r||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=t),this};D.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var n=this.parsedOptions;if(r){var s=n.find(function(a){return Object.prototype.hasOwnProperty.call(a,e)});if(s){var o=s[e];st.setProperty(o,r,t)}else s={},s[e]=st.setProperty({},r,t),n.push(s)}else{var u={};u[e]=t,n.push(u)}return this};D.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)this.setOption(r[n],e[r[n]],t);return this};D.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};D._configure=function(i){ot=i}});var V=d((Ro,on)=>{"use strict";on.exports=X;var nn=ue();((X.prototype=Object.create(nn.prototype)).constructor=X).className="Enum";var sn=ge(),ut=C();function X(i,e,t,r,n){if(nn.call(this,i,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=n||{},this.reserved=void 0,e)for(var s=Object.keys(e),o=0;o<s.length;++o)typeof e[s[o]]=="number"&&(this.valuesById[this.values[s[o]]=e[s[o]]]=s[o])}X.fromJSON=function(e,t){var r=new X(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,r};X.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return ut.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};X.prototype.add=function(e,t,r){if(!ut.isString(e))throw TypeError("name must be a string");if(!ut.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=r||null,this};X.prototype.remove=function(e){if(!ut.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this};X.prototype.isReservedId=function(e){return sn.isReservedId(this.reserved,e)};X.prototype.isReservedName=function(e){return sn.isReservedName(this.reserved,e)}});var Qt=d((Eo,an)=>{"use strict";an.exports=ys;var ms=V(),sr=me(),or=C();function un(i,e,t,r){return e.resolvedType.group?i("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,r,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):i("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,r,(e.id<<3|2)>>>0)}function ys(i){for(var e=or.codegen(["m","w"],i.name+"$encode")("if(!w)")("w=Writer.create()"),t,r,n=i.fieldsArray.slice().sort(or.compareFieldsById),t=0;t<n.length;++t){var s=n[t].resolve(),o=i._fieldsArray.indexOf(s),u=s.resolvedType instanceof ms?"int32":s.type,a=sr.basic[u];r="m"+or.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|sr.mapKey[s.keyType],s.keyType),a===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,r):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|a,u,r),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",r,r),s.packed&&sr.packed[u]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",u,r)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",r),a===void 0?un(e,s,o,r+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|a)>>>0,u,r)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,s.name),a===void 0?un(e,s,o,r):e("w.uint32(%i).%s(%s)",(s.id<<3|a)>>>0,u,r))}return e("return w")}});var fn=d((To,cn)=>{"use strict";var _=cn.exports=_i();_.build="light";function _s(i,e,t){return typeof e=="function"?(t=e,e=new _.Root):e||(e=new _.Root),e.load(i,t)}_.load=_s;function gs(i,e){return e||(e=new _.Root),e.loadSync(i)}_.loadSync=gs;_.encoder=Qt();_.decoder=Jt();_.verifier=$t();_.converter=Kt();_.ReflectionObject=ue();_.Namespace=ge();_.Root=rr();_.Enum=V();_.Type=Yt();_.Field=oe();_.OneOf=xe();_.MapField=Dt();_.Service=Mt();_.Method=It();_.Message=et();_.wrappers=Vt();_.types=me();_.util=C();_.ReflectionObject._configure(_.Root);_.Namespace._configure(_.Type,_.Service,_.Enum);_.Root._configure(_.Type);_.Field._configure(_.Type)});var hn=d((xo,ln)=>{"use strict";ln.exports=fn()});var dn=d((Co,bs)=>{bs.exports={nested:{centrifugal:{nested:{centrifuge:{nested:{protocol:{options:{go_package:"./;protocol"},nested:{Error:{fields:{code:{type:"uint32",id:1},message:{type:"string",id:2},temporary:{type:"bool",id:3}}},EmulationRequest:{fields:{node:{type:"string",id:1},session:{type:"string",id:2},data:{type:"bytes",id:3}}},Command:{fields:{id:{type:"uint32",id:1},method:{type:"MethodType",id:2},params:{type:"bytes",id:3},connect:{type:"ConnectRequest",id:4},subscribe:{type:"SubscribeRequest",id:5},unsubscribe:{type:"UnsubscribeRequest",id:6},publish:{type:"PublishRequest",id:7},presence:{type:"PresenceRequest",id:8},presence_stats:{type:"PresenceStatsRequest",id:9},history:{type:"HistoryRequest",id:10},ping:{type:"PingRequest",id:11},send:{type:"SendRequest",id:12},rpc:{type:"RPCRequest",id:13},refresh:{type:"RefreshRequest",id:14},sub_refresh:{type:"SubRefreshRequest",id:15}},nested:{MethodType:{values:{CONNECT:0,SUBSCRIBE:1,UNSUBSCRIBE:2,PUBLISH:3,PRESENCE:4,PRESENCE_STATS:5,HISTORY:6,PING:7,SEND:8,RPC:9,REFRESH:10,SUB_REFRESH:11}}}},Reply:{fields:{id:{type:"uint32",id:1},error:{type:"Error",id:2},result:{type:"bytes",id:3},push:{type:"Push",id:4},connect:{type:"ConnectResult",id:5},subscribe:{type:"SubscribeResult",id:6},unsubscribe:{type:"UnsubscribeResult",id:7},publish:{type:"PublishResult",id:8},presence:{type:"PresenceResult",id:9},presence_stats:{type:"PresenceStatsResult",id:10},history:{type:"HistoryResult",id:11},ping:{type:"PingResult",id:12},rpc:{type:"RPCResult",id:13},refresh:{type:"RefreshResult",id:14},sub_refresh:{type:"SubRefreshResult",id:15}}},Push:{fields:{type:{type:"PushType",id:1},channel:{type:"string",id:2},data:{type:"bytes",id:3},pub:{type:"Publication",id:4},join:{type:"Join",id:5},leave:{type:"Leave",id:6},unsubscribe:{type:"Unsubscribe",id:7},message:{type:"Message",id:8},subscribe:{type:"Subscribe",id:9},connect:{type:"Connect",id:10},disconnect:{type:"Disconnect",id:11},refresh:{type:"Refresh",id:12}},nested:{PushType:{values:{PUBLICATION:0,JOIN:1,LEAVE:2,UNSUBSCRIBE:3,MESSAGE:4,SUBSCRIBE:5,CONNECT:6,DISCONNECT:7,REFRESH:8}}}},ClientInfo:{fields:{user:{type:"string",id:1},client:{type:"string",id:2},conn_info:{type:"bytes",id:3},chan_info:{type:"bytes",id:4}}},Publication:{fields:{data:{type:"bytes",id:4},info:{type:"ClientInfo",id:5},offset:{type:"uint64",id:6},tags:{keyType:"string",type:"string",id:7}}},Join:{fields:{info:{type:"ClientInfo",id:1}}},Leave:{fields:{info:{type:"ClientInfo",id:1}}},Unsubscribe:{fields:{code:{type:"uint32",id:2},reason:{type:"string",id:3}}},Subscribe:{fields:{recoverable:{type:"bool",id:1},epoch:{type:"string",id:4},offset:{type:"uint64",id:5},positioned:{type:"bool",id:6},data:{type:"bytes",id:7}}},Message:{fields:{data:{type:"bytes",id:1}}},Connect:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},data:{type:"bytes",id:3},subs:{keyType:"string",type:"SubscribeResult",id:4},expires:{type:"bool",id:5},ttl:{type:"uint32",id:6},ping:{type:"uint32",id:7},pong:{type:"bool",id:8},session:{type:"string",id:9},node:{type:"string",id:10}}},Disconnect:{fields:{code:{type:"uint32",id:1},reason:{type:"string",id:2},reconnect:{type:"bool",id:3}}},Refresh:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2}}},ConnectRequest:{fields:{token:{type:"string",id:1},data:{type:"bytes",id:2},subs:{keyType:"string",type:"SubscribeRequest",id:3},name:{type:"string",id:4},version:{type:"string",id:5}}},ConnectResult:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},expires:{type:"bool",id:3},ttl:{type:"uint32",id:4},data:{type:"bytes",id:5},subs:{keyType:"string",type:"SubscribeResult",id:6},ping:{type:"uint32",id:7},pong:{type:"bool",id:8},session:{type:"string",id:9},node:{type:"string",id:10}}},RefreshRequest:{fields:{token:{type:"string",id:1}}},RefreshResult:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},expires:{type:"bool",id:3},ttl:{type:"uint32",id:4}}},SubscribeRequest:{fields:{channel:{type:"string",id:1},token:{type:"string",id:2},recover:{type:"bool",id:3},epoch:{type:"string",id:6},offset:{type:"uint64",id:7},data:{type:"bytes",id:8},positioned:{type:"bool",id:9},recoverable:{type:"bool",id:10}}},SubscribeResult:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2},recoverable:{type:"bool",id:3},epoch:{type:"string",id:6},publications:{rule:"repeated",type:"Publication",id:7},recovered:{type:"bool",id:8},offset:{type:"uint64",id:9},positioned:{type:"bool",id:10},data:{type:"bytes",id:11},was_recovering:{type:"bool",id:12}}},SubRefreshRequest:{fields:{channel:{type:"string",id:1},token:{type:"string",id:2}}},SubRefreshResult:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2}}},UnsubscribeRequest:{fields:{channel:{type:"string",id:1}}},UnsubscribeResult:{fields:{}},PublishRequest:{fields:{channel:{type:"string",id:1},data:{type:"bytes",id:2}}},PublishResult:{fields:{}},PresenceRequest:{fields:{channel:{type:"string",id:1}}},PresenceResult:{fields:{presence:{keyType:"string",type:"ClientInfo",id:1}}},PresenceStatsRequest:{fields:{channel:{type:"string",id:1}}},PresenceStatsResult:{fields:{num_clients:{type:"uint32",id:1},num_users:{type:"uint32",id:2}}},StreamPosition:{fields:{offset:{type:"uint64",id:1},epoch:{type:"string",id:2}}},HistoryRequest:{fields:{channel:{type:"string",id:1},limit:{type:"int32",id:7},since:{type:"StreamPosition",id:8},reverse:{type:"bool",id:9}}},HistoryResult:{fields:{publications:{rule:"repeated",type:"Publication",id:1},epoch:{type:"string",id:2},offset:{type:"uint64",id:3}}},PingRequest:{fields:{}},PingResult:{fields:{}},RPCRequest:{fields:{data:{type:"bytes",id:1},method:{type:"string",id:2}}},RPCResult:{fields:{data:{type:"bytes",id:1}}},SendRequest:{fields:{data:{type:"bytes",id:1}}}}}}}}}}}});var Er=lr(ft());var Rr=lr(ft());var R={timeout:1,transportClosed:2,clientDisconnected:3,clientClosed:4,clientConnectToken:5,clientRefreshToken:6,subscriptionUnsubscribed:7,subscriptionSubscribeToken:8,subscriptionRefreshToken:9,transportWriteError:10,connectionClosed:11},fe={connectCalled:0,transportClosed:1,noPing:2,subscribeTimeout:3,unsubscribeError:4},je={disconnectCalled:0,unauthorized:1,badProtocol:2,messageSizeLimit:3},Ie={subscribeCalled:0,transportClosed:1},lt={unsubscribeCalled:0,unauthorized:1,clientClosed:2};function Sr(i,e){return i.lastIndexOf(e,0)===0}function ht(i){return i==null?!1:typeof i=="function"}function dt(i,e){if(global.console){let t=global.console[i];ht(t)&&t.apply(global.console,e)}}function Cn(i,e){return Math.floor(Math.random()*(e-i+1)+i)}function le(i,e,t){i>31&&(i=31);let r=Cn(0,Math.min(t,e*Math.pow(2,i)));return Math.min(t,e+r)}function Or(i){return"error"in i&&i.error!==null}function kr(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function he(i){return Math.min(i*1e3,2147483647)}var L={Unsubscribed:"unsubscribed",Subscribing:"subscribing",Subscribed:"subscribed"},Fe=class extends Rr.default{constructor(e,t,r){super(),this.channel=t,this.state=L.Unsubscribed,this._centrifuge=e,this._token=null,this._getToken=null,this._data=null,this._recover=!1,this._offset=null,this._epoch=null,this._recoverable=!1,this._positioned=!1,this._minResubscribeDelay=500,this._maxResubscribeDelay=2e4,this._resubscribeTimeout=null,this._resubscribeAttempts=0,this._promises={},this._promiseId=0,this._refreshTimeout=null,this._setOptions(r),this._centrifuge._debugEnabled&&(this.on("state",function(n){this._centrifuge._debug("subscription state",t,n.oldState,"->",n.newState)}),this.on("error",function(n){this._centrifuge._debug("subscription error",t,n)}))}ready(e){return this.state===L.Unsubscribed?Promise.reject({code:R.subscriptionUnsubscribed,message:this.state}):this.state===L.Subscribed?Promise.resolve():new Promise((t,r)=>{let n={resolve:t,reject:r};e&&(n.timeout=setTimeout(function(){r({code:R.timeout,message:"timeout"})},e)),this._promises[this._nextPromiseId()]=n})}subscribe(){this._isSubscribed()||(this._resubscribeAttempts=0,this._setSubscribing(Ie.subscribeCalled,"subscribe called"))}unsubscribe(){this._setUnsubscribed(lt.unsubscribeCalled,"unsubscribe called",!0)}cancel(){if(this.state!==L.Unsubscribed)throw new Error("Subscription must be unsubscribed to cancel");this._centrifuge._removeSubscription(this),this._centrifuge=void 0}publish(e){let t=this;return this._methodCall().then(function(){return t._centrifuge.publish(t.channel,e)})}presence(){let e=this;return this._methodCall().then(function(){return e._centrifuge.presence(e.channel)})}presenceStats(){let e=this;return this._methodCall().then(function(){return e._centrifuge.presenceStats(e.channel)})}history(e){let t=this;return this._methodCall().then(function(){return t._centrifuge.history(t.channel,e)})}_methodCall(){return this._isSubscribed()?Promise.resolve():new Promise((e,t)=>{let r=setTimeout(function(){t({code:R.timeout,message:"timeout"})},this._centrifuge._config.timeout);this._promises[this._nextPromiseId()]={timeout:r,resolve:e,reject:t}})}_nextPromiseId(){return++this._promiseId}_needRecover(){return this._recover===!0}_isUnsubscribed(){return this.state===L.Unsubscribed}_isSubscribing(){return this.state===L.Subscribing}_isSubscribed(){return this.state===L.Subscribed}_setState(e){if(this.state!==e){let t=this.state;return this.state=e,this.emit("state",{newState:e,oldState:t,channel:this.channel}),!0}return!1}_usesToken(){return this._token!==null||this._getToken!==null}_clearSubscribingState(){this._resubscribeAttempts=0,this._clearResubscribeTimeout()}_clearSubscribedState(){this._clearRefreshTimeout()}_setSubscribed(e){if(!this._isSubscribing())return;this._clearSubscribingState(),e.recoverable&&(this._recover=!0,this._offset=e.offset||0,this._epoch=e.epoch||""),this._setState(L.Subscribed);let t=this._centrifuge._getSubscribeContext(this.channel,e);this.emit("subscribed",t),this._resolvePromises();let r=e.publications;if(r&&r.length>0)for(let n in r)!r.hasOwnProperty(n)||this._handlePublication(r[n]);e.expires===!0&&(this._refreshTimeout=setTimeout(()=>this._refresh(),he(e.ttl)))}_setSubscribing(e,t){this._isSubscribing()||(this._isSubscribed()&&this._clearSubscribedState(),this._setState(L.Subscribing)&&this.emit("subscribing",{channel:this.channel,code:e,reason:t}),this._centrifuge._subscribe(this))}_setUnsubscribed(e,t,r){this._isUnsubscribed()||(this._isSubscribed()&&(r&&this._centrifuge._unsubscribe(this),this._clearSubscribedState()),this._isSubscribing()&&this._clearSubscribingState(),this._setState(L.Unsubscribed)&&this.emit("unsubscribed",{channel:this.channel,code:e,reason:t}),this._rejectPromises({code:R.subscriptionUnsubscribed,message:"unsubscribed"}))}_handlePublication(e){let t=this._centrifuge._getPublicationContext(this.channel,e);this.emit("publication",t),e.offset&&(this._offset=e.offset)}_handleJoin(e){this.emit("join",{channel:this.channel,info:this._centrifuge._getJoinLeaveContext(e.info)})}_handleLeave(e){this.emit("leave",{channel:this.channel,info:this._centrifuge._getJoinLeaveContext(e.info)})}_resolvePromises(){for(let e in this._promises)this._promises[e].timeout&&clearTimeout(this._promises[e].timeout),this._promises[e].resolve(),delete this._promises[e]}_rejectPromises(e){for(let t in this._promises)this._promises[t].timeout&&clearTimeout(this._promises[t].timeout),this._promises[t].reject(e),delete this._promises[t]}_scheduleResubscribe(){let e=this,t=this._getResubscribeDelay();this._resubscribeTimeout=setTimeout(function(){e._isSubscribing()&&e._centrifuge._subscribe(e)},t)}_subscribeError(e){if(!!this._isSubscribing())if(e.code<100||e.code===109||e.temporary===!0){e.code===109&&(this._token=null);let t={channel:this.channel,type:"subscribe",error:e};this.emit("error",t),this._scheduleResubscribe()}else this._setUnsubscribed(e.code,e.message,!1)}_getResubscribeDelay(){let e=le(this._resubscribeAttempts,this._minResubscribeDelay,this._maxResubscribeDelay);return this._resubscribeAttempts++,e}_clearPositionState(){this._recover=!1,this._offset=null,this._epoch=null}_setOptions(e){!e||("since"in e&&(this._offset=e.since.offset,this._epoch=e.since.epoch,this._recover=!0),"data"in e&&(this._data=e.data),"minResubscribeDelay"in e&&(this._minResubscribeDelay=e.minResubscribeDelay),"maxResubscribeDelay"in e&&(this._maxResubscribeDelay=e.maxResubscribeDelay),"token"in e&&(this._token=e.token),"getToken"in e&&(this._getToken=e.getToken),e.positioned===!0&&(this._positioned=!0),e.recoverable===!0&&(this._recoverable=!0))}_getOffset(){let e=this._offset;return e!==null?e:0}_getEpoch(){let e=this._epoch;return e!==null?e:""}_clearRefreshTimeout(){this._refreshTimeout!==null&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearResubscribeTimeout(){this._resubscribeTimeout!==null&&(clearTimeout(this._resubscribeTimeout),this._resubscribeTimeout=null)}_getSubscriptionToken(){this._centrifuge._debug("get subscription token for channel",this.channel);let e={channel:this.channel},t=this._getToken;if(t===null)throw new Error("provide a function to get channel subscription token");return t(e)}_refresh(){this._clearRefreshTimeout();let e=this;this._getSubscriptionToken().then(function(t){if(!e._isSubscribed())return;if(!t){e._failUnauthorized();return}e._token=t;let n={sub_refresh:{channel:e.channel,token:t}};e._centrifuge._call(n).then(s=>{let o=s.reply.sub_refresh;e._refreshResponse(o),s.next&&s.next()},s=>{e._refreshError(s.error),s.next&&s.next()})}).catch(function(t){e.emit("error",{type:"refreshToken",channel:e.channel,error:{code:R.subscriptionRefreshToken,message:t!==void 0?t.toString():""}}),e._refreshTimeout=setTimeout(()=>e._refresh(),e._getRefreshRetryDelay())})}_refreshResponse(e){this._centrifuge._debug("subscription token refreshed, channel",this.channel),this._clearRefreshTimeout(),e.expires===!0&&(this._refreshTimeout=setTimeout(()=>this._refresh(),he(e.ttl)))}_refreshError(e){e.code<100||e.temporary===!0?(this.emit("error",{type:"refresh",channel:this.channel,error:e}),this._refreshTimeout=setTimeout(()=>this._refresh(),this._getRefreshRetryDelay())):this._setUnsubscribed(e.code,e.message,!0)}_getRefreshRetryDelay(){return le(0,1e4,2e4)}_failUnauthorized(){this._setUnsubscribed(lt.unauthorized,"unauthorized",!0)}};var ve=class{constructor(e,t){this.endpoint=e,this.options=t,this._transport=null}name(){return"sockjs"}subName(){return"sockjs-"+this._transport.transport}emulation(){return!1}supported(){return this.options.sockjs!==null}initialize(e,t,r){let n={transports:this.options.transports};this.options.server!==null&&(n.server=this.options.server),this.options.timeout!==null&&(n.timeout=this.options.timeout),this._transport=new this.options.sockjs(this.endpoint,null,n),this._transport.onopen=()=>{t.onOpen()},this._transport.onerror=s=>{t.onError(s)},this._transport.onclose=s=>{t.onClose(s)},this._transport.onmessage=s=>{t.onMessage(s.data)}}close(){this._transport.close()}send(e){this._transport.send(e)}};var we=class{constructor(e,t){this.endpoint=e,this.options=t,this._transport=null}name(){return"websocket"}subName(){return"websocket"}emulation(){return!1}supported(){return this.options.websocket!==null}initialize(e,t,r){let n="";e==="protobuf"&&(n="centrifuge-protobuf"),n!==""?this._transport=new this.options.websocket(this.endpoint,n):this._transport=new this.options.websocket(this.endpoint),e==="protobuf"&&(this._transport.binaryType="arraybuffer"),this._transport.onopen=()=>{t.onOpen()},this._transport.onerror=s=>{t.onError(s)},this._transport.onclose=s=>{t.onClose(s)},this._transport.onmessage=s=>{t.onMessage(s.data)}}close(){this._transport.close()}send(e){this._transport.send(e)}};var Me=class{constructor(e,t){this.endpoint=e,this.options=t,this._abortController=null,this._utf8decoder=new TextDecoder,this._protocol="json"}name(){return"http_stream"}subName(){return"http_stream"}emulation(){return!0}_handleErrors(e){if(!e.ok)throw new Error(e.status);return e}_fetchEventTarget(e,t,r){let n=new EventTarget;return e.options.fetch(t,r).then(e._handleErrors).then(o=>{n.dispatchEvent(new Event("open"));let u="",a=0,c=new Uint8Array,f=o.body.getReader();return new e.options.readableStream({start(p){function m(){return f.read().then(({done:h,value:S})=>{if(h){n.dispatchEvent(new Event("close")),p.close();return}try{if(e._protocol==="json")for(u+=e._utf8decoder.decode(S);a<u.length;)if(u[a]===`
`){let y=u.substring(0,a);n.dispatchEvent(new MessageEvent("message",{data:y})),u=u.substring(a+1),a=0}else++a;else{let y=new Uint8Array(c.length+S.length);for(y.set(c),y.set(S,c.length),c=y;;){let T=e.options.decoder.decodeReply(c);if(T.ok){let N=c.slice(0,T.pos);n.dispatchEvent(new MessageEvent("message",{data:N})),c=c.slice(T.pos);continue}break}}}catch(y){n.dispatchEvent(new Event("error",{detail:y})),n.dispatchEvent(new Event("close")),p.close();return}m()}).catch(function(h){n.dispatchEvent(new Event("error",{detail:h})),n.dispatchEvent(new Event("close")),p.close()})}return m()}})}).catch(o=>{n.dispatchEvent(new Event("error",{detail:o})),n.dispatchEvent(new Event("close"))}),n}supported(){return this.options.fetch!==null&&this.options.readableStream!==null&&typeof TextDecoder!="undefined"&&typeof AbortController!="undefined"&&typeof EventTarget!="undefined"&&typeof Event!="undefined"&&typeof MessageEvent!="undefined"&&typeof Error!="undefined"}initialize(e,t,r){this._protocol=e,this._abortController=new AbortController;let n,s;e==="json"?(n={Accept:"application/json","Content-Type":"application/json"},s=r):(n={Accept:"application/octet-stream","Content-Type":"application/octet-stream"},s=r);let o=new this._fetchEventTarget(this,this.endpoint,{method:"POST",headers:n,mode:this.options.requestMode,signal:this._abortController.signal,body:s});o.addEventListener("open",()=>{t.onOpen()}),o.addEventListener("error",u=>{this._abortController.abort(),t.onError(u)}),o.addEventListener("close",()=>{this._abortController.abort(),t.onClose({code:4,reason:"connection closed"})}),o.addEventListener("message",u=>{t.onMessage(u.data)})}close(){this._abortController.abort()}send(e,t,r){let n,s,o={session:t,node:r,data:e};this._protocol==="json"?(n={"Content-Type":"application/json"},s=JSON.stringify(o)):(n={"Content-Type":"application/octet-stream"},s=this.options.encoder.encodeEmulationRequest(o)),this.options.fetch(this.options.emulationEndpoint,{method:"POST",headers:n,mode:this.options.emulationRequestMode,body:s})}};var Je=class{constructor(e,t){this.endpoint=e,this.options=t,this._protocol="json",this._transport=null,this._onClose=null}name(){return"sse"}subName(){return"sse"}emulation(){return!0}supported(){return this.options.eventsource!==null&&this.options.fetch!==null}initialize(e,t,r){let n=new URL(this.endpoint);n.searchParams.append("cf_connect",r);let s=new this.options.eventsource(n.toString());this._transport=s;let o=this;s.onopen=function(){t.onOpen()},s.onerror=function(u){s.close(),t.onError(u),t.onClose({code:4,reason:"connection closed"})},s.onmessage=function(u){t.onMessage(u.data)},o._onClose=function(){t.onClose({code:4,reason:"connection closed"})}}close(){this._transport.close(),this._onClose!==null&&this._onClose()}send(e,t,r){let n={session:t,node:r,data:e},s={"Content-Type":"application/json"},o=JSON.stringify(n);this.options.fetch(this.options.emulationEndpoint,{method:"POST",headers:s,mode:this.options.emulationRequestMode,body:o})}};var Ue=class{encodeCommands(e){return e.map(t=>JSON.stringify(t)).join(`
`)}},ze=class{decodeReplies(e){return e.split(`
`).filter(t=>t!=="").map(t=>JSON.parse(t))}};var q={Disconnected:"disconnected",Connecting:"connecting",Connected:"connected"},de=class extends Er.default{constructor(e,t){super(),this.state=q.Disconnected,this._endpoint=e,this._emulation=!1,this._transports=[],this._currentTransportIndex=0,this._triedAllTransports=!1,this._transportWasOpen=!1,this._transport=null,this._transportClosed=!0,this._encoder=null,this._decoder=null,this._reconnectTimeout=null,this._reconnectAttempts=0,this._client=null,this._session="",this._node="",this._subs={},this._serverSubs={},this._commandId=0,this._commands=[],this._batching=!1,this._refreshRequired=!1,this._refreshTimeout=null,this._callbacks={},this._latency=null,this._latencyStart=null,this._token=null,this._dispatchPromise=Promise.resolve(),this._serverPing=0,this._serverPingTimeout=null,this._sendPong=!1,this._promises={},this._promiseId=0,this._debugEnabled=!1,this._config={protocol:"json",token:null,data:null,debug:!1,name:"js",version:"",fetch:null,readableStream:null,websocket:null,eventsource:null,sockjs:null,sockjsServer:null,sockjsTimeout:null,sockjsTransports:["websocket","xdr-streaming","xhr-streaming","eventsource","iframe-eventsource","iframe-htmlfile","xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"],httpStreamRequestMode:"cors",emulationEndpoint:"/emulation",emulationRequestMode:"cors",minReconnectDelay:500,maxReconnectDelay:2e4,timeout:5e3,maxServerPingDelay:1e4,getToken:null},this._configure(t),this._debugEnabled&&(this.on("state",function(r){this._debug("client state",r.oldState,"->",r.newState)}),this.on("error",function(r){this._debug("client error",r)}))}newSubscription(e,t){if(this.getSubscription(e)!==null)throw new Error("Subscription to the channel "+e+" already exists");let r=new Fe(this,e,t);return this._subs[e]=r,r}getSubscription(e){return this._getSub(e)}removeSubscription(e){if(!!e){if(e.state!==L.Unsubscribed)throw new Error("Subscription must be in unsubscribed state to be removed");this._removeSubscription(e)}}subscriptions(){return this._subs}ready(e){return this.state===q.Disconnected?Promise.reject({code:R.clientDisconnected,message:"client disconnected"}):this.state===q.Connected?Promise.resolve():new Promise((t,r)=>{let n={resolve:t,reject:r};e&&(n.timeout=setTimeout(function(){r({code:R.timeout,message:"timeout"})},e)),this._promises[this._nextPromiseId()]=n})}connect(){if(this._isConnected()){this._debug("connect called when already connected");return}if(this._isConnecting()){this._debug("connect called when already connecting");return}this._reconnectAttempts=0,this._startConnecting()}disconnect(){this._disconnect(je.disconnectCalled,"disconnect called",!1)}send(e){let t={send:{data:e}},r=this;return this._methodCall().then(function(){return r._transportSendCommands([t])?Promise.resolve():Promise.reject(r._createErrorObject(R.transportWriteError,"transport write error"))})}rpc(e,t){let r={rpc:{method:e,data:t}},n=this;return this._methodCall().then(function(){return n._callPromise(r,function(s){return{data:s.rpc.data}})})}publish(e,t){let r={publish:{channel:e,data:t}},n=this;return this._methodCall().then(function(){return n._callPromise(r,function(){return{}})})}history(e,t){let r={history:this._getHistoryRequest(e,t)},n=this;return this._methodCall().then(function(){return n._callPromise(r,function(s){let o=s.history,u=[];if(o.publications)for(let a=0;a<o.publications.length;a++)u.push(n._getPublicationContext(e,o.publications[a]));return{publications:u,epoch:o.epoch||"",offset:o.offset||0}})})}presence(e){let t={presence:{channel:e}},r=this;return this._methodCall().then(function(){return r._callPromise(t,function(n){return{clients:n.presence.presence}})})}presenceStats(e){let t={presence_stats:{channel:e}},r=this;return this._methodCall().then(function(){return r._callPromise(t,function(n){let s=n.presence_stats;return{numUsers:s.num_users,numClients:s.num_clients}})})}startBatching(){this._batching=!0}stopBatching(){this._batching=!1,this._flush()}_log(){dt("info",arguments)}_debug(){!this._debugEnabled||dt("debug",arguments)}_setFormat(e){if(!this._formatOverride(e)){if(e==="protobuf")throw new Error("not implemented by JSON-only Centrifuge client, use client with Protobuf support");this._encoder=new Ue,this._decoder=new ze}}_formatOverride(e){return!1}_configure(e){if(!("Promise"in global))throw new Error("Promise polyfill required");if(kr(this._config,e||{}),!this._endpoint)throw new Error("endpoint configuration required");if(this._config.protocol!=="json"&&this._config.protocol!=="protobuf")throw new Error("unsupported protocol "+this._config.protocol);if(this._config.token!==null&&(this._token=this._config.token),this._setFormat("json"),this._config.protocol==="protobuf"&&this._setFormat("protobuf"),(this._config.debug===!0||typeof localStorage!="undefined"&&localStorage.getItem("centrifuge.debug"))&&(this._debugEnabled=!0),this._debug("config",this._config),typeof this._endpoint!="string")if(typeof this._endpoint=="object"&&this._endpoint instanceof Array){this._transports=this._endpoint,this._emulation=!0;for(let t in this._transports){let r=this._transports[t];if(!r.endpoint||!r.transport)throw new Error("malformed transport configuration");let n=r.transport;if(["websocket","http_stream","sse","sockjs"].indexOf(n)<0)throw new Error("unsupported transport name: "+n)}}else throw new Error("unsupported url configuration type: only string or array of objects are supported")}_setState(e){if(this.state!==e){let t=this.state;return this.state=e,this.emit("state",{newState:e,oldState:t}),!0}return!1}_isDisconnected(){return this.state===q.Disconnected}_isConnecting(){return this.state===q.Connecting}_isConnected(){return this.state===q.Connected}_nextCommandId(){return++this._commandId}_getReconnectDelay(){let e=le(this._reconnectAttempts,this._config.minReconnectDelay,this._config.maxReconnectDelay);return this._reconnectAttempts+=1,e}_clearOutgoingRequests(){for(let e in this._callbacks)if(this._callbacks.hasOwnProperty(e)){let t=this._callbacks[e];clearTimeout(t.timeout);let r=t.errback;if(!r)continue;r({error:this._createErrorObject(R.connectionClosed,"connection closed")})}this._callbacks={}}_clearConnectedState(){this._client=null,this._clearServerPingTimeout(),this._clearRefreshTimeout();for(let e in this._subs){if(!this._subs.hasOwnProperty(e))continue;let t=this._subs[e];t._isSubscribed()&&t._setSubscribing(Ie.transportClosed,"transport closed")}for(let e in this._serverSubs)this._serverSubs.hasOwnProperty(e)&&this.emit("subscribing",{channel:e})}_handleWriteError(e){for(let t in e){let r=t.id;if(!(r in this._callbacks))continue;let n=this._callbacks[r];clearTimeout(this._callbacks[r].timeout),delete this._callbacks[r],n.errback({error:this._createErrorObject(R.transportWriteError,"transport write error")})}}_transportSendCommands(e){if(!e.length)return!0;try{this._transport.send(this._encoder.encodeCommands(e),this._session,this._node)}catch(t){return this._debug("error writing commands",t),this._handleWriteError(e),!1}return!0}_initializeTransport(){let e;this._config.websocket!==null?e=this._config.websocket:typeof WebSocket!="function"&&typeof WebSocket!="object"||(e=WebSocket);let t=null;this._config.sockjs!==null?t=this._config.sockjs:typeof global.SockJS!="undefined"&&(t=global.SockJS);let r=null;this._config.eventsource!==null?r=this._config.eventsource:typeof global.EventSource!="undefined"&&(r=global.EventSource);let n=null;this._config.fetch!==null?n=this._config.fetch:typeof global.fetch!="undefined"&&(n=global.fetch);let s=null;if(this._config.readableStream!==null?s=this._config.readableStream:typeof global.ReadableStream!="undefined"&&(s=global.ReadableStream),this._emulation){this._currentTransportIndex>=this._transports.length&&(this._triedAllTransports=!0,this._currentTransportIndex=0);let f=0;for(;;){if(f>=this._transports.length)throw new Error("no supported transport found");let p=this._transports[this._currentTransportIndex],m=p.transport,h=p.endpoint;if(m==="websocket"){if(this._debug("trying websocket transport"),this._transport=new we(h,{websocket:e}),!this._transport.supported()){this._debug("websocket transport not available"),this._currentTransportIndex++,f++;continue}}else if(m==="http_stream"){if(this._debug("trying http_stream transport"),this._transport=new Me(h,{fetch:n,readableStream:s,requestMode:this._config.httpStreamRequestMode,emulationEndpoint:this._config.emulationEndpoint,emulationRequestMode:this._config.emulationRequestMode,decoder:this._decoder,encoder:this._encoder}),!this._transport.supported()){this._debug("http_stream transport not available"),this._currentTransportIndex++,f++;continue}}else if(m==="sse"){if(this._debug("trying sse transport"),this._transport=new Je(h,{eventsource:r,fetch:n,emulationEndpoint:this._config.emulationEndpoint,emulationRequestMode:this._config.emulationRequestMode}),!this._transport.supported()){this._debug("sse transport not available"),this._currentTransportIndex++,f++;continue}}else if(m==="sockjs"){if(this._debug("trying sockjs"),this._transport=new ve(h,{sockjs:t,transports:this._config.sockjsTransports,server:this._config.sockjsServer,timeout:this._config.sockjsTimeout}),!this._transport.supported()){this._debug("sockjs transport not available"),this._currentTransportIndex++,f++;continue}}else throw new Error("unknown transport "+m);break}}else if(Sr(this._endpoint,"http")){if(this._debug("client will use sockjs"),this._transport=new ve(this._endpoint,{sockjs:t,transports:this._config.sockjsTransports,server:this._config.sockjsServer,timeout:this._config.sockjsTimeout}),!this._transport.supported())throw new Error("SockJS not available, use ws(s):// in url or include SockJS")}else if(this._debug("client will use websocket"),this._transport=new we(this._endpoint,{websocket:e}),!this._transport.supported())throw new Error("WebSocket not available");let o=this._constructConnectCommand();this._transport.emulation()&&(this._latencyStart=new Date,o.id=this._nextCommandId(),this._callConnectFake(o.id).then(f=>{let p=f.reply.connect;this._connectResponse(p),f.next&&f.next()},f=>{f.error.code>=100&&this._connectError(f.error),f.next&&f.next()}));let u=this,a,c=!1;this._transport.initialize(this._config.protocol,{onOpen:function(){c=!0,a=u._transport.subName(),u._debug(a,"transport open"),u._transportWasOpen=!0,u._transportClosed=!1,!u._transport.emulation()&&(u._latencyStart=new Date,u._sendConnect())},onError:function(f){u._debug("transport level error",f)},onClose:function(f){u._debug(u._transport.name(),"transport closed"),u._transportClosed=!0;let p="connection closed",m=!0,h=0;if(f&&"code"in f&&f.code&&(h=f.code),f&&f.reason)try{let y=JSON.parse(f.reason);p=y.reason,m=y.reconnect}catch(y){p=f.reason,(h>=3500&&h<4e3||h>=4500&&h<5e3)&&(m=!1)}h<3e3?(h===1009?(h=je.messageSizeLimit,p="message size limit exceeded",m=!1):(h=fe.transportClosed,p="transport closed"),u._emulation&&!u._transportWasOpen&&(u._currentTransportIndex++,u._currentTransportIndex>=u._transports.length&&(u._triedAllTransports=!0,u._currentTransportIndex=0))):u._transportWasOpen=!0;let S=!1;if(u._emulation&&!u._transportWasOpen&&!u._triedAllTransports&&(S=!0),u._isConnecting()&&!c&&u.emit("error",{type:"transport",error:{code:R.transportClosed,message:"transport closed"},transport:u._transport.name()}),u._disconnect(h,p,m),u._isConnecting()){let y=u._getReconnectDelay();S&&(y=0),u._debug("reconnect after "+y+" milliseconds"),u._reconnectTimeout=setTimeout(()=>{u._startReconnecting()},y)}},onMessage:function(f){u._dataReceived(f)}},this._encoder.encodeCommands([o]))}_sendConnect(){let e=this._constructConnectCommand(),t=this;this._call(e).then(r=>{let n=r.reply.connect;t._connectResponse(n),r.next&&r.next()},r=>{t._connectError(r.error),r.next&&r.next()})}_startReconnecting(){if(!this._isConnecting())return;if(!(this._refreshRequired||!this._token&&this._config.getToken!==null)){this._startConnecting();return}let t=this;this._getToken().then(function(r){if(!!t._isConnecting()){if(!r){t._failUnauthorized();return}t._token=r,t._debug("connection token refreshed"),t._startConnecting()}}).catch(function(r){if(!t._isConnecting())return;this.emit("error",{type:"connectToken",error:{code:R.clientConnectToken,message:r!==void 0?r.toString():""}});let n=t._getReconnectDelay();t._debug("error on connection token refresh, reconnect after "+n+" milliseconds",r),t._reconnectTimeout=setTimeout(()=>{t._startReconnecting()},n)})}_connectError(e){this.state===q.Connecting&&(e.code===109&&(this._refreshRequired=!0),e.code<100||e.temporary===!0||e.code===109?(this.emit("error",{type:"connect",error:e}),this._transport&&!this._transportClosed&&(this._transportClosed=!0,this._transport.close())):this._disconnect(e.code,e.message,!1))}_constructConnectCommand(){let e={};this._token&&(e.token=this._token),this._config.data&&(e.data=this._config.data),this._config.name&&(e.name=this._config.name),this._config.version&&(e.version=this._config.version);let t={},r=!1;for(let n in this._serverSubs)if(this._serverSubs.hasOwnProperty(n)&&this._serverSubs[n].recoverable){r=!0;let s={recover:!0};this._serverSubs[n].offset&&(s.offset=this._serverSubs[n].offset),this._serverSubs[n].epoch&&(s.epoch=this._serverSubs[n].epoch),t[n]=s}return r&&(e.subs=t),{connect:e}}_getHistoryRequest(e,t){let r={channel:e};return t!==void 0&&(t.since&&(r.since={offset:t.since.offset},t.since.epoch&&(r.since.epoch=t.since.epoch)),t.limit!==void 0&&(r.limit=t.limit),t.reverse===!0&&(r.reverse=!0)),r}_methodCall(){return this._isConnected()?Promise.resolve():new Promise((e,t)=>{let r=setTimeout(function(){t({code:R.timeout,message:"timeout"})},this._config.timeout);this._promises[this._nextPromiseId()]={timeout:r,resolve:e,reject:t}})}_callPromise(e,t){return new Promise((r,n)=>{this._call(e).then(s=>{r(t(s.reply)),s.next&&s.next()},s=>{n(s.error),s.next&&s.next()})})}_dataReceived(e){this._serverPing>0&&this._waitServerPing();let t=this._decoder.decodeReplies(e);this._dispatchPromise=this._dispatchPromise.then(()=>{let r;this._dispatchPromise=new Promise(n=>{r=n}),this._dispatchSynchronized(t,r)})}_dispatchSynchronized(e,t){let r=Promise.resolve();for(let n in e)e.hasOwnProperty(n)&&(r=r.then(()=>this._dispatchReply(e[n])));r=r.then(()=>{t()})}_dispatchReply(e){var t;let r=new Promise(s=>{t=s});if(e==null)return this._debug("dispatch: got undefined or null reply"),t(),r;let n=e.id;return n&&n>0?this._handleReply(e,t):e.push?this._handlePush(e.push,t):this._handleServerPing(t),r}_call(e){return new Promise((t,r)=>{e.id=this._nextCommandId(),this._registerCall(e.id,t,r),this._addCommand(e)})}_callConnectFake(e){return new Promise((t,r)=>{this._registerCall(e,t,r)})}_startConnecting(){this._debug("start connecting"),this._setState(q.Connecting)&&this.emit("connecting",{code:fe.connectCalled,reason:"connect called"}),this._client=null,this._initializeTransport()}_disconnect(e,t,r){if(this._isDisconnected())return;let n=this.state,s={code:e,reason:t},o=!1;r?o=this._setState(q.Connecting):(o=this._setState(q.Disconnected),this._rejectPromises({code:R.clientDisconnected,message:"disconnected"})),this._clearOutgoingRequests(),n===q.Connecting&&this._clearReconnectTimeout(),n===q.Connected&&this._clearConnectedState(),o&&(this._isConnecting()?this.emit("connecting",s):this.emit("disconnected",s)),this._transport&&!this._transportClosed&&(this._transportClosed=!0,this._transport.close())}_failUnauthorized(){this._disconnect(je.unauthorized,"unauthorized",!1)}_getToken(){if(this._debug("get connection token"),this._config.getToken===null)throw new Error("provide a function to get connection token");return this._config.getToken({})}_refresh(){let e=this._client,t=this;this._getToken().then(function(r){if(e!==t._client)return;if(!r){t._failUnauthorized();return}if(t._token=r,t._debug("connection token refreshed"),!t._isConnected())return;let n={refresh:{token:t._token}};t._call(n).then(s=>{let o=s.reply.refresh;t._refreshResponse(o),s.next&&s.next()},s=>{t._refreshError(s.error),s.next&&s.next()})}).catch(function(r){t.emit("error",{type:"refreshToken",error:{code:R.clientRefreshToken,message:r!==void 0?r.toString():""}}),t._refreshTimeout=setTimeout(()=>t._refresh(),t._getRefreshRetryDelay())})}_refreshError(e){e.code<100||e.temporary===!0?(this.emit("error",{type:"refresh",error:e}),this._refreshTimeout=setTimeout(()=>this._refresh(),this._getRefreshRetryDelay())):this._disconnect(e.code,e.message,!1)}_getRefreshRetryDelay(){return le(0,5e3,1e4)}_refreshResponse(e){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),e.expires&&(this._client=e.client,this._refreshTimeout=setTimeout(()=>this._refresh(),he(e.ttl)))}_subscribe(e){this._debug("subscribing on",e.channel);let t=e.channel;if(t in this._subs||(this._subs[t]=e),!this._isConnected()){this._debug("delay subscribe on",e.channel,"till connected");return}if(e._usesToken()){let r=this._client,n=this;e._token?this._sendSubscribe(e,e._token):e._getSubscriptionToken().then(function(s){if(r===n._client&&!!e._isSubscribing()){if(!s){e._failUnauthorized();return}e._token=s,n._sendSubscribe(e,s)}}).catch(function(s){!e._isSubscribing()||(e.emit("error",{type:"subscribeToken",channel:e.channel,error:{code:R.subscriptionSubscribeToken,message:s!==void 0?s.toString():""}}),e._scheduleResubscribe())})}else this._sendSubscribe(e)}_sendSubscribe(e,t){let r=e.channel,n={channel:r};if(t&&(n.token=t),e._data&&(n.data=e._data),e._positioned&&(n.positioned=!0),e._recoverable&&(n.recoverable=!0),e._needRecover()){n.recover=!0;let o=e._getOffset();o&&(n.offset=o);let u=e._getEpoch();u&&(n.epoch=u)}let s={subscribe:n};this._call(s).then(o=>{let u=o.reply.subscribe;this._subscribeResponse(r,u),o.next&&o.next()},o=>{this._subscribeError(r,o.error),o.next&&o.next()})}_sendSubRefresh(e,t){let n={sub_refresh:{channel:e.channel,token:t}};this._call(n).then(s=>{let o=s.reply.sub_refresh;e._refreshResponse(o),s.next&&s.next()},s=>{e._refreshError(s.error),s.next&&s.next()})}_removeSubscription(e){e!==null&&delete this._subs[e.channel]}_unsubscribe(e){if(!this._isConnected())return;let r={unsubscribe:{channel:e.channel}},n=this;this._call(r).then(s=>{s.next&&s.next()},s=>{s.next&&s.next(),n._disconnect(fe.unsubscribeError,"unsubscribe error",!0)})}_getSub(e){let t=this._subs[e];return t||null}_isServerSub(e){return this._serverSubs[e]!==void 0}_connectResponse(e){if(this._transportWasOpen=!0,this._reconnectAttempts=0,this._refreshRequired=!1,this._isConnected())return;this._latencyStart!==null&&(this._latency=new Date().getTime()-this._latencyStart.getTime(),this._latencyStart=null),this._client=e.client,this._setState(q.Connected),this._refreshTimeout&&clearTimeout(this._refreshTimeout),e.expires&&(this._refreshTimeout=setTimeout(()=>this._refresh(),he(e.ttl))),this._session=e.session,this._node=e.node,this.startBatching();for(let r in this._subs)if(this._subs.hasOwnProperty(r)){let n=this._subs[r];n._isSubscribing()&&this._subscribe(n)}this.stopBatching();let t={client:e.client,transport:this._transport.subName()};e.data&&(t.data=e.data),this.emit("connected",t),this._resolvePromises(),this._processServerSubs(e.subs||{}),e.ping&&e.ping>0?(this._serverPing=e.ping*1e3,this._sendPong=e.pong===!0,this._waitServerPing()):this._serverPing=0}_processServerSubs(e){for(let t in e){if(!e.hasOwnProperty(t))continue;let r=e[t];this._serverSubs[t]={offset:r.offset,epoch:r.epoch,recoverable:r.recoverable||!1};let n=this._getSubscribeContext(t,r);this.emit("subscribed",n)}for(let t in e){if(!e.hasOwnProperty(t))continue;let r=e[t];if(r.recovered){let n=r.publications;if(n&&n.length>0)for(let s in n)n.hasOwnProperty(s)&&this._handlePublication(t,n[s])}}for(let t in this._serverSubs)!this._serverSubs.hasOwnProperty(t)||e[t]||(this.emit("unsubscribed",{channel:t}),delete this._serverSubs[t])}_clearRefreshTimeout(){this._refreshTimeout!==null&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearReconnectTimeout(){this._reconnectTimeout!==null&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null)}_clearServerPingTimeout(){this._serverPingTimeout!==null&&(clearTimeout(this._serverPingTimeout),this._serverPingTimeout=null)}_waitServerPing(){this._config.maxServerPingDelay!==0&&(!this._isConnected()||(this._clearServerPingTimeout(),this._serverPingTimeout=setTimeout(()=>{!this._isConnected()||this._disconnect(fe.noPing,"no ping",!0)},this._serverPing+this._config.maxServerPingDelay)))}_subscribeError(e,t){let r=this._getSub(e);if(!!r&&!!r._isSubscribing()){if(t.code===R.timeout){this._disconnect(fe.subscribeTimeout,"subscribe timeout",!0);return}r._subscribeError(t)}}_getSubscribeContext(e,t){let r={channel:e,positioned:!1,recoverable:!1,wasRecovering:!1,recovered:!1};t.recovered&&(r.recovered=!0),t.positioned&&(r.positioned=!0),t.recoverable&&(r.recoverable=!0),t.was_recovering&&(r.wasRecovering=!0);let n="";"epoch"in t&&(n=t.epoch);let s=0;return"offset"in t&&(s=t.offset),(r.positioned||r.recoverable)&&(r.streamPosition={offset:s,epoch:n}),t.data&&(r.data=t.data),r}_subscribeResponse(e,t){let r=this._getSub(e);!r||!r._isSubscribing()||r._setSubscribed(t)}_handleReply(e,t){let r=e.id;if(!(r in this._callbacks)){t();return}let n=this._callbacks[r];if(clearTimeout(this._callbacks[r].timeout),delete this._callbacks[r],Or(e)){let s=n.errback;if(!s){t();return}let o=e.error;s({error:o,next:t})}else{let s=n.callback;if(!s)return;s({reply:e,next:t})}}_handleJoin(e,t){let r=this._getSub(e);if(!r){if(this._isServerSub(e)){let n={channel:e,info:this._getJoinLeaveContext(t.info)};this.emit("join",n)}return}r._handleJoin(t)}_handleLeave(e,t){let r=this._getSub(e);if(!r){if(this._isServerSub(e)){let n={channel:e,info:this._getJoinLeaveContext(t.info)};this.emit("leave",n)}return}r._handleLeave(t)}_handleUnsubscribe(e,t){let r=this._getSub(e);if(!r){this._isServerSub(e)&&(delete this._serverSubs[e],this.emit("unsubscribed",{channel:e}));return}t.code<2500?r._setUnsubscribed(t.code,t.reason,!1):r._setSubscribing(t.code,t.reason,!1)}_handleSubscribe(e,t){this._serverSubs[e]={offset:t.offset,epoch:t.epoch,recoverable:t.recoverable||!1},this.emit("subscribed",this._getSubscribeContext(e,t))}_handleDisconnect(e){let t=e.code,r=!0;(t>=3500&&t<4e3||t>=4500&&t<5e3)&&(r=!1),this._disconnect(t,e.reason,r)}_getPublicationContext(e,t){let r={channel:e,data:t.data};return t.offset&&(r.offset=t.offset),t.info&&(r.info=this._getJoinLeaveContext(t.info)),t.tags&&(r.tags=t.tags),r}_getJoinLeaveContext(e){let t={client:e.client,user:e.user};return e.conn_info&&(t.connInfo=e.conn_info),e.chan_info&&(t.chanInfo=e.chan_info),t}_handlePublication(e,t){let r=this._getSub(e);if(!r){if(this._isServerSub(e)){let n=this._getPublicationContext(e,t);this.emit("publication",n),t.offset!==void 0&&(this._serverSubs[e].offset=t.offset)}return}r._handlePublication(t)}_handleMessage(e){this.emit("message",e.data)}_handleServerPing(e){if(this._sendPong){let t={};this._transportSendCommands([t])}e()}_handlePush(e,t){let r=e.channel;e.pub?this._handlePublication(r,e.pub):e.message?this._handleMessage(e.message):e.join?this._handleJoin(r,e.join):e.leave?this._handleLeave(r,e.leave):e.unsubscribe?this._handleUnsubscribe(r,e.unsubscribe):e.subscribe?this._handleSubscribe(r,e.subscribe):e.disconnect&&this._handleDisconnect(e.disconnect),t()}_flush(){let e=this._commands.slice(0);this._commands=[],this._transportSendCommands(e)}_createErrorObject(e,t,r){let n={code:e,message:t};return r&&(n.temporary=!0),n}_registerCall(e,t,r){this._callbacks[e]={callback:t,errback:r,timeout:null},this._callbacks[e].timeout=setTimeout(()=>{delete this._callbacks[e],ht(r)&&r({error:this._createErrorObject(R.timeout,"timeout")})},this._config.timeout)}_addCommand(e){this._batching?this._commands.push(e):this._transportSendCommands([e])}_nextPromiseId(){return++this._promiseId}_resolvePromises(){for(let e in this._promises)this._promises[e].timeout&&clearTimeout(this._promises[e].timeout),this._promises[e].resolve(),delete this._promises[e]}_rejectPromises(e){for(let t in this._promises)this._promises[t].timeout&&clearTimeout(this._promises[t].timeout),this._promises[t].reject(e),delete this._promises[t]}};de.State=q;de.SubscriptionState=L;var Le=hn(),cr=Le.Root.fromJSON(dn()),vs=cr.lookupType("protocol.Command"),pn=cr.lookupType("protocol.Reply"),ws=cr.lookupType("protocol.EmulationRequest"),ur=class{encodeEmulationRequest(e){let t=Le.Writer.create();return ws.encode(e,t),t.finish()}encodeCommands(e){let t=Le.Writer.create();for(let r in e)if(e.hasOwnProperty(r)){let n=Object.assign({},e[r]);vs.encodeDelimited(n,t)}return t.finish()}},ar=class{decodeReplies(e){let t=[],r=Le.Reader.create(new Uint8Array(e));for(;r.pos<r.len;){let n=pn.decodeDelimited(r);t.push(n)}return t}decodeReply(e){let t=Le.Reader.create(new Uint8Array(e));for(;t.pos<t.len;)return pn.decodeDelimited(t),{ok:!0,pos:t.pos};return{ok:!1}}},at=class extends de{_formatOverride(e){return e==="protobuf"?(this._encoder=new ur,this._decoder=new ar,!0):!1}};var mn=at;window.Centrifuge=mn;})();
