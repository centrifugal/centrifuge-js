(()=>{var Si=Object.create;var ct=Object.defineProperty;var wi=Object.getOwnPropertyDescriptor;var xi=Object.getOwnPropertyNames,hr=Object.getOwnPropertySymbols,Ei=Object.getPrototypeOf,pr=Object.prototype.hasOwnProperty,Oi=Object.prototype.propertyIsEnumerable;var dr=(n,e,t)=>e in n?ct(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,lt=(n,e)=>{for(var t in e||(e={}))pr.call(e,t)&&dr(n,t,e[t]);if(hr)for(var t of hr(e))Oi.call(e,t)&&dr(n,t,e[t]);return n};var d=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var ki=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of xi(e))!pr.call(n,i)&&i!==t&&ct(n,i,{get:()=>e[i],enumerable:!(r=wi(e,i))||r.enumerable});return n};var mr=(n,e,t)=>(t=n!=null?Si(Ei(n)):{},ki(e||!n||!n.__esModule?ct(t,"default",{value:n,enumerable:!0}):t,n));var M=(n,e,t)=>new Promise((r,i)=>{var s=u=>{try{a(t.next(u))}catch(c){i(c)}},o=u=>{try{a(t.throw(u))}catch(c){i(c)}},a=u=>u.done?r(u.value):Promise.resolve(u.value).then(s,o);a((t=t.apply(n,e)).next())});var ht=d((Ts,ft)=>{"use strict";var ae=typeof Reflect=="object"?Reflect:null,yr=ae&&typeof ae.apply=="function"?ae.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},Le;ae&&typeof ae.ownKeys=="function"?Le=ae.ownKeys:Object.getOwnPropertySymbols?Le=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Le=function(e){return Object.getOwnPropertyNames(e)};function Ri(n){console&&console.warn&&console.warn(n)}var br=Number.isNaN||function(e){return e!==e};function S(){S.init.call(this)}ft.exports=S;ft.exports.once=Ai;S.EventEmitter=S;S.prototype._events=void 0;S.prototype._eventsCount=0;S.prototype._maxListeners=void 0;var _r=10;function De(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(S,"defaultMaxListeners",{enumerable:!0,get:function(){return _r},set:function(n){if(typeof n!="number"||n<0||br(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");_r=n}});S.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};S.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||br(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function gr(n){return n._maxListeners===void 0?S.defaultMaxListeners:n._maxListeners}S.prototype.getMaxListeners=function(){return gr(this)};S.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=s[e];if(u===void 0)return!1;if(typeof u=="function")yr(u,this,t);else for(var c=u.length,l=Er(u,c),r=0;r<c;++r)yr(l[r],this,t);return!0};function vr(n,e,t,r){var i,s,o;if(De(t),s=n._events,s===void 0?(s=n._events=Object.create(null),n._eventsCount=0):(s.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),s=n._events),o=s[e]),o===void 0)o=s[e]=t,++n._eventsCount;else if(typeof o=="function"?o=s[e]=r?[t,o]:[o,t]:r?o.unshift(t):o.push(t),i=gr(n),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=o.length,Ri(a)}return n}S.prototype.addListener=function(e,t){return vr(this,e,t,!1)};S.prototype.on=S.prototype.addListener;S.prototype.prependListener=function(e,t){return vr(this,e,t,!0)};function Ti(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Sr(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=Ti.bind(r);return i.listener=t,r.wrapFn=i,i}S.prototype.once=function(e,t){return De(t),this.on(e,Sr(this,e,t)),this};S.prototype.prependOnceListener=function(e,t){return De(t),this.prependListener(e,Sr(this,e,t)),this};S.prototype.removeListener=function(e,t){var r,i,s,o,a;if(De(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():Ci(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};S.prototype.off=S.prototype.removeListener;S.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function wr(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Pi(i):Er(i,i.length)}S.prototype.listeners=function(e){return wr(this,e,!0)};S.prototype.rawListeners=function(e){return wr(this,e,!1)};S.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):xr.call(n,e)};S.prototype.listenerCount=xr;function xr(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}S.prototype.eventNames=function(){return this._eventsCount>0?Le(this._events):[]};function Er(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function Ci(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function Pi(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function Ai(n,e){return new Promise(function(t,r){function i(o){n.removeListener(e,s),r(o)}function s(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}Or(n,e,s,{once:!0}),e!=="error"&&qi(n,i,{once:!0})})}function qi(n,e,t){typeof n.on=="function"&&Or(n,"error",e,t)}function Or(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(s){r.once&&n.removeEventListener(e,i),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}});var yt=d((bo,Ar)=>{"use strict";Ar.exports=Di;function Di(n,e){for(var t=new Array(arguments.length-1),r=0,i=2,s=!0;i<arguments.length;)t[r++]=arguments[i++];return new Promise(function(a,u){t[r]=function(l){if(s)if(s=!1,l)u(l);else{for(var h=new Array(arguments.length-1),y=0;y<h.length;)h[y++]=arguments[y];a.apply(null,h)}};try{n.apply(e||null,t)}catch(c){s&&(s=!1,u(c))}})}});var Dr=d(Lr=>{"use strict";var $e=Lr;$e.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&e.charAt(t)==="=";)++r;return Math.ceil(e.length*3)/4-r};var de=new Array(64),Nr=new Array(123);for(J=0;J<64;)Nr[de[J]=J<26?J+65:J<52?J+71:J<62?J-4:J-59|43]=J++;var J;$e.encode=function(e,t,r){for(var i=null,s=[],o=0,a=0,u;t<r;){var c=e[t++];switch(a){case 0:s[o++]=de[c>>2],u=(c&3)<<4,a=1;break;case 1:s[o++]=de[u|c>>4],u=(c&15)<<2,a=2;break;case 2:s[o++]=de[u|c>>6],s[o++]=de[c&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=de[u],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var qr="invalid encoding";$e.decode=function(e,t,r){for(var i=r,s=0,o,a=0;a<e.length;){var u=e.charCodeAt(a++);if(u===61&&s>1)break;if((u=Nr[u])===void 0)throw Error(qr);switch(s){case 0:o=u,s=1;break;case 1:t[r++]=o<<2|(u&48)>>4,o=u,s=2;break;case 2:t[r++]=(o&15)<<4|(u&60)>>2,o=u,s=3;break;case 3:t[r++]=(o&3)<<6|u,s=0;break}}if(s===1)throw Error(qr);return r-i};$e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Ir=d((vo,Br)=>{"use strict";Br.exports=He;function He(){this._listeners={}}He.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this};He.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this};He.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}});var $r=d((So,zr)=>{"use strict";zr.exports=jr(jr);function jr(n){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=t[3]===128;function i(u,c,l){e[0]=u,c[l]=t[0],c[l+1]=t[1],c[l+2]=t[2],c[l+3]=t[3]}function s(u,c,l){e[0]=u,c[l]=t[3],c[l+1]=t[2],c[l+2]=t[1],c[l+3]=t[0]}n.writeFloatLE=r?i:s,n.writeFloatBE=r?s:i;function o(u,c){return t[0]=u[c],t[1]=u[c+1],t[2]=u[c+2],t[3]=u[c+3],e[0]}function a(u,c){return t[3]=u[c],t[2]=u[c+1],t[1]=u[c+2],t[0]=u[c+3],e[0]}n.readFloatLE=r?o:a,n.readFloatBE=r?a:o}():function(){function e(r,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)r(1/i>0?0:2147483648,s,o);else if(isNaN(i))r(2143289344,s,o);else if(i>34028234663852886e22)r((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)r((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var u=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-u)*8388608)&8388607;r((a<<31|u+127<<23|c)>>>0,s,o)}}n.writeFloatLE=e.bind(null,Fr),n.writeFloatBE=e.bind(null,Mr);function t(r,i,s){var o=r(i,s),a=(o>>31)*2+1,u=o>>>23&255,c=o&8388607;return u===255?c?NaN:a*(1/0):u===0?a*1401298464324817e-60*c:a*Math.pow(2,u-150)*(c+8388608)}n.readFloatLE=t.bind(null,Jr),n.readFloatBE=t.bind(null,Ur)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=t[7]===128;function i(u,c,l){e[0]=u,c[l]=t[0],c[l+1]=t[1],c[l+2]=t[2],c[l+3]=t[3],c[l+4]=t[4],c[l+5]=t[5],c[l+6]=t[6],c[l+7]=t[7]}function s(u,c,l){e[0]=u,c[l]=t[7],c[l+1]=t[6],c[l+2]=t[5],c[l+3]=t[4],c[l+4]=t[3],c[l+5]=t[2],c[l+6]=t[1],c[l+7]=t[0]}n.writeDoubleLE=r?i:s,n.writeDoubleBE=r?s:i;function o(u,c){return t[0]=u[c],t[1]=u[c+1],t[2]=u[c+2],t[3]=u[c+3],t[4]=u[c+4],t[5]=u[c+5],t[6]=u[c+6],t[7]=u[c+7],e[0]}function a(u,c){return t[7]=u[c],t[6]=u[c+1],t[5]=u[c+2],t[4]=u[c+3],t[3]=u[c+4],t[2]=u[c+5],t[1]=u[c+6],t[0]=u[c+7],e[0]}n.readDoubleLE=r?o:a,n.readDoubleBE=r?a:o}():function(){function e(r,i,s,o,a,u){var c=o<0?1:0;if(c&&(o=-o),o===0)r(0,a,u+i),r(1/o>0?0:2147483648,a,u+s);else if(isNaN(o))r(0,a,u+i),r(2146959360,a,u+s);else if(o>17976931348623157e292)r(0,a,u+i),r((c<<31|2146435072)>>>0,a,u+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,r(l>>>0,a,u+i),r((c<<31|l/4294967296)>>>0,a,u+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),l=o*Math.pow(2,-h),r(l*4503599627370496>>>0,a,u+i),r((c<<31|h+1023<<20|l*1048576&1048575)>>>0,a,u+s)}}}n.writeDoubleLE=e.bind(null,Fr,0,4),n.writeDoubleBE=e.bind(null,Mr,4,0);function t(r,i,s,o,a){var u=r(o,a+i),c=r(o,a+s),l=(c>>31)*2+1,h=c>>>20&2047,y=4294967296*(c&1048575)+u;return h===2047?y?NaN:l*(1/0):h===0?l*5e-324*y:l*Math.pow(2,h-1075)*(y+4503599627370496)}n.readDoubleLE=t.bind(null,Jr,0,4),n.readDoubleBE=t.bind(null,Ur,4,0)}(),n}function Fr(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function Mr(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function Jr(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function Ur(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var _t=d((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var Wr=d(Hr=>{"use strict";var bt=Hr;bt.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)r=e.charCodeAt(i),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};bt.read=function(e,t,r){var i=r-t;if(i<1)return"";for(var s=null,o=[],a=0,u;t<r;)u=e[t++],u<128?o[a++]=u:u>191&&u<224?o[a++]=(u&31)<<6|e[t++]&63:u>239&&u<365?(u=((u&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(u>>10),o[a++]=56320+(u&1023)):o[a++]=(u&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};bt.write=function(e,t,r){for(var i=r,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128);return r-i}});var Vr=d((xo,Kr)=>{"use strict";Kr.exports=Bi;function Bi(n,e,t){var r=t||8192,i=r>>>1,s=null,o=r;return function(u){if(u<1||u>i)return n(u);o+u>r&&(s=n(r),o=0);var c=e.call(s,o,o+=u);return o&7&&(o=(o|7)+1),c}}});var Zr=d((Eo,Gr)=>{"use strict";Gr.exports=T;var Se=$();function T(n,e){this.lo=n>>>0,this.hi=e>>>0}var ne=T.zero=new T(0,0);ne.toNumber=function(){return 0};ne.zzEncode=ne.zzDecode=function(){return this};ne.length=function(){return 1};var Ii=T.zeroHash="\0\0\0\0\0\0\0\0";T.fromNumber=function(e){if(e===0)return ne;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new T(r,i)};T.from=function(e){if(typeof e=="number")return T.fromNumber(e);if(Se.isString(e))if(Se.Long)e=Se.Long.fromString(e);else return T.fromNumber(parseInt(e,10));return e.low||e.high?new T(e.low>>>0,e.high>>>0):ne};T.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+r*4294967296)}return this.lo+this.hi*4294967296};T.prototype.toLong=function(e){return Se.Long?new Se.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Q=String.prototype.charCodeAt;T.fromHash=function(e){return e===Ii?ne:new T((Q.call(e,0)|Q.call(e,1)<<8|Q.call(e,2)<<16|Q.call(e,3)<<24)>>>0,(Q.call(e,4)|Q.call(e,5)<<8|Q.call(e,6)<<16|Q.call(e,7)<<24)>>>0)};T.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};T.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};T.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};T.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}});var $=d(gt=>{"use strict";var f=gt;f.asPromise=yt();f.base64=Dr();f.EventEmitter=Ir();f.float=$r();f.inquire=_t();f.utf8=Wr();f.pool=Vr();f.LongBits=Zr();f.isNode=Boolean(typeof window<"u"&&window&&window.process&&window.process.versions&&window.process.versions.node);f.global=f.isNode&&window||typeof window<"u"&&window||typeof self<"u"&&self||gt;f.emptyArray=Object.freeze?Object.freeze([]):[];f.emptyObject=Object.freeze?Object.freeze({}):{};f.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};f.isString=function(e){return typeof e=="string"||e instanceof String};f.isObject=function(e){return e&&typeof e=="object"};f.isset=f.isSet=function(e,t){var r=e[t];return r!=null&&e.hasOwnProperty(t)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};f.Buffer=function(){try{var n=f.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}();f._Buffer_from=null;f._Buffer_allocUnsafe=null;f.newBuffer=function(e){return typeof e=="number"?f.Buffer?f._Buffer_allocUnsafe(e):new f.Array(e):f.Buffer?f._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};f.Array=typeof Uint8Array<"u"?Uint8Array:Array;f.Long=f.global.dcodeIO&&f.global.dcodeIO.Long||f.global.Long||f.inquire("long");f.key2Re=/^true|false|0|1$/;f.key32Re=/^-?(?:0|[1-9][0-9]*)$/;f.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;f.longToHash=function(e){return e?f.LongBits.from(e).toHash():f.LongBits.zeroHash};f.longFromHash=function(e,t){var r=f.LongBits.fromHash(e);return f.Long?f.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))};function Xr(n,e,t){for(var r=Object.keys(e),i=0;i<r.length;++i)(n[r[i]]===void 0||!t)&&(n[r[i]]=e[r[i]]);return n}f.merge=Xr;f.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Yr(n){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&Xr(this,r)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return n}}),e.prototype.toString=function(){return this.name+": "+this.message},e}f.newError=Yr;f.ProtocolError=Yr("ProtocolError");f.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(t[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};f.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}};f.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};f._configure=function(){var n=f.Buffer;if(!n){f._Buffer_from=f._Buffer_allocUnsafe=null;return}f._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,r){return new n(t,r)},f._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var Ke=d((ko,rn)=>{"use strict";rn.exports=b;var D=$(),vt,We=D.LongBits,Qr=D.base64,en=D.utf8;function we(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function wt(){}function ji(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function b(){this.len=0,this.head=new we(wt,0,0),this.tail=this.head,this.states=null}var tn=function(){return D.Buffer?function(){return(b.create=function(){return new vt})()}:function(){return new b}};b.create=tn();b.alloc=function(e){return new D.Array(e)};D.Array!==Array&&(b.alloc=D.pool(b.alloc,D.Array.prototype.subarray));b.prototype._push=function(e,t,r){return this.tail=this.tail.next=new we(e,t,r),this.len+=t,this};function xt(n,e,t){e[t]=n&255}function Fi(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function Et(n,e){this.len=n,this.next=void 0,this.val=e}Et.prototype=Object.create(we.prototype);Et.prototype.fn=Fi;b.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Et((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};b.prototype.int32=function(e){return e<0?this._push(Ot,10,We.fromNumber(e)):this.uint32(e)};b.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ot(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}b.prototype.uint64=function(e){var t=We.from(e);return this._push(Ot,t.length(),t)};b.prototype.int64=b.prototype.uint64;b.prototype.sint64=function(e){var t=We.from(e).zzEncode();return this._push(Ot,t.length(),t)};b.prototype.bool=function(e){return this._push(xt,1,e?1:0)};function St(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}b.prototype.fixed32=function(e){return this._push(St,4,e>>>0)};b.prototype.sfixed32=b.prototype.fixed32;b.prototype.fixed64=function(e){var t=We.from(e);return this._push(St,4,t.lo)._push(St,4,t.hi)};b.prototype.sfixed64=b.prototype.fixed64;b.prototype.float=function(e){return this._push(D.float.writeFloatLE,4,e)};b.prototype.double=function(e){return this._push(D.float.writeDoubleLE,8,e)};var Mi=D.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};b.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(xt,1,0);if(D.isString(e)){var r=b.alloc(t=Qr.length(e));Qr.decode(e,r,0),e=r}return this.uint32(t)._push(Mi,t,e)};b.prototype.string=function(e){var t=en.length(e);return t?this.uint32(t)._push(en.write,t,e):this._push(xt,1,0)};b.prototype.fork=function(){return this.states=new ji(this),this.head=this.tail=new we(wt,0,0),this.len=0,this};b.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new we(wt,0,0),this.len=0),this};b.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this};b.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t};b._configure=function(n){vt=n,b.create=tn(),vt._configure()}});var on=d((Ro,sn)=>{"use strict";sn.exports=H;var nn=Ke();(H.prototype=Object.create(nn.prototype)).constructor=H;var ee=$();function H(){nn.call(this)}H._configure=function(){H.alloc=ee._Buffer_allocUnsafe,H.writeBytesBuffer=ee.Buffer&&ee.Buffer.prototype instanceof Uint8Array&&ee.Buffer.prototype.set.name==="set"?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}};H.prototype.bytes=function(e){ee.isString(e)&&(e=ee._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(H.writeBytesBuffer,t,e),this};function Ji(n,e,t){n.length<40?ee.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}H.prototype.string=function(e){var t=ee.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Ji,t,e),this};H._configure()});var Ge=d((To,fn)=>{"use strict";fn.exports=E;var W=$(),Rt,cn=W.LongBits,Ui=W.utf8;function U(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function E(n){this.buf=n,this.pos=0,this.len=n.length}var un=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new E(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new E(e);throw Error("illegal buffer")},ln=function(){return W.Buffer?function(t){return(E.create=function(i){return W.Buffer.isBuffer(i)?new Rt(i):un(i)})(t)}:un};E.create=ln();E.prototype._slice=W.Array.prototype.subarray||W.Array.prototype.slice;E.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,U(this,10);return e}}();E.prototype.int32=function(){return this.uint32()|0};E.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function kt(){var n=new cn(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw U(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw U(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}E.prototype.bool=function(){return this.uint32()!==0};function Ve(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}E.prototype.fixed32=function(){if(this.pos+4>this.len)throw U(this,4);return Ve(this.buf,this.pos+=4)};E.prototype.sfixed32=function(){if(this.pos+4>this.len)throw U(this,4);return Ve(this.buf,this.pos+=4)|0};function an(){if(this.pos+8>this.len)throw U(this,8);return new cn(Ve(this.buf,this.pos+=4),Ve(this.buf,this.pos+=4))}E.prototype.float=function(){if(this.pos+4>this.len)throw U(this,4);var e=W.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};E.prototype.double=function(){if(this.pos+8>this.len)throw U(this,4);var e=W.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};E.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw U(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)};E.prototype.string=function(){var e=this.bytes();return Ui.read(e,0,e.length)};E.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw U(this,e);this.pos+=e}else do if(this.pos>=this.len)throw U(this);while(this.buf[this.pos++]&128);return this};E.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};E._configure=function(n){Rt=n,E.create=ln(),Rt._configure();var e=W.Long?"toLong":"toNumber";W.merge(E.prototype,{int64:function(){return kt.call(this)[e](!1)},uint64:function(){return kt.call(this)[e](!0)},sint64:function(){return kt.call(this).zzDecode()[e](!1)},fixed64:function(){return an.call(this)[e](!0)},sfixed64:function(){return an.call(this)[e](!1)}})}});var mn=d((Co,pn)=>{"use strict";pn.exports=ie;var dn=Ge();(ie.prototype=Object.create(dn.prototype)).constructor=ie;var hn=$();function ie(n){dn.call(this,n)}ie._configure=function(){hn.Buffer&&(ie.prototype._slice=hn.Buffer.prototype.slice)};ie.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};ie._configure()});var _n=d((Po,yn)=>{"use strict";yn.exports=xe;var Tt=$();(xe.prototype=Object.create(Tt.EventEmitter.prototype)).constructor=xe;function xe(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");Tt.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}xe.prototype.rpcCall=function n(e,t,r,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return Tt.asPromise(n,o,e,t,r,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(u,c){if(u)return o.emit("error",u,e),s(u);if(c===null){o.end(!0);return}if(!(c instanceof r))try{c=r[o.responseDelimited?"decodeDelimited":"decode"](c)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",c,e),s(null,c)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};xe.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Ct=d(bn=>{"use strict";var zi=bn;zi.Service=_n()});var Pt=d((qo,gn)=>{"use strict";gn.exports={}});var wn=d(Sn=>{"use strict";var A=Sn;A.build="minimal";A.Writer=Ke();A.BufferWriter=on();A.Reader=Ge();A.BufferReader=mn();A.util=$();A.rpc=Ct();A.roots=Pt();A.configure=vn;function vn(){A.util._configure(),A.Writer._configure(A.BufferWriter),A.Reader._configure(A.BufferReader)}vn()});var En=d((Lo,xn)=>{"use strict";xn.exports=At;function At(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function r(s){if(typeof s!="string"){var o=i();if(At.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),u=new Array(a.length+1),c=new Array(a.length),l=0;l<a.length;)u[l]=a[l],c[l]=s[a[l++]];return u[l]=o,Function.apply(null,u).apply(null,c)}return Function(o)()}for(var h=new Array(arguments.length-1),y=0;y<h.length;)h[y]=arguments[++y];if(y=0,s=s.replace(/%([%dfijs])/g,function(m,v){var w=h[y++];switch(v){case"d":case"f":return String(Number(w));case"i":return String(Math.floor(w));case"j":return JSON.stringify(w);case"s":return String(w)}return"%"}),y!==h.length)throw Error("parameter count mismatch");return t.push(s),r}function i(s){return"function "+(s||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return r.toString=i,r}At.verbose=!1});var kn=d((Do,On)=>{"use strict";On.exports=Ee;var $i=yt(),Hi=_t(),qt=Hi("fs");function Ee(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&qt&&qt.readFile?qt.readFile(n,function(i,s){return i&&typeof XMLHttpRequest<"u"?Ee.xhr(n,e,t):i?t(i):t(null,e.binary?s:s.toString("utf8"))}):Ee.xhr(n,e,t):$i(Ee,this,n,e)}Ee.xhr=function(e,t,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return r(Error("status "+i.status));if(t.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return r(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return r(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var Cn=d(Tn=>{"use strict";var Lt=Tn,Rn=Lt.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},Nt=Lt.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),r=Rn(e),i="";r&&(i=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):r?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return i+t.join("/")};Lt.resolve=function(e,t,r){return r||(t=Nt(t)),Rn(t)?t:(r||(e=Nt(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?Nt(e+"/"+t):t)}});var pe=d(Pn=>{"use strict";var Oe=Pn,Wi=C(),Ki=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function ke(n,e){var t=0,r={};for(e|=0;t<n.length;)r[Ki[t+e]]=n[t++];return r}Oe.basic=ke([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Oe.defaults=ke([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",Wi.emptyArray,null]);Oe.long=ke([0,0,0,1,1],7);Oe.mapKey=ke([0,0,0,5,5,0,0,0,1,1,0,2],2);Oe.packed=ke([1,5,0,0,0,5,5,0,0,0,1,1,0])});var se=d((jo,Nn)=>{"use strict";Nn.exports=B;var Ze=oe();((B.prototype=Object.create(Ze.prototype)).constructor=B).className="Field";var An=K(),qn=pe(),R=C(),Dt,Vi=/^required|optional|repeated$/;B.fromJSON=function(e,t){return new B(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function B(n,e,t,r,i,s,o){if(R.isObject(r)?(o=i,s=r,r=i=void 0):R.isObject(i)&&(o=s,s=i,i=void 0),Ze.call(this,n,s),!R.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!R.isString(t))throw TypeError("type must be a string");if(r!==void 0&&!Vi.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!R.isString(i))throw TypeError("extend must be a string");r==="proto3_optional"&&(r="optional"),this.rule=r&&r!=="optional"?r:void 0,this.type=t,this.id=e,this.extend=i||void 0,this.required=r==="required",this.optional=!this.required,this.repeated=r==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=R.Long?qn.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(B.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});B.prototype.setOption=function(e,t,r){return e==="packed"&&(this._packed=null),Ze.prototype.setOption.call(this,e,t,r)};B.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return R.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};B.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=qn.defaults[this.type])===void 0&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Dt?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof An&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof An))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=R.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;R.base64.test(this.typeDefault)?R.base64.decode(this.typeDefault,e=R.newBuffer(R.base64.length(this.typeDefault)),0):R.utf8.write(this.typeDefault,e=R.newBuffer(R.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=R.emptyObject:this.repeated?this.defaultValue=R.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Dt&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Ze.prototype.resolve.call(this)};B.d=function(e,t,r,i){return typeof t=="function"?t=R.decorateType(t).name:t&&typeof t=="object"&&(t=R.decorateEnum(t).name),function(o,a){R.decorateType(o.constructor).add(new B(a,e,t,r,{default:i}))}};B._configure=function(e){Dt=e}});var Re=d((Fo,Bn)=>{"use strict";Bn.exports=I;var Ye=oe();((I.prototype=Object.create(Ye.prototype)).constructor=I).className="OneOf";var Ln=se(),Xe=C();function I(n,e,t,r){if(Array.isArray(e)||(t=e,e=void 0),Ye.call(this,n,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=r}I.fromJSON=function(e,t){return new I(e,t.oneof,t.options,t.comment)};I.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return Xe.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function Dn(n){if(n.parent)for(var e=0;e<n.fieldsArray.length;++e)n.fieldsArray[e].parent||n.parent.add(n.fieldsArray[e])}I.prototype.add=function(e){if(!(e instanceof Ln))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,Dn(this),this};I.prototype.remove=function(e){if(!(e instanceof Ln))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};I.prototype.onAdd=function(e){Ye.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}Dn(this)};I.prototype.onRemove=function(e){for(var t=0,r;t<this.fieldsArray.length;++t)(r=this.fieldsArray[t]).parent&&r.parent.remove(r);Ye.prototype.onRemove.call(this,e)};I.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(i,s){Xe.decorateType(i.constructor).add(new I(s,e)),Object.defineProperty(i,s,{get:Xe.oneOfGetter(e),set:Xe.oneOfSetter(e)})}}});var _e=d((Mo,Mn)=>{"use strict";Mn.exports=g;var Bt=oe();((g.prototype=Object.create(Bt.prototype)).constructor=g).className="Namespace";var In=se(),Gi=Re(),Qe=C(),me,Te,ye;g.fromJSON=function(e,t){return new g(e,t.options).addJSON(t.nested)};function jn(n,e){if(!!(n&&n.length)){for(var t={},r=0;r<n.length;++r)t[n[r].name]=n[r].toJSON(e);return t}}g.arrayToJSON=jn;g.isReservedId=function(e,t){if(e){for(var r=0;r<e.length;++r)if(typeof e[r]!="string"&&e[r][0]<=t&&e[r][1]>t)return!0}return!1};g.isReservedName=function(e,t){if(e){for(var r=0;r<e.length;++r)if(e[r]===t)return!0}return!1};function g(n,e){Bt.call(this,n,e),this.nested=void 0,this._nestedArray=null}function Fn(n){return n._nestedArray=null,n}Object.defineProperty(g.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Qe.toArray(this.nested))}});g.prototype.toJSON=function(e){return Qe.toObject(["options",this.options,"nested",jn(this.nestedArray,e)])};g.prototype.addJSON=function(e){var t=this;if(e)for(var r=Object.keys(e),i=0,s;i<r.length;++i)s=e[r[i]],t.add((s.fields!==void 0?me.fromJSON:s.values!==void 0?ye.fromJSON:s.methods!==void 0?Te.fromJSON:s.id!==void 0?In.fromJSON:g.fromJSON)(r[i],s));return this};g.prototype.get=function(e){return this.nested&&this.nested[e]||null};g.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof ye)return this.nested[e].values;throw Error("no such enum: "+e)};g.prototype.add=function(e){if(!(e instanceof In&&e.extend!==void 0||e instanceof me||e instanceof ye||e instanceof Te||e instanceof g||e instanceof Gi))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof g&&e instanceof g&&!(t instanceof me||t instanceof Te)){for(var r=t.nestedArray,i=0;i<r.length;++i)e.add(r[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),Fn(this)};g.prototype.remove=function(e){if(!(e instanceof Bt))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),Fn(this)};g.prototype.define=function(e,t){if(Qe.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var r=this;e.length>0;){var i=e.shift();if(r.nested&&r.nested[i]){if(r=r.nested[i],!(r instanceof g))throw Error("path conflicts with non-namespace objects")}else r.add(r=new g(i))}return t&&r.addJSON(t),r};g.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof g?e[t++].resolveAll():e[t++].resolve();return this.resolve()};g.prototype.lookup=function(e,t,r){if(typeof t=="boolean"?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),Qe.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var i=this.get(e[0]);if(i){if(e.length===1){if(!t||t.indexOf(i.constructor)>-1)return i}else if(i instanceof g&&(i=i.lookup(e.slice(1),t,!0)))return i}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof g&&(i=this._nestedArray[s].lookup(e,t,!0)))return i;return this.parent===null||r?null:this.parent.lookup(e,t)};g.prototype.lookupType=function(e){var t=this.lookup(e,[me]);if(!t)throw Error("no such type: "+e);return t};g.prototype.lookupEnum=function(e){var t=this.lookup(e,[ye]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};g.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[me,ye]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};g.prototype.lookupService=function(e){var t=this.lookup(e,[Te]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};g._configure=function(n,e,t){me=n,Te=e,ye=t}});var jt=d((Jo,Jn)=>{"use strict";Jn.exports=X;var It=se();((X.prototype=Object.create(It.prototype)).constructor=X).className="MapField";var Zi=pe(),Ce=C();function X(n,e,t,r,i,s){if(It.call(this,n,e,r,void 0,void 0,i,s),!Ce.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}X.fromJSON=function(e,t){return new X(e,t.id,t.keyType,t.type,t.options,t.comment)};X.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return Ce.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};X.prototype.resolve=function(){if(this.resolved)return this;if(Zi.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return It.prototype.resolve.call(this)};X.d=function(e,t,r){return typeof r=="function"?r=Ce.decorateType(r).name:r&&typeof r=="object"&&(r=Ce.decorateEnum(r).name),function(s,o){Ce.decorateType(s.constructor).add(new X(o,e,t,r))}}});var Mt=d((Uo,Un)=>{"use strict";Un.exports=ue;var Ft=oe();((ue.prototype=Object.create(Ft.prototype)).constructor=ue).className="Method";var be=C();function ue(n,e,t,r,i,s,o,a,u){if(be.isObject(i)?(o=i,i=s=void 0):be.isObject(s)&&(o=s,s=void 0),!(e===void 0||be.isString(e)))throw TypeError("type must be a string");if(!be.isString(t))throw TypeError("requestType must be a string");if(!be.isString(r))throw TypeError("responseType must be a string");Ft.call(this,n,o),this.type=e||"rpc",this.requestType=t,this.requestStream=i?!0:void 0,this.responseType=r,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=u}ue.fromJSON=function(e,t){return new ue(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};ue.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return be.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};ue.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),Ft.prototype.resolve.call(this))}});var Ut=d((zo,$n)=>{"use strict";$n.exports=j;var te=_e();((j.prototype=Object.create(te.prototype)).constructor=j).className="Service";var Jt=Mt(),Pe=C(),Xi=Ct();function j(n,e){te.call(this,n,e),this.methods={},this._methodsArray=null}j.fromJSON=function(e,t){var r=new j(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),s=0;s<i.length;++s)r.add(Jt.fromJSON(i[s],t.methods[i[s]]));return t.nested&&r.addJSON(t.nested),r.comment=t.comment,r};j.prototype.toJSON=function(e){var t=te.prototype.toJSON.call(this,e),r=e?Boolean(e.keepComments):!1;return Pe.toObject(["options",t&&t.options||void 0,"methods",te.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};Object.defineProperty(j.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Pe.toArray(this.methods))}});function zn(n){return n._methodsArray=null,n}j.prototype.get=function(e){return this.methods[e]||te.prototype.get.call(this,e)};j.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return te.prototype.resolve.call(this)};j.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof Jt?(this.methods[e.name]=e,e.parent=this,zn(this)):te.prototype.add.call(this,e)};j.prototype.remove=function(e){if(e instanceof Jt){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,zn(this)}return te.prototype.remove.call(this,e)};j.prototype.create=function(e,t,r){for(var i=new Xi.Service(e,t,r),s=0,o;s<this.methodsArray.length;++s){var a=Pe.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=Pe.codegen(["r","c"],Pe.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var et=d(($o,Hn)=>{"use strict";Hn.exports=V;var Yi=$();function V(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}V.create=function(e){return this.$type.create(e)};V.encode=function(e,t){return this.$type.encode(e,t)};V.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};V.decode=function(e){return this.$type.decode(e)};V.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};V.verify=function(e){return this.$type.verify(e)};V.fromObject=function(e){return this.$type.fromObject(e)};V.toObject=function(e,t){return this.$type.toObject(e,t)};V.prototype.toJSON=function(){return this.$type.toObject(this,Yi.toJSONOptions)}});var zt=d((Ho,Kn)=>{"use strict";Kn.exports=ts;var Qi=K(),Y=pe(),Wn=C();function es(n){return"missing required '"+n.name+"'"}function ts(n){var e=Wn.codegen(["r","l"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");n.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var t=0;t<n.fieldsArray.length;++t){var r=n._fieldsArray[t].resolve(),i=r.resolvedType instanceof Qi?"int32":r.type,s="m"+Wn.safeProp(r.name);e("case %i:",r.id),r.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Y.defaults[r.keyType]!==void 0?e("k=%j",Y.defaults[r.keyType]):e("k=null"),Y.defaults[i]!==void 0?e("value=%j",Y.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",r.keyType)("case 2:"),Y.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Y.long[r.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):r.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Y.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),Y.basic[i]===void 0?e(r.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,i)):Y.basic[i]===void 0?e(r.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,i),e("break")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<n._fieldsArray.length;++t){var o=n._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",es(o))}return e("return m")}});var Wt=d((Wo,Vn)=>{"use strict";Vn.exports=is;var rs=K(),$t=C();function F(n,e){return n.name+": "+e+(n.repeated&&e!=="array"?"[]":n.map&&e!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function Ht(n,e,t,r){if(e.resolvedType)if(e.resolvedType instanceof rs){n("switch(%s){",r)("default:")("return%j",F(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)n("case %i:",e.resolvedType.values[i[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",t,r)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",r)("return%j",F(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",F(e,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',r)("return%j",F(e,"number"));break;case"bool":n('if(typeof %s!=="boolean")',r)("return%j",F(e,"boolean"));break;case"string":n("if(!util.isString(%s))",r)("return%j",F(e,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",F(e,"buffer"));break}return n}function ns(n,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",t)("return%j",F(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",t)("return%j",F(e,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",t)("return%j",F(e,"boolean key"));break}return n}function is(n){var e=$t.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=n.oneofsArray,r={};t.length&&e("var p={}");for(var i=0;i<n.fieldsArray.length;++i){var s=n._fieldsArray[i].resolve(),o="m"+$t.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",F(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),ns(e,s,"k[i]"),Ht(e,s,i,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",F(s,"array"))("for(var i=0;i<%s.length;++i){",o),Ht(e,s,i,o+"[i]")("}");else{if(s.partOf){var a=$t.safeProp(s.partOf.name);r[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),r[s.partOf.name]=1,e("p%s=1",a)}Ht(e,s,i,o)}s.optional&&e("}")}return e("return null")}});var Gt=d(Zn=>{"use strict";var Gn=Zn,Ae=K(),G=C();function Kt(n,e,t,r){if(e.resolvedType)if(e.resolvedType instanceof Ae){n("switch(d%s){",r);for(var i=e.resolvedType.values,s=Object.keys(i),o=0;o<s.length;++o)e.repeated&&i[s[o]]===e.typeDefault&&n("default:"),n("case%j:",s[o])("case %i:",i[s[o]])("m%s=%j",r,i[s[o]])("break");n("}")}else n('if(typeof d%s!=="object")',r)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,t,r);else{var a=!1;switch(e.type){case"double":case"float":n("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",r,r);break;case"uint64":a=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,a)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,a?"true":"");break;case"bytes":n('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length)",r)("m%s=d%s",r,r);break;case"string":n("m%s=String(d%s)",r,r);break;case"bool":n("m%s=Boolean(d%s)",r,r);break}}return n}Gn.fromObject=function(e){var t=e.fieldsArray,r=G.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<t.length;++i){var s=t[i].resolve(),o=G.safeProp(s.name);s.map?(r("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Kt(r,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Kt(r,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof Ae||r("if(d%s!=null){",o),Kt(r,s,i,o),s.resolvedType instanceof Ae||r("}"))}return r("return m")};function Vt(n,e,t,r){if(e.resolvedType)e.resolvedType instanceof Ae?n("d%s=o.enums===String?types[%i].values[m%s]:m%s",r,t,r,r):n("d%s=types[%i].toObject(m%s,o)",r,t,r);else{var i=!1;switch(e.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,i?"true":"",r);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:n("d%s=m%s",r,r);break}}return n}Gn.toObject=function(e){var t=e.fieldsArray.slice().sort(G.compareFieldsById);if(!t.length)return G.codegen()("return {}");for(var r=G.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<t.length;++a)t[a].partOf||(t[a].resolve().repeated?i:t[a].map?s:o).push(t[a]);if(i.length){for(r("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)r("d%s=[]",G.safeProp(i[a].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),a=0;a<s.length;++a)r("d%s={}",G.safeProp(s[a].name));r("}")}if(o.length){for(r("if(o.defaults){"),a=0;a<o.length;++a){var u=o[a],c=G.safeProp(u.name);if(u.resolvedType instanceof Ae)r("d%s=o.enums===String?%j:%j",c,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var l="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",c,l)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else r("d%s=%j",c,u.typeDefault)}r("}")}var h=!1;for(a=0;a<t.length;++a){var u=t[a],y=e._fieldsArray.indexOf(u),c=G.safeProp(u.name);u.map?(h||(h=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),Vt(r,u,y,c+"[ks2[j]]")("}")):u.repeated?(r("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),Vt(r,u,y,c+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",c,u.name),Vt(r,u,y,c),u.partOf&&r("if(o.oneofs)")("d%s=%j",G.safeProp(u.partOf.name),u.name)),r("}")}return r("return d")}});var Zt=d(Xn=>{"use strict";var ss=Xn,os=et();ss[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var e=n["@type"].substring(n["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var r=n["@type"].charAt(0)==="."?n["@type"].substr(1):n["@type"];return r.indexOf("/")===-1&&(r="/"+r),this.create({type_url:r,value:t.encode(t.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,e){var t="type.googleapis.com/",r="",i="";if(e&&e.json&&n.type_url&&n.value){i=n.type_url.substring(n.type_url.lastIndexOf("/")+1),r=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof os){var o=n.$type.toObject(n,e),a=n.$type.fullName[0]==="."?n.$type.fullName.substr(1):n.$type.fullName;return r===""&&(r=t),i=r+a,o["@type"]=i,o}return this.toObject(n,e)}}});var er=d((Go,Qn)=>{"use strict";Qn.exports=x;var z=_e();((x.prototype=Object.create(z.prototype)).constructor=x).className="Type";var us=K(),Qt=Re(),tt=se(),as=jt(),cs=Ut(),Xt=et(),Yt=Ge(),ls=Ke(),P=C(),fs=tr(),hs=zt(),ds=Wt(),Yn=Gt(),ps=Zt();function x(n,e){z.call(this,n,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(x.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),e=0;e<n.length;++e){var t=this.fields[n[e]],r=t.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=P.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=P.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=x.generateConstructor(this)())},set:function(n){var e=n.prototype;e instanceof Xt||((n.prototype=new Xt).constructor=n,P.merge(n.prototype,e)),n.$type=n.prototype.$type=this,P.merge(n,Xt,!0),this._ctor=n;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var r={};for(t=0;t<this.oneofsArray.length;++t)r[this._oneofsArray[t].resolve().name]={get:P.oneOfGetter(this._oneofsArray[t].oneof),set:P.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(n.prototype,r)}}});x.generateConstructor=function(e){for(var t=P.codegen(["p"],e.name),r=0,i;r<e.fieldsArray.length;++r)(i=e._fieldsArray[r]).map?t("this%s={}",P.safeProp(i.name)):i.repeated&&t("this%s=[]",P.safeProp(i.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function rt(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}x.fromJSON=function(e,t){var r=new x(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var i=Object.keys(t.fields),s=0;s<i.length;++s)r.add((typeof t.fields[i[s]].keyType<"u"?as.fromJSON:tt.fromJSON)(i[s],t.fields[i[s]]));if(t.oneofs)for(i=Object.keys(t.oneofs),s=0;s<i.length;++s)r.add(Qt.fromJSON(i[s],t.oneofs[i[s]]));if(t.nested)for(i=Object.keys(t.nested),s=0;s<i.length;++s){var o=t.nested[i[s]];r.add((o.id!==void 0?tt.fromJSON:o.fields!==void 0?x.fromJSON:o.values!==void 0?us.fromJSON:o.methods!==void 0?cs.fromJSON:z.fromJSON)(i[s],o))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),r};x.prototype.toJSON=function(e){var t=z.prototype.toJSON.call(this,e),r=e?Boolean(e.keepComments):!1;return P.toObject(["options",t&&t.options||void 0,"oneofs",z.arrayToJSON(this.oneofsArray,e),"fields",z.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};x.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var r=this.oneofsArray;for(t=0;t<r.length;)r[t++].resolve();return z.prototype.resolveAll.call(this)};x.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};x.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof tt&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),rt(this)}return e instanceof Qt?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),rt(this)):z.prototype.add.call(this,e)};x.prototype.remove=function(e){if(e instanceof tt&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),rt(this)}if(e instanceof Qt){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),rt(this)}return z.prototype.remove.call(this,e)};x.prototype.isReservedId=function(e){return z.isReservedId(this.reserved,e)};x.prototype.isReservedName=function(e){return z.isReservedName(this.reserved,e)};x.prototype.create=function(e){return new this.ctor(e)};x.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=fs(this)({Writer:ls,types:t,util:P}),this.decode=hs(this)({Reader:Yt,types:t,util:P}),this.verify=ds(this)({types:t,util:P}),this.fromObject=Yn.fromObject(this)({types:t,util:P}),this.toObject=Yn.toObject(this)({types:t,util:P});var i=ps[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};x.prototype.encode=function(e,t){return this.setup().encode(e,t)};x.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};x.prototype.decode=function(e,t){return this.setup().decode(e,t)};x.prototype.decodeDelimited=function(e){return e instanceof Yt||(e=Yt.create(e)),this.decode(e,e.uint32())};x.prototype.verify=function(e){return this.setup().verify(e)};x.prototype.fromObject=function(e){return this.setup().fromObject(e)};x.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};x.d=function(e){return function(r){P.decorateType(r,e)}}});var ir=d((Zo,ii)=>{"use strict";ii.exports=N;var it=_e();((N.prototype=Object.create(it.prototype)).constructor=N).className="Root";var nr=se(),ti=K(),ms=Re(),re=C(),ri,rr,qe;function N(n){it.call(this,"",n),this.deferred=[],this.files=[]}N.fromJSON=function(e,t){return t||(t=new N),e.options&&t.setOptions(e.options),t.addJSON(e.nested)};N.prototype.resolvePath=re.path.resolve;N.prototype.fetch=re.fetch;function ni(){}N.prototype.load=function n(e,t,r){typeof t=="function"&&(r=t,t=void 0);var i=this;if(!r)return re.asPromise(n,i,e,t);var s=r===ni;function o(p,m){if(!!r){var v=r;if(r=null,s)throw p;v(p,m)}}function a(p){var m=p.lastIndexOf("google/protobuf/");if(m>-1){var v=p.substring(m);if(v in qe)return v}return null}function u(p,m){try{if(re.isString(m)&&m.charAt(0)==="{"&&(m=JSON.parse(m)),!re.isString(m))i.setOptions(m.options).addJSON(m.nested);else{rr.filename=p;var v=rr(m,i,t),w,q=0;if(v.imports)for(;q<v.imports.length;++q)(w=a(v.imports[q])||i.resolvePath(p,v.imports[q]))&&c(w);if(v.weakImports)for(q=0;q<v.weakImports.length;++q)(w=a(v.weakImports[q])||i.resolvePath(p,v.weakImports[q]))&&c(w,!0)}}catch(vi){o(vi)}!s&&!l&&o(null,i)}function c(p,m){if(!(i.files.indexOf(p)>-1)){if(i.files.push(p),p in qe){s?u(p,qe[p]):(++l,setTimeout(function(){--l,u(p,qe[p])}));return}if(s){var v;try{v=re.fs.readFileSync(p).toString("utf8")}catch(w){m||o(w);return}u(p,v)}else++l,i.fetch(p,function(w,q){if(--l,!!r){if(w){m?l||o(null,i):o(w);return}u(p,q)}})}}var l=0;re.isString(e)&&(e=[e]);for(var h=0,y;h<e.length;++h)(y=i.resolvePath("",e[h]))&&c(y);if(s)return i;l||o(null,i)};N.prototype.loadSync=function(e,t){if(!re.isNode)throw Error("not supported");return this.load(e,t,ni)};N.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return it.prototype.resolveAll.call(this)};var nt=/^[A-Z]/;function ei(n,e){var t=e.parent.lookup(e.extend);if(t){var r=new nr(e.fullName,e.id,e.type,e.rule,void 0,e.options);return r.declaringField=e,e.extensionField=r,t.add(r),!0}return!1}N.prototype._handleAdd=function(e){if(e instanceof nr)e.extend!==void 0&&!e.extensionField&&(ei(this,e)||this.deferred.push(e));else if(e instanceof ti)nt.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof ms)){if(e instanceof ri)for(var t=0;t<this.deferred.length;)ei(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);nt.test(e.name)&&(e.parent[e.name]=e)}};N.prototype._handleRemove=function(e){if(e instanceof nr){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof ti)nt.test(e.name)&&delete e.parent[e.name];else if(e instanceof it){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);nt.test(e.name)&&delete e.parent[e.name]}};N._configure=function(n,e,t){ri=n,rr=e,qe=t}});var C=d((Xo,oi)=>{"use strict";var O=oi.exports=$(),si=Pt(),sr,or;O.codegen=En();O.fetch=kn();O.path=Cn();O.fs=O.inquire("fs");O.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),i=0;i<t.length;)r[i]=e[t[i++]];return r}return[]};O.toObject=function(e){for(var t={},r=0;r<e.length;){var i=e[r++],s=e[r++];s!==void 0&&(t[i]=s)}return t};var ys=/\\/g,_s=/"/g;O.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};O.safeProp=function(e){return!/^[$\w_]+$/.test(e)||O.isReserved(e)?'["'+e.replace(ys,"\\\\").replace(_s,'\\"')+'"]':"."+e};O.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var bs=/_([a-z])/g;O.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(bs,function(t,r){return r.toUpperCase()})};O.compareFieldsById=function(e,t){return e.id-t.id};O.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(O.decorateRoot.remove(e.$type),e.$type.name=t,O.decorateRoot.add(e.$type)),e.$type;sr||(sr=er());var r=new sr(t||e.name);return O.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var gs=0;O.decorateEnum=function(e){if(e.$type)return e.$type;or||(or=K());var t=new or("Enum"+gs++,e);return O.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};O.setProperty=function(e,t,r){function i(s,o,a){var u=o.shift();if(o.length>0)s[u]=i(s[u]||{},o,a);else{var c=s[u];c&&(a=[].concat(c).concat(a)),s[u]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),i(e,t,r)};Object.defineProperty(O,"decorateRoot",{get:function(){return si.decorated||(si.decorated=new(ir()))}})});var oe=d((Yo,ui)=>{"use strict";ui.exports=L;L.className="ReflectionObject";var st=C(),ot;function L(n,e){if(!st.isString(n))throw TypeError("name must be a string");if(e&&!st.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=n,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(L.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],e=this.parent;e;)n.unshift(e.name),e=e.parent;return n.join(".")}}});L.prototype.toJSON=function(){throw Error()};L.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof ot&&t._handleAdd(this)};L.prototype.onRemove=function(e){var t=e.root;t instanceof ot&&t._handleRemove(this),this.parent=null,this.resolved=!1};L.prototype.resolve=function(){return this.resolved?this:(this.root instanceof ot&&(this.resolved=!0),this)};L.prototype.getOption=function(e){if(this.options)return this.options[e]};L.prototype.setOption=function(e,t,r){return(!r||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=t),this};L.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(r){var s=i.find(function(u){return Object.prototype.hasOwnProperty.call(u,e)});if(s){var o=s[e];st.setProperty(o,r,t)}else s={},s[e]=st.setProperty({},r,t),i.push(s)}else{var a={};a[e]=t,i.push(a)}return this};L.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)this.setOption(r[i],e[r[i]],t);return this};L.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};L._configure=function(n){ot=n}});var K=d((Qo,li)=>{"use strict";li.exports=Z;var ai=oe();((Z.prototype=Object.create(ai.prototype)).constructor=Z).className="Enum";var ci=_e(),ut=C();function Z(n,e,t,r,i){if(ai.call(this,n,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=i||{},this.reserved=void 0,e)for(var s=Object.keys(e),o=0;o<s.length;++o)typeof e[s[o]]=="number"&&(this.valuesById[this.values[s[o]]=e[s[o]]]=s[o])}Z.fromJSON=function(e,t){var r=new Z(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,r};Z.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return ut.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};Z.prototype.add=function(e,t,r){if(!ut.isString(e))throw TypeError("name must be a string");if(!ut.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=r||null,this};Z.prototype.remove=function(e){if(!ut.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this};Z.prototype.isReservedId=function(e){return ci.isReservedId(this.reserved,e)};Z.prototype.isReservedName=function(e){return ci.isReservedName(this.reserved,e)}});var tr=d((eu,hi)=>{"use strict";hi.exports=Ss;var vs=K(),ur=pe(),ar=C();function fi(n,e,t,r){return e.resolvedType.group?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,r,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,r,(e.id<<3|2)>>>0)}function Ss(n){for(var e=ar.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),t,r,i=n.fieldsArray.slice().sort(ar.compareFieldsById),t=0;t<i.length;++t){var s=i[t].resolve(),o=n._fieldsArray.indexOf(s),a=s.resolvedType instanceof vs?"int32":s.type,u=ur.basic[a];r="m"+ar.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|ur.mapKey[s.keyType],s.keyType),u===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,r):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|u,a,r),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",r,r),s.packed&&ur.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",a,r)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",r),u===void 0?fi(e,s,o,r+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|u)>>>0,a,r)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,s.name),u===void 0?fi(e,s,o,r):e("w.uint32(%i).%s(%s)",(s.id<<3|u)>>>0,a,r))}return e("return w")}});var pi=d((tu,di)=>{"use strict";var _=di.exports=wn();_.build="light";function ws(n,e,t){return typeof e=="function"?(t=e,e=new _.Root):e||(e=new _.Root),e.load(n,t)}_.load=ws;function xs(n,e){return e||(e=new _.Root),e.loadSync(n)}_.loadSync=xs;_.encoder=tr();_.decoder=zt();_.verifier=Wt();_.converter=Gt();_.ReflectionObject=oe();_.Namespace=_e();_.Root=ir();_.Enum=K();_.Type=er();_.Field=se();_.OneOf=Re();_.MapField=jt();_.Service=Ut();_.Method=Mt();_.Message=et();_.wrappers=Zt();_.types=pe();_.util=C();_.ReflectionObject._configure(_.Root);_.Namespace._configure(_.Type,_.Service,_.Enum);_.Root._configure(_.Type);_.Field._configure(_.Type)});var yi=d((ru,mi)=>{"use strict";mi.exports=pi()});var _i=d((nu,Es)=>{Es.exports={nested:{centrifugal:{nested:{centrifuge:{nested:{protocol:{options:{go_package:"./;protocol"},nested:{Error:{fields:{code:{type:"uint32",id:1},message:{type:"string",id:2},temporary:{type:"bool",id:3}}},EmulationRequest:{fields:{node:{type:"string",id:1},session:{type:"string",id:2},data:{type:"bytes",id:3}}},Command:{fields:{id:{type:"uint32",id:1},method:{type:"MethodType",id:2},params:{type:"bytes",id:3},connect:{type:"ConnectRequest",id:4},subscribe:{type:"SubscribeRequest",id:5},unsubscribe:{type:"UnsubscribeRequest",id:6},publish:{type:"PublishRequest",id:7},presence:{type:"PresenceRequest",id:8},presence_stats:{type:"PresenceStatsRequest",id:9},history:{type:"HistoryRequest",id:10},ping:{type:"PingRequest",id:11},send:{type:"SendRequest",id:12},rpc:{type:"RPCRequest",id:13},refresh:{type:"RefreshRequest",id:14},sub_refresh:{type:"SubRefreshRequest",id:15}},nested:{MethodType:{values:{CONNECT:0,SUBSCRIBE:1,UNSUBSCRIBE:2,PUBLISH:3,PRESENCE:4,PRESENCE_STATS:5,HISTORY:6,PING:7,SEND:8,RPC:9,REFRESH:10,SUB_REFRESH:11}}}},Reply:{fields:{id:{type:"uint32",id:1},error:{type:"Error",id:2},result:{type:"bytes",id:3},push:{type:"Push",id:4},connect:{type:"ConnectResult",id:5},subscribe:{type:"SubscribeResult",id:6},unsubscribe:{type:"UnsubscribeResult",id:7},publish:{type:"PublishResult",id:8},presence:{type:"PresenceResult",id:9},presence_stats:{type:"PresenceStatsResult",id:10},history:{type:"HistoryResult",id:11},ping:{type:"PingResult",id:12},rpc:{type:"RPCResult",id:13},refresh:{type:"RefreshResult",id:14},sub_refresh:{type:"SubRefreshResult",id:15}}},Push:{fields:{type:{type:"PushType",id:1},channel:{type:"string",id:2},data:{type:"bytes",id:3},pub:{type:"Publication",id:4},join:{type:"Join",id:5},leave:{type:"Leave",id:6},unsubscribe:{type:"Unsubscribe",id:7},message:{type:"Message",id:8},subscribe:{type:"Subscribe",id:9},connect:{type:"Connect",id:10},disconnect:{type:"Disconnect",id:11},refresh:{type:"Refresh",id:12}},nested:{PushType:{values:{PUBLICATION:0,JOIN:1,LEAVE:2,UNSUBSCRIBE:3,MESSAGE:4,SUBSCRIBE:5,CONNECT:6,DISCONNECT:7,REFRESH:8}}}},ClientInfo:{fields:{user:{type:"string",id:1},client:{type:"string",id:2},conn_info:{type:"bytes",id:3},chan_info:{type:"bytes",id:4}}},Publication:{fields:{data:{type:"bytes",id:4},info:{type:"ClientInfo",id:5},offset:{type:"uint64",id:6},tags:{keyType:"string",type:"string",id:7}}},Join:{fields:{info:{type:"ClientInfo",id:1}}},Leave:{fields:{info:{type:"ClientInfo",id:1}}},Unsubscribe:{fields:{code:{type:"uint32",id:2},reason:{type:"string",id:3}}},Subscribe:{fields:{recoverable:{type:"bool",id:1},epoch:{type:"string",id:4},offset:{type:"uint64",id:5},positioned:{type:"bool",id:6},data:{type:"bytes",id:7}}},Message:{fields:{data:{type:"bytes",id:1}}},Connect:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},data:{type:"bytes",id:3},subs:{keyType:"string",type:"SubscribeResult",id:4},expires:{type:"bool",id:5},ttl:{type:"uint32",id:6},ping:{type:"uint32",id:7},pong:{type:"bool",id:8},session:{type:"string",id:9},node:{type:"string",id:10}}},Disconnect:{fields:{code:{type:"uint32",id:1},reason:{type:"string",id:2},reconnect:{type:"bool",id:3}}},Refresh:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2}}},ConnectRequest:{fields:{token:{type:"string",id:1},data:{type:"bytes",id:2},subs:{keyType:"string",type:"SubscribeRequest",id:3},name:{type:"string",id:4},version:{type:"string",id:5}}},ConnectResult:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},expires:{type:"bool",id:3},ttl:{type:"uint32",id:4},data:{type:"bytes",id:5},subs:{keyType:"string",type:"SubscribeResult",id:6},ping:{type:"uint32",id:7},pong:{type:"bool",id:8},session:{type:"string",id:9},node:{type:"string",id:10}}},RefreshRequest:{fields:{token:{type:"string",id:1}}},RefreshResult:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},expires:{type:"bool",id:3},ttl:{type:"uint32",id:4}}},SubscribeRequest:{fields:{channel:{type:"string",id:1},token:{type:"string",id:2},recover:{type:"bool",id:3},epoch:{type:"string",id:6},offset:{type:"uint64",id:7},data:{type:"bytes",id:8},positioned:{type:"bool",id:9},recoverable:{type:"bool",id:10}}},SubscribeResult:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2},recoverable:{type:"bool",id:3},epoch:{type:"string",id:6},publications:{rule:"repeated",type:"Publication",id:7},recovered:{type:"bool",id:8},offset:{type:"uint64",id:9},positioned:{type:"bool",id:10},data:{type:"bytes",id:11},was_recovering:{type:"bool",id:12}}},SubRefreshRequest:{fields:{channel:{type:"string",id:1},token:{type:"string",id:2}}},SubRefreshResult:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2}}},UnsubscribeRequest:{fields:{channel:{type:"string",id:1}}},UnsubscribeResult:{fields:{}},PublishRequest:{fields:{channel:{type:"string",id:1},data:{type:"bytes",id:2}}},PublishResult:{fields:{}},PresenceRequest:{fields:{channel:{type:"string",id:1}}},PresenceResult:{fields:{presence:{keyType:"string",type:"ClientInfo",id:1}}},PresenceStatsRequest:{fields:{channel:{type:"string",id:1}}},PresenceStatsResult:{fields:{num_clients:{type:"uint32",id:1},num_users:{type:"uint32",id:2}}},StreamPosition:{fields:{offset:{type:"uint64",id:1},epoch:{type:"string",id:2}}},HistoryRequest:{fields:{channel:{type:"string",id:1},limit:{type:"int32",id:7},since:{type:"StreamPosition",id:8},reverse:{type:"bool",id:9}}},HistoryResult:{fields:{publications:{rule:"repeated",type:"Publication",id:1},epoch:{type:"string",id:2},offset:{type:"uint64",id:3}}},PingRequest:{fields:{}},PingResult:{fields:{}},RPCRequest:{fields:{data:{type:"bytes",id:1},method:{type:"string",id:2}}},RPCResult:{fields:{data:{type:"bytes",id:1}}},SendRequest:{fields:{data:{type:"bytes",id:1}}}}}}}}}}}});var Cr=mr(ht());var k={timeout:1,transportClosed:2,clientDisconnected:3,clientClosed:4,clientConnectToken:5,clientRefreshToken:6,subscriptionUnsubscribed:7,subscriptionSubscribeToken:8,subscriptionRefreshToken:9,transportWriteError:10,connectionClosed:11},ce={connectCalled:0,transportClosed:1,noPing:2,subscribeTimeout:3,unsubscribeError:4},Be={disconnectCalled:0,unauthorized:1,badProtocol:2,messageSizeLimit:3},Ie={subscribeCalled:0,transportClosed:1},dt={unsubscribeCalled:0,unauthorized:1,clientClosed:2};var pt=(r=>(r.Disconnected="disconnected",r.Connecting="connecting",r.Connected="connected",r))(pt||{}),je=(r=>(r.Unsubscribed="unsubscribed",r.Subscribing="subscribing",r.Subscribed="subscribed",r))(je||{});function kr(n,e){return n.lastIndexOf(e,0)===0}function mt(n){return n==null?!1:typeof n=="function"}function Rr(n,e){if(window.console){let t=window.console[n];mt(t)&&t.apply(window.console,e)}}function Ni(n,e){return Math.floor(Math.random()*(e-n+1)+n)}function le(n,e,t){n>31&&(n=31);let r=Ni(0,Math.min(t,e*Math.pow(2,n)));return Math.min(t,e+r)}function Tr(n){return"error"in n&&n.error!==null}function fe(n){return Math.min(n*1e3,2147483647)}var Fe=class extends Cr.default{constructor(t,r,i){super();this._resubscribeTimeout=null;this._refreshTimeout=null;this.channel=r,this.state="unsubscribed",this._centrifuge=t,this._token=null,this._getToken=null,this._data=null,this._recover=!1,this._offset=null,this._epoch=null,this._recoverable=!1,this._positioned=!1,this._minResubscribeDelay=500,this._maxResubscribeDelay=2e4,this._resubscribeTimeout=null,this._resubscribeAttempts=0,this._promises=new Map,this._promiseId=0,this._refreshTimeout=null,this._setOptions(i),this._centrifuge._debugEnabled&&(this.on("state",s=>{this._centrifuge._debug("subscription state",r,s.oldState,"->",s.newState)}),this.on("error",s=>{this._centrifuge._debug("subscription error",r,s)}))}ready(t){return this.state==="unsubscribed"?Promise.reject({code:k.subscriptionUnsubscribed,message:this.state}):this.state==="subscribed"?Promise.resolve():new Promise((r,i)=>{let s={resolve:r,reject:i};t&&(s.timeout=setTimeout(function(){i({code:k.timeout,message:"timeout"})},t)),this._promises[this._nextPromiseId()]=s})}subscribe(){this._isSubscribed()||(this._resubscribeAttempts=0,this._setSubscribing(Ie.subscribeCalled,"subscribe called"))}unsubscribe(){this._setUnsubscribed(dt.unsubscribeCalled,"unsubscribe called",!0)}publish(t){return M(this,null,function*(){let r=this;return this._methodCall().then(function(){return r._centrifuge.publish(r.channel,t)})})}presence(){return M(this,null,function*(){let t=this;return this._methodCall().then(function(){return t._centrifuge.presence(t.channel)})})}presenceStats(){return M(this,null,function*(){let t=this;return this._methodCall().then(function(){return t._centrifuge.presenceStats(t.channel)})})}history(t){return M(this,null,function*(){let r=this;return this._methodCall().then(function(){return r._centrifuge.history(r.channel,t)})})}_methodCall(){return this._isSubscribed()?Promise.resolve():new Promise((t,r)=>{let i=setTimeout(function(){r({code:k.timeout,message:"timeout"})},this._centrifuge._config.timeout);this._promises[this._nextPromiseId()]={timeout:i,resolve:t,reject:r}})}_nextPromiseId(){return++this._promiseId}_needRecover(){return this._recover===!0}_isUnsubscribed(){return this.state==="unsubscribed"}_isSubscribing(){return this.state==="subscribing"}_isSubscribed(){return this.state==="subscribed"}_setState(t){if(this.state!==t){let r=this.state;return this.state=t,this.emit("state",{newState:t,oldState:r,channel:this.channel}),!0}return!1}_usesToken(){return this._token!==null||this._getToken!==null}_clearSubscribingState(){this._resubscribeAttempts=0,this._clearResubscribeTimeout()}_clearSubscribedState(){this._clearRefreshTimeout()}_setSubscribed(t){if(!this._isSubscribing())return;this._clearSubscribingState(),t.recoverable&&(this._recover=!0,this._offset=t.offset||0,this._epoch=t.epoch||""),this._setState("subscribed");let r=this._centrifuge._getSubscribeContext(this.channel,t);this.emit("subscribed",r),this._resolvePromises();let i=t.publications;if(i&&i.length>0)for(let s in i)!i.hasOwnProperty(s)||this._handlePublication(i[s]);t.expires===!0&&(this._refreshTimeout=setTimeout(()=>this._refresh(),fe(t.ttl)))}_setSubscribing(t,r){this._isSubscribing()||(this._isSubscribed()&&this._clearSubscribedState(),this._setState("subscribing")&&this.emit("subscribing",{channel:this.channel,code:t,reason:r}),this._centrifuge._subscribe(this))}_setUnsubscribed(t,r,i){this._isUnsubscribed()||(this._isSubscribed()&&(i&&this._centrifuge._unsubscribe(this),this._clearSubscribedState()),this._isSubscribing()&&this._clearSubscribingState(),this._setState("unsubscribed")&&this.emit("unsubscribed",{channel:this.channel,code:t,reason:r}),this._rejectPromises({code:k.subscriptionUnsubscribed,message:"unsubscribed"}))}_handlePublication(t){let r=this._centrifuge._getPublicationContext(this.channel,t);this.emit("publication",r),t.offset&&(this._offset=t.offset)}_handleJoin(t){this.emit("join",{channel:this.channel,info:this._centrifuge._getJoinLeaveContext(t.info)})}_handleLeave(t){this.emit("leave",{channel:this.channel,info:this._centrifuge._getJoinLeaveContext(t.info)})}_resolvePromises(){for(let t in this._promises)this._promises[t].timeout&&clearTimeout(this._promises[t].timeout),this._promises[t].resolve(),delete this._promises[t]}_rejectPromises(t){for(let r in this._promises)this._promises[r].timeout&&clearTimeout(this._promises[r].timeout),this._promises[r].reject(t),delete this._promises[r]}_scheduleResubscribe(){let t=this,r=this._getResubscribeDelay();this._resubscribeTimeout=setTimeout(function(){t._isSubscribing()&&t._centrifuge._subscribe(t)},r)}_subscribeError(t){if(!!this._isSubscribing())if(t.code<100||t.code===109||t.temporary===!0){t.code===109&&(this._token=null);let r={channel:this.channel,type:"subscribe",error:t};this.emit("error",r),this._scheduleResubscribe()}else this._setUnsubscribed(t.code,t.message,!1)}_getResubscribeDelay(){let t=le(this._resubscribeAttempts,this._minResubscribeDelay,this._maxResubscribeDelay);return this._resubscribeAttempts++,t}_setOptions(t){!t||(t.since&&(this._offset=t.since.offset,this._epoch=t.since.epoch,this._recover=!0),t.data&&(this._data=t.data),t.minResubscribeDelay!==void 0&&(this._minResubscribeDelay=t.minResubscribeDelay),t.maxResubscribeDelay!==void 0&&(this._maxResubscribeDelay=t.maxResubscribeDelay),t.token&&(this._token=t.token),t.getToken&&(this._getToken=t.getToken),t.positioned===!0&&(this._positioned=!0),t.recoverable===!0&&(this._recoverable=!0))}_getOffset(){let t=this._offset;return t!==null?t:0}_getEpoch(){let t=this._epoch;return t!==null?t:""}_clearRefreshTimeout(){this._refreshTimeout!==null&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearResubscribeTimeout(){this._resubscribeTimeout!==null&&(clearTimeout(this._resubscribeTimeout),this._resubscribeTimeout=null)}_getSubscriptionToken(){this._centrifuge._debug("get subscription token for channel",this.channel);let t={channel:this.channel},r=this._getToken;if(r===null)throw new Error("provide a function to get channel subscription token");return r(t)}_refresh(){this._clearRefreshTimeout();let t=this;this._getSubscriptionToken().then(function(r){if(!t._isSubscribed())return;if(!r){t._failUnauthorized();return}t._token=r;let s={sub_refresh:{channel:t.channel,token:r}};t._centrifuge._call(s).then(o=>{let a=o.reply.sub_refresh;t._refreshResponse(a),o.next&&o.next()},o=>{t._refreshError(o.error),o.next&&o.next()})}).catch(function(r){t.emit("error",{type:"refreshToken",channel:t.channel,error:{code:k.subscriptionRefreshToken,message:r!==void 0?r.toString():""}}),t._refreshTimeout=setTimeout(()=>t._refresh(),t._getRefreshRetryDelay())})}_refreshResponse(t){this._centrifuge._debug("subscription token refreshed, channel",this.channel),this._clearRefreshTimeout(),t.expires===!0&&(this._refreshTimeout=setTimeout(()=>this._refresh(),fe(t.ttl)))}_refreshError(t){t.code<100||t.temporary===!0?(this.emit("error",{type:"refresh",channel:this.channel,error:t}),this._refreshTimeout=setTimeout(()=>this._refresh(),this._getRefreshRetryDelay())):this._setUnsubscribed(t.code,t.message,!0)}_getRefreshRetryDelay(){return le(0,1e4,2e4)}_failUnauthorized(){this._setUnsubscribed(dt.unauthorized,"unauthorized",!0)}};var ge=class{constructor(e,t){this.endpoint=e,this.options=t,this._transport=null}name(){return"sockjs"}subName(){return"sockjs-"+this._transport.transport}emulation(){return!1}supported(){return this.options.sockjs!==null}initialize(e,t,r){let i={transports:this.options.transports};this.options.server!==null&&(i.server=this.options.server),this.options.timeout!==null&&(i.timeout=this.options.timeout),this._transport=new this.options.sockjs(this.endpoint,null,i),this._transport.onopen=()=>{t.onOpen()},this._transport.onerror=s=>{t.onError(s)},this._transport.onclose=s=>{t.onClose(s)},this._transport.onmessage=s=>{t.onMessage(s.data)}}close(){this._transport.close()}send(e){this._transport.send(e)}};var ve=class{constructor(e,t){this.endpoint=e,this.options=t,this._transport=null}name(){return"websocket"}subName(){return"websocket"}emulation(){return!1}supported(){return this.options.websocket!==null}initialize(e,t,r){let i="";e==="protobuf"&&(i="centrifuge-protobuf"),i!==""?this._transport=new this.options.websocket(this.endpoint,i):this._transport=new this.options.websocket(this.endpoint),e==="protobuf"&&(this._transport.binaryType="arraybuffer"),this._transport.onopen=()=>{t.onOpen()},this._transport.onerror=s=>{t.onError(s)},this._transport.onclose=s=>{t.onClose(s)},this._transport.onmessage=s=>{t.onMessage(s.data)}}close(){this._transport.close()}send(e){this._transport.send(e)}};var Me=class{constructor(e,t){this.endpoint=e,this.options=t,this._abortController=null,this._utf8decoder=new TextDecoder,this._protocol="json"}name(){return"http_stream"}subName(){return"http_stream"}emulation(){return!0}_handleErrors(e){if(!e.ok)throw new Error(e.status);return e}_fetchEventTarget(e,t,r){let i=new EventTarget;return e.options.fetch(t,r).then(e._handleErrors).then(o=>{i.dispatchEvent(new Event("open"));let a="",u=0,c=new Uint8Array,l=o.body.getReader();return new e.options.readableStream({start(h){function y(){return l.read().then(({done:p,value:m})=>{if(p){i.dispatchEvent(new Event("close")),h.close();return}try{if(e._protocol==="json")for(a+=e._utf8decoder.decode(m);u<a.length;)if(a[u]===`
`){let v=a.substring(0,u);i.dispatchEvent(new MessageEvent("message",{data:v})),a=a.substring(u+1),u=0}else++u;else{let v=new Uint8Array(c.length+m.length);for(v.set(c),v.set(m,c.length),c=v;;){let w=e.options.decoder.decodeReply(c);if(w.ok){let q=c.slice(0,w.pos);i.dispatchEvent(new MessageEvent("message",{data:q})),c=c.slice(w.pos);continue}break}}}catch(v){i.dispatchEvent(new Event("error",{detail:v})),i.dispatchEvent(new Event("close")),h.close();return}y()}).catch(function(p){i.dispatchEvent(new Event("error",{detail:p})),i.dispatchEvent(new Event("close")),h.close()})}return y()}})}).catch(o=>{i.dispatchEvent(new Event("error",{detail:o})),i.dispatchEvent(new Event("close"))}),i}supported(){return this.options.fetch!==null&&this.options.readableStream!==null&&typeof TextDecoder!="undefined"&&typeof AbortController!="undefined"&&typeof EventTarget!="undefined"&&typeof Event!="undefined"&&typeof MessageEvent!="undefined"&&typeof Error!="undefined"}initialize(e,t,r){this._protocol=e,this._abortController=new AbortController;let i,s;e==="json"?(i={Accept:"application/json","Content-Type":"application/json"},s=r):(i={Accept:"application/octet-stream","Content-Type":"application/octet-stream"},s=r);let o=new this._fetchEventTarget(this,this.endpoint,{method:"POST",headers:i,mode:this.options.requestMode,signal:this._abortController.signal,body:s});o.addEventListener("open",()=>{t.onOpen()}),o.addEventListener("error",a=>{this._abortController.abort(),t.onError(a)}),o.addEventListener("close",()=>{this._abortController.abort(),t.onClose({code:4,reason:"connection closed"})}),o.addEventListener("message",a=>{t.onMessage(a.data)})}close(){this._abortController.abort()}send(e,t,r){let i,s,o={session:t,node:r,data:e};this._protocol==="json"?(i={"Content-Type":"application/json"},s=JSON.stringify(o)):(i={"Content-Type":"application/octet-stream"},s=this.options.encoder.encodeEmulationRequest(o)),this.options.fetch(this.options.emulationEndpoint,{method:"POST",headers:i,mode:this.options.emulationRequestMode,body:s})}};var Je=class{constructor(e,t){this.endpoint=e,this.options=t,this._protocol="json",this._transport=null,this._onClose=null}name(){return"sse"}subName(){return"sse"}emulation(){return!0}supported(){return this.options.eventsource!==null&&this.options.fetch!==null}initialize(e,t,r){let i=new URL(this.endpoint);i.searchParams.append("cf_connect",r);let s=new this.options.eventsource(i.toString());this._transport=s;let o=this;s.onopen=function(){t.onOpen()},s.onerror=function(a){s.close(),t.onError(a),t.onClose({code:4,reason:"connection closed"})},s.onmessage=function(a){t.onMessage(a.data)},o._onClose=function(){t.onClose({code:4,reason:"connection closed"})}}close(){this._transport.close(),this._onClose!==null&&this._onClose()}send(e,t,r){let i={session:t,node:r,data:e},s={"Content-Type":"application/json"},o=JSON.stringify(i);this.options.fetch(this.options.emulationEndpoint,{method:"POST",headers:s,mode:this.options.emulationRequestMode,body:o})}};var Ue=class{encodeCommands(e){return e.map(t=>JSON.stringify(t)).join(`
`)}},ze=class{decodeReplies(e){return e.split(`
`).filter(t=>t!=="").map(t=>JSON.parse(t))}};var Pr=mr(ht()),Li={protocol:"json",token:null,getToken:null,data:null,debug:!1,name:"js",version:"",fetch:null,readableStream:null,websocket:null,eventsource:null,sockjs:null,sockjsServer:null,sockjsTimeout:null,sockjsTransports:["websocket","xdr-streaming","xhr-streaming","eventsource","iframe-eventsource","iframe-htmlfile","xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"],httpStreamRequestMode:"cors",emulationEndpoint:"/emulation",emulationRequestMode:"cors",minReconnectDelay:500,maxReconnectDelay:2e4,timeout:5e3,maxServerPingDelay:1e4},he=class extends Pr.default{constructor(t,r){super();this._reconnectTimeout=null;this._refreshTimeout=null;this._serverPingTimeout=null;this.state="disconnected",this._endpoint=t,this._emulation=!1,this._transports=[],this._currentTransportIndex=0,this._triedAllTransports=!1,this._transportWasOpen=!1,this._transport=null,this._transportClosed=!0,this._encoder=null,this._decoder=null,this._reconnectTimeout=null,this._reconnectAttempts=0,this._client=null,this._session="",this._node="",this._subs=new Map,this._serverSubs=new Map,this._commandId=0,this._commands=[],this._batching=!1,this._refreshRequired=!1,this._refreshTimeout=null,this._callbacks={},this._token=void 0,this._dispatchPromise=Promise.resolve(),this._serverPing=0,this._serverPingTimeout=null,this._sendPong=!1,this._promises={},this._promiseId=0,this._debugEnabled=!1,this._config=lt(lt({},Li),r),this._configure(),this._debugEnabled&&(this.on("state",i=>{this._debug("client state",i.oldState,"->",i.newState)}),this.on("error",i=>{this._debug("client error",i)}))}newSubscription(t,r){if(this.getSubscription(t)!==null)throw new Error("Subscription to the channel "+t+" already exists");let i=new Fe(this,t,r);return this._subs[t]=i,i}getSubscription(t){return this._getSub(t)}removeSubscription(t){if(!!t){if(t.state!=="unsubscribed")throw new Error("Subscription must be in unsubscribed state to be removed");this._removeSubscription(t)}}subscriptions(){return this._subs}ready(t){return this.state==="disconnected"?Promise.reject({code:k.clientDisconnected,message:"client disconnected"}):this.state==="connected"?Promise.resolve():new Promise((r,i)=>{let s={resolve:r,reject:i};t&&(s.timeout=setTimeout(function(){i({code:k.timeout,message:"timeout"})},t)),this._promises[this._nextPromiseId()]=s})}connect(){if(this._isConnected()){this._debug("connect called when already connected");return}if(this._isConnecting()){this._debug("connect called when already connecting");return}this._reconnectAttempts=0,this._startConnecting()}disconnect(){this._disconnect(Be.disconnectCalled,"disconnect called",!1)}send(t){let r={send:{data:t}},i=this;return this._methodCall().then(function(){return i._transportSendCommands([r])?Promise.resolve():Promise.reject(i._createErrorObject(k.transportWriteError,"transport write error"))})}rpc(t,r){return M(this,null,function*(){let i={rpc:{method:t,data:r}},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(o){return{data:o.rpc.data}})})})}publish(t,r){return M(this,null,function*(){let i={publish:{channel:t,data:r}},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(){return{}})})})}history(t,r){return M(this,null,function*(){let i={history:this._getHistoryRequest(t,r)},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(o){let a=o.history,u=[];if(a.publications)for(let c=0;c<a.publications.length;c++)u.push(s._getPublicationContext(t,a.publications[c]));return{publications:u,epoch:a.epoch||"",offset:a.offset||0}})})})}presence(t){return M(this,null,function*(){let r={presence:{channel:t}},i=this;return this._methodCall().then(function(){return i._callPromise(r,function(s){return{clients:s.presence.presence}})})})}presenceStats(t){return M(this,null,function*(){let r={presence_stats:{channel:t}},i=this;return this._methodCall().then(function(){return i._callPromise(r,function(s){let o=s.presence_stats;return{numUsers:o.num_users,numClients:o.num_clients}})})})}startBatching(){this._batching=!0}stopBatching(){this._batching=!1,this._flush()}_debug(...t){!this._debugEnabled||Rr("debug",t)}_setFormat(t){if(!this._formatOverride(t)){if(t==="protobuf")throw new Error("not implemented by JSON-only Centrifuge client, use client with Protobuf support");this._encoder=new Ue,this._decoder=new ze}}_formatOverride(t){return!1}_configure(){if(!("Promise"in window))throw new Error("Promise polyfill required");if(!this._endpoint)throw new Error("endpoint configuration required");if(this._config.protocol!=="json"&&this._config.protocol!=="protobuf")throw new Error("unsupported protocol "+this._config.protocol);if(this._config.token!==null&&(this._token=this._config.token),this._setFormat("json"),this._config.protocol==="protobuf"&&this._setFormat("protobuf"),(this._config.debug===!0||typeof localStorage!="undefined"&&localStorage.getItem("centrifuge.debug"))&&(this._debugEnabled=!0),this._debug("config",this._config),typeof this._endpoint!="string")if(typeof this._endpoint=="object"&&this._endpoint instanceof Array){this._transports=this._endpoint,this._emulation=!0;for(let t in this._transports){let r=this._transports[t];if(!r.endpoint||!r.transport)throw new Error("malformed transport configuration");let i=r.transport;if(["websocket","http_stream","sse","sockjs"].indexOf(i)<0)throw new Error("unsupported transport name: "+i)}}else throw new Error("unsupported url configuration type: only string or array of objects are supported")}_setState(t){if(this.state!==t){let r=this.state;return this.state=t,this.emit("state",{newState:t,oldState:r}),!0}return!1}_isDisconnected(){return this.state==="disconnected"}_isConnecting(){return this.state==="connecting"}_isConnected(){return this.state==="connected"}_nextCommandId(){return++this._commandId}_getReconnectDelay(){let t=le(this._reconnectAttempts,this._config.minReconnectDelay,this._config.maxReconnectDelay);return this._reconnectAttempts+=1,t}_clearOutgoingRequests(){for(let t in this._callbacks)if(this._callbacks.hasOwnProperty(t)){let r=this._callbacks[t];clearTimeout(r.timeout);let i=r.errback;if(!i)continue;i({error:this._createErrorObject(k.connectionClosed,"connection closed")})}this._callbacks={}}_clearConnectedState(){this._client=null,this._clearServerPingTimeout(),this._clearRefreshTimeout();for(let t in this._subs){if(!this._subs.hasOwnProperty(t))continue;let r=this._subs[t];r._isSubscribed()&&r._setSubscribing(Ie.transportClosed,"transport closed")}for(let t in this._serverSubs)this._serverSubs.hasOwnProperty(t)&&this.emit("subscribing",{channel:t})}_handleWriteError(t){for(let r of t){let i=r.id;if(!(i in this._callbacks))continue;let s=this._callbacks[i];clearTimeout(this._callbacks[i].timeout),delete this._callbacks[i],s.errback({error:this._createErrorObject(k.transportWriteError,"transport write error")})}}_transportSendCommands(t){if(!t.length)return!0;if(!this._transport)return!1;try{this._transport.send(this._encoder.encodeCommands(t),this._session,this._node)}catch(r){return this._debug("error writing commands",r),this._handleWriteError(t),!1}return!0}_initializeTransport(){let t;this._config.websocket!==null?t=this._config.websocket:typeof WebSocket!="function"&&typeof WebSocket!="object"||(t=WebSocket);let r=null;this._config.sockjs!==null?r=this._config.sockjs:typeof window.SockJS!="undefined"&&(r=window.SockJS);let i=null;this._config.eventsource!==null?i=this._config.eventsource:typeof window.EventSource!="undefined"&&(i=window.EventSource);let s=null;this._config.fetch!==null?s=this._config.fetch:typeof window.fetch!="undefined"&&(s=window.fetch);let o=null;if(this._config.readableStream!==null?o=this._config.readableStream:typeof window.ReadableStream!="undefined"&&(o=window.ReadableStream),this._emulation){this._currentTransportIndex>=this._transports.length&&(this._triedAllTransports=!0,this._currentTransportIndex=0);let h=0;for(;;){if(h>=this._transports.length)throw new Error("no supported transport found");let y=this._transports[this._currentTransportIndex],p=y.transport,m=y.endpoint;if(p==="websocket"){if(this._debug("trying websocket transport"),this._transport=new ve(m,{websocket:t}),!this._transport.supported()){this._debug("websocket transport not available"),this._currentTransportIndex++,h++;continue}}else if(p==="http_stream"){if(this._debug("trying http_stream transport"),this._transport=new Me(m,{fetch:s,readableStream:o,requestMode:this._config.httpStreamRequestMode,emulationEndpoint:this._config.emulationEndpoint,emulationRequestMode:this._config.emulationRequestMode,decoder:this._decoder,encoder:this._encoder}),!this._transport.supported()){this._debug("http_stream transport not available"),this._currentTransportIndex++,h++;continue}}else if(p==="sse"){if(this._debug("trying sse transport"),this._transport=new Je(m,{eventsource:i,fetch:s,emulationEndpoint:this._config.emulationEndpoint,emulationRequestMode:this._config.emulationRequestMode}),!this._transport.supported()){this._debug("sse transport not available"),this._currentTransportIndex++,h++;continue}}else if(p==="sockjs"){if(this._debug("trying sockjs"),this._transport=new ge(m,{sockjs:r,transports:this._config.sockjsTransports,server:this._config.sockjsServer,timeout:this._config.sockjsTimeout}),!this._transport.supported()){this._debug("sockjs transport not available"),this._currentTransportIndex++,h++;continue}}else throw new Error("unknown transport "+p);break}}else if(kr(this._endpoint,"http")){if(this._debug("client will use sockjs"),this._transport=new ge(this._endpoint,{sockjs:r,transports:this._config.sockjsTransports,server:this._config.sockjsServer,timeout:this._config.sockjsTimeout}),!this._transport.supported())throw new Error("SockJS not available, use ws(s):// in url or include SockJS")}else if(this._debug("client will use websocket"),this._transport=new ve(this._endpoint,{websocket:t}),!this._transport.supported())throw new Error("WebSocket not available");let a=this._constructConnectCommand();this._transport.emulation()&&(a.id=this._nextCommandId(),this._callConnectFake(a.id).then(h=>{let y=h.reply.connect;this._connectResponse(y),h.next&&h.next()},h=>{h.error.code>=100&&this._connectError(h.error),h.next&&h.next()}));let u=this,c,l=!1;this._transport.initialize(this._config.protocol,{onOpen:function(){l=!0,c=u._transport.subName(),u._debug(c,"transport open"),u._transportWasOpen=!0,u._transportClosed=!1,!u._transport.emulation()&&u._sendConnect()},onError:function(h){u._debug("transport level error",h)},onClose:function(h){u._debug(u._transport.name(),"transport closed"),u._transportClosed=!0;let y="connection closed",p=!0,m=0;if(h&&"code"in h&&h.code&&(m=h.code),h&&h.reason)try{let w=JSON.parse(h.reason);y=w.reason,p=w.reconnect}catch(w){y=h.reason,(m>=3500&&m<4e3||m>=4500&&m<5e3)&&(p=!1)}m<3e3?(m===1009?(m=Be.messageSizeLimit,y="message size limit exceeded",p=!1):(m=ce.transportClosed,y="transport closed"),u._emulation&&!u._transportWasOpen&&(u._currentTransportIndex++,u._currentTransportIndex>=u._transports.length&&(u._triedAllTransports=!0,u._currentTransportIndex=0))):u._transportWasOpen=!0;let v=!1;if(u._emulation&&!u._transportWasOpen&&!u._triedAllTransports&&(v=!0),u._isConnecting()&&!l&&u.emit("error",{type:"transport",error:{code:k.transportClosed,message:"transport closed"},transport:u._transport.name()}),u._disconnect(m,y,p),u._isConnecting()){let w=u._getReconnectDelay();v&&(w=0),u._debug("reconnect after "+w+" milliseconds"),u._reconnectTimeout=setTimeout(()=>{u._startReconnecting()},w)}},onMessage:function(h){u._dataReceived(h)}},this._encoder.encodeCommands([a]))}_sendConnect(){let t=this._constructConnectCommand(),r=this;this._call(t).then(i=>{let s=i.reply.connect;r._connectResponse(s),i.next&&i.next()},i=>{r._connectError(i.error),i.next&&i.next()})}_startReconnecting(){if(!this._isConnecting())return;if(!(this._refreshRequired||!this._token&&this._config.getToken!==null)){this._startConnecting();return}let r=this;this._getToken().then(function(i){if(!!r._isConnecting()){if(!i){r._failUnauthorized();return}r._token=i,r._debug("connection token refreshed"),r._startConnecting()}}).catch(function(i){if(!r._isConnecting())return;r.emit("error",{type:"connectToken",error:{code:k.clientConnectToken,message:i!==void 0?i.toString():""}});let s=r._getReconnectDelay();r._debug("error on connection token refresh, reconnect after "+s+" milliseconds",i),r._reconnectTimeout=setTimeout(()=>{r._startReconnecting()},s)})}_connectError(t){this.state==="connecting"&&(t.code===109&&(this._refreshRequired=!0),t.code<100||t.temporary===!0||t.code===109?(this.emit("error",{type:"connect",error:t}),this._transport&&!this._transportClosed&&(this._transportClosed=!0,this._transport.close())):this._disconnect(t.code,t.message,!1))}_constructConnectCommand(){let t={};this._token&&(t.token=this._token),this._config.data&&(t.data=this._config.data),this._config.name&&(t.name=this._config.name),this._config.version&&(t.version=this._config.version);let r={},i=!1;for(let s in this._serverSubs)if(this._serverSubs.hasOwnProperty(s)&&this._serverSubs[s].recoverable){i=!0;let o={recover:!0};this._serverSubs[s].offset&&(o.offset=this._serverSubs[s].offset),this._serverSubs[s].epoch&&(o.epoch=this._serverSubs[s].epoch),r[s]=o}return i&&(t.subs=r),{connect:t}}_getHistoryRequest(t,r){let i={channel:t};return r!==void 0&&(r.since&&(i.since={offset:r.since.offset},r.since.epoch&&(i.since.epoch=r.since.epoch)),r.limit!==void 0&&(i.limit=r.limit),r.reverse===!0&&(i.reverse=!0)),i}_methodCall(){return this._isConnected()?Promise.resolve():new Promise((t,r)=>{let i=setTimeout(function(){r({code:k.timeout,message:"timeout"})},this._config.timeout);this._promises[this._nextPromiseId()]={timeout:i,resolve:t,reject:r}})}_callPromise(t,r){return new Promise((i,s)=>{this._call(t).then(o=>{i(r(o.reply)),o.next&&o.next()},o=>{s(o.error),o.next&&o.next()})})}_dataReceived(t){this._serverPing>0&&this._waitServerPing();let r=this._decoder.decodeReplies(t);this._dispatchPromise=this._dispatchPromise.then(()=>{let i;this._dispatchPromise=new Promise(s=>{i=s}),this._dispatchSynchronized(r,i)})}_dispatchSynchronized(t,r){let i=Promise.resolve();for(let s in t)t.hasOwnProperty(s)&&(i=i.then(()=>this._dispatchReply(t[s])));i=i.then(()=>{r()})}_dispatchReply(t){var r;let i=new Promise(o=>{r=o});if(t==null)return this._debug("dispatch: got undefined or null reply"),r(),i;let s=t.id;return s&&s>0?this._handleReply(t,r):t.push?this._handlePush(t.push,r):this._handleServerPing(r),i}_call(t){return new Promise((r,i)=>{t.id=this._nextCommandId(),this._registerCall(t.id,r,i),this._addCommand(t)})}_callConnectFake(t){return new Promise((r,i)=>{this._registerCall(t,r,i)})}_startConnecting(){this._debug("start connecting"),this._setState("connecting")&&this.emit("connecting",{code:ce.connectCalled,reason:"connect called"}),this._client=null,this._initializeTransport()}_disconnect(t,r,i){if(this._isDisconnected())return;let s=this.state,o={code:t,reason:r},a=!1;i?a=this._setState("connecting"):(a=this._setState("disconnected"),this._rejectPromises({code:k.clientDisconnected,message:"disconnected"})),this._clearOutgoingRequests(),s==="connecting"&&this._clearReconnectTimeout(),s==="connected"&&this._clearConnectedState(),a&&(this._isConnecting()?this.emit("connecting",o):this.emit("disconnected",o)),this._transport&&!this._transportClosed&&(this._transportClosed=!0,this._transport.close())}_failUnauthorized(){this._disconnect(Be.unauthorized,"unauthorized",!1)}_getToken(){if(this._debug("get connection token"),!this._config.getToken)throw new Error("provide a function to get connection token");return this._config.getToken({})}_refresh(){let t=this._client,r=this;this._getToken().then(function(i){if(t!==r._client)return;if(!i){r._failUnauthorized();return}if(r._token=i,r._debug("connection token refreshed"),!r._isConnected())return;let s={refresh:{token:r._token}};r._call(s).then(o=>{let a=o.reply.refresh;r._refreshResponse(a),o.next&&o.next()},o=>{r._refreshError(o.error),o.next&&o.next()})}).catch(function(i){r.emit("error",{type:"refreshToken",error:{code:k.clientRefreshToken,message:i!==void 0?i.toString():""}}),r._refreshTimeout=setTimeout(()=>r._refresh(),r._getRefreshRetryDelay())})}_refreshError(t){t.code<100||t.temporary===!0?(this.emit("error",{type:"refresh",error:t}),this._refreshTimeout=setTimeout(()=>this._refresh(),this._getRefreshRetryDelay())):this._disconnect(t.code,t.message,!1)}_getRefreshRetryDelay(){return le(0,5e3,1e4)}_refreshResponse(t){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),t.expires&&(this._client=t.client,this._refreshTimeout=setTimeout(()=>this._refresh(),fe(t.ttl)))}_subscribe(t){this._debug("subscribing on",t.channel);let r=t.channel;if(r in this._subs||(this._subs[r]=t),!this._isConnected()){this._debug("delay subscribe on",t.channel,"till connected");return}if(t._usesToken()){let i=this._client,s=this;t._token?this._sendSubscribe(t,t._token):t._getSubscriptionToken().then(function(o){if(i===s._client&&!!t._isSubscribing()){if(!o){t._failUnauthorized();return}t._token=o,s._sendSubscribe(t,o)}}).catch(function(o){!t._isSubscribing()||(t.emit("error",{type:"subscribeToken",channel:t.channel,error:{code:k.subscriptionSubscribeToken,message:o!==void 0?o.toString():""}}),t._scheduleResubscribe())})}else this._sendSubscribe(t,"")}_sendSubscribe(t,r){let i=t.channel,s={channel:i};if(r&&(s.token=r),t._data&&(s.data=t._data),t._positioned&&(s.positioned=!0),t._recoverable&&(s.recoverable=!0),t._needRecover()){s.recover=!0;let a=t._getOffset();a&&(s.offset=a);let u=t._getEpoch();u&&(s.epoch=u)}let o={subscribe:s};this._call(o).then(a=>{let u=a.reply.subscribe;this._subscribeResponse(i,u),a.next&&a.next()},a=>{this._subscribeError(i,a.error),a.next&&a.next()})}_sendSubRefresh(t,r){let s={sub_refresh:{channel:t.channel,token:r}};this._call(s).then(o=>{let a=o.reply.sub_refresh;t._refreshResponse(a),o.next&&o.next()},o=>{t._refreshError(o.error),o.next&&o.next()})}_removeSubscription(t){t!==null&&delete this._subs[t.channel]}_unsubscribe(t){if(!this._isConnected())return;let i={unsubscribe:{channel:t.channel}},s=this;this._call(i).then(o=>{o.next&&o.next()},o=>{o.next&&o.next(),s._disconnect(ce.unsubscribeError,"unsubscribe error",!0)})}_getSub(t){let r=this._subs[t];return r||null}_isServerSub(t){return this._serverSubs[t]!==void 0}_connectResponse(t){if(this._transportWasOpen=!0,this._reconnectAttempts=0,this._refreshRequired=!1,this._isConnected())return;this._client=t.client,this._setState("connected"),this._refreshTimeout&&clearTimeout(this._refreshTimeout),t.expires&&(this._refreshTimeout=setTimeout(()=>this._refresh(),fe(t.ttl))),this._session=t.session,this._node=t.node,this.startBatching();for(let i in this._subs)if(this._subs.hasOwnProperty(i)){let s=this._subs[i];s._isSubscribing()&&this._subscribe(s)}this.stopBatching();let r={client:t.client,transport:this._transport.subName()};t.data&&(r.data=t.data),this.emit("connected",r),this._resolvePromises(),this._processServerSubs(t.subs||{}),t.ping&&t.ping>0?(this._serverPing=t.ping*1e3,this._sendPong=t.pong===!0,this._waitServerPing()):this._serverPing=0}_processServerSubs(t){for(let r in t){if(!t.hasOwnProperty(r))continue;let i=t[r];this._serverSubs[r]={offset:i.offset,epoch:i.epoch,recoverable:i.recoverable||!1};let s=this._getSubscribeContext(r,i);this.emit("subscribed",s)}for(let r in t){if(!t.hasOwnProperty(r))continue;let i=t[r];if(i.recovered){let s=i.publications;if(s&&s.length>0)for(let o in s)s.hasOwnProperty(o)&&this._handlePublication(r,s[o])}}for(let r in this._serverSubs)!this._serverSubs.hasOwnProperty(r)||t[r]||(this.emit("unsubscribed",{channel:r}),delete this._serverSubs[r])}_clearRefreshTimeout(){this._refreshTimeout!==null&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearReconnectTimeout(){this._reconnectTimeout!==null&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null)}_clearServerPingTimeout(){this._serverPingTimeout!==null&&(clearTimeout(this._serverPingTimeout),this._serverPingTimeout=null)}_waitServerPing(){this._config.maxServerPingDelay!==0&&(!this._isConnected()||(this._clearServerPingTimeout(),this._serverPingTimeout=setTimeout(()=>{!this._isConnected()||this._disconnect(ce.noPing,"no ping",!0)},this._serverPing+this._config.maxServerPingDelay)))}_subscribeError(t,r){let i=this._getSub(t);if(!!i&&!!i._isSubscribing()){if(r.code===k.timeout){this._disconnect(ce.subscribeTimeout,"subscribe timeout",!0);return}i._subscribeError(r)}}_getSubscribeContext(t,r){let i={channel:t,positioned:!1,recoverable:!1,wasRecovering:!1,recovered:!1};r.recovered&&(i.recovered=!0),r.positioned&&(i.positioned=!0),r.recoverable&&(i.recoverable=!0),r.was_recovering&&(i.wasRecovering=!0);let s="";"epoch"in r&&(s=r.epoch);let o=0;return"offset"in r&&(o=r.offset),(i.positioned||i.recoverable)&&(i.streamPosition={offset:o,epoch:s}),r.data&&(i.data=r.data),i}_subscribeResponse(t,r){let i=this._getSub(t);!i||!i._isSubscribing()||i._setSubscribed(r)}_handleReply(t,r){let i=t.id;if(!(i in this._callbacks)){r();return}let s=this._callbacks[i];if(clearTimeout(this._callbacks[i].timeout),delete this._callbacks[i],Tr(t)){let o=s.errback;if(!o){r();return}let a=t.error;o({error:a,next:r})}else{let o=s.callback;if(!o)return;o({reply:t,next:r})}}_handleJoin(t,r){let i=this._getSub(t);if(!i){if(this._isServerSub(t)){let s={channel:t,info:this._getJoinLeaveContext(r.info)};this.emit("join",s)}return}i._handleJoin(r)}_handleLeave(t,r){let i=this._getSub(t);if(!i){if(this._isServerSub(t)){let s={channel:t,info:this._getJoinLeaveContext(r.info)};this.emit("leave",s)}return}i._handleLeave(r)}_handleUnsubscribe(t,r){let i=this._getSub(t);if(!i){this._isServerSub(t)&&(delete this._serverSubs[t],this.emit("unsubscribed",{channel:t}));return}r.code<2500?i._setUnsubscribed(r.code,r.reason,!1):i._setSubscribing(r.code,r.reason)}_handleSubscribe(t,r){this._serverSubs[t]={offset:r.offset,epoch:r.epoch,recoverable:r.recoverable||!1},this.emit("subscribed",this._getSubscribeContext(t,r))}_handleDisconnect(t){let r=t.code,i=!0;(r>=3500&&r<4e3||r>=4500&&r<5e3)&&(i=!1),this._disconnect(r,t.reason,i)}_getPublicationContext(t,r){let i={channel:t,data:r.data};return r.offset&&(i.offset=r.offset),r.info&&(i.info=this._getJoinLeaveContext(r.info)),r.tags&&(i.tags=r.tags),i}_getJoinLeaveContext(t){let r={client:t.client,user:t.user};return t.conn_info&&(r.connInfo=t.conn_info),t.chan_info&&(r.chanInfo=t.chan_info),r}_handlePublication(t,r){let i=this._getSub(t);if(!i){if(this._isServerSub(t)){let s=this._getPublicationContext(t,r);this.emit("publication",s),r.offset!==void 0&&(this._serverSubs[t].offset=r.offset)}return}i._handlePublication(r)}_handleMessage(t){this.emit("message",{data:t.data})}_handleServerPing(t){if(this._sendPong){let r={};this._transportSendCommands([r])}t()}_handlePush(t,r){let i=t.channel;t.pub?this._handlePublication(i,t.pub):t.message?this._handleMessage(t.message):t.join?this._handleJoin(i,t.join):t.leave?this._handleLeave(i,t.leave):t.unsubscribe?this._handleUnsubscribe(i,t.unsubscribe):t.subscribe?this._handleSubscribe(i,t.subscribe):t.disconnect&&this._handleDisconnect(t.disconnect),r()}_flush(){let t=this._commands.slice(0);this._commands=[],this._transportSendCommands(t)}_createErrorObject(t,r,i){let s={code:t,message:r};return i&&(s.temporary=!0),s}_registerCall(t,r,i){this._callbacks[t]={callback:r,errback:i,timeout:null},this._callbacks[t].timeout=setTimeout(()=>{delete this._callbacks[t],mt(i)&&i({error:this._createErrorObject(k.timeout,"timeout")})},this._config.timeout)}_addCommand(t){this._batching?this._commands.push(t):this._transportSendCommands([t])}_nextPromiseId(){return++this._promiseId}_resolvePromises(){for(let t in this._promises)this._promises[t].timeout&&clearTimeout(this._promises[t].timeout),this._promises[t].resolve(),delete this._promises[t]}_rejectPromises(t){for(let r in this._promises)this._promises[r].timeout&&clearTimeout(this._promises[r].timeout),this._promises[r].reject(t),delete this._promises[r]}};he.SubscriptionState=je;he.State=pt;var Ne=yi(),fr=Ne.Root.fromJSON(_i()),Os=fr.lookupType("protocol.Command"),bi=fr.lookupType("protocol.Reply"),ks=fr.lookupType("protocol.EmulationRequest"),cr=class{encodeEmulationRequest(e){let t=Ne.Writer.create();return ks.encode(e,t),t.finish()}encodeCommands(e){let t=Ne.Writer.create();for(let r in e)if(e.hasOwnProperty(r)){let i=Object.assign({},e[r]);Os.encodeDelimited(i,t)}return t.finish()}},lr=class{decodeReplies(e){let t=[],r=Ne.Reader.create(new Uint8Array(e));for(;r.pos<r.len;){let i=bi.decodeDelimited(r);t.push(i)}return t}decodeReply(e){let t=Ne.Reader.create(new Uint8Array(e));for(;t.pos<t.len;)return bi.decodeDelimited(t),{ok:!0,pos:t.pos};return{ok:!1}}},at=class extends he{_formatOverride(e){return e==="protobuf"?(this._encoder=new cr,this._decoder=new lr,!0):!1}};var gi=at;window.Centrifuge=gi;})();
